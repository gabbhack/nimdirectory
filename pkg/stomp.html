<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">stomp</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">stomp</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">messaging</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">events</button></a>
                </span>
            
        </p>
        
            <p class="pkg-desc">A pure-nim implementation of the STOMP protocol for machine messaging.</p>
        
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install stomp" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>README</h1>
<h2>Overview</h2>
<p>This is a pure-nim client library for interacting with Stomp
compliant messaging brokers.</p>
<p>https://stomp.github.io/</p>
<p>Stomp is a simple protocol for message passing between clients, using a central
broker.  It is a subset of other more elaborate protocols (like AMQP), supporting
only the most used features of common brokers.</p>
<p>Because this library is pure-nim, there are no external dependencies.  If you
can compile a nim binary, you can participate in advanced messaging between processes.</p>
<p>A list of broker support for Stomp can be found here:
https://stomp.github.io/implementations.html.</p>
<p>This library has been tested with recent versions of RabbitMQ.  If it
works for you with another broker, please let the author know.</p>
<h3>Installation</h3>
<p>The easiest way to install this module is via the nimble package manager,
by simply running &apos;nimble install stomp&apos;.</p>
<p>Alternatively, you can fetch the &apos;stomp.nim&apos; file yourself, and put it
in a place of your choosing.</p>
<h3>Protocol support</h3>
<p>This library supports (almost) the entirety of the Stomp 1.2 spec,
with the exception of client to server heartbeat.  Server to client
heartbeat is fully supported, which should normally be sufficient to
keep firewall state tables open and sockets alive.</p>
<h3>Callbacks</h3>
<p>Because a client can receive frames at any time, most of the behavior
of this module is implemented via callback procs.</p>
<p>By default, most every event is a no-op.  You can override various
behaviors with the following callbacks:</p>
<ul>
<li>
<p><strong>connected_callback</strong>:  Called when the Stomp library makes a successful
connection to the broker.</p>
</li>
<li>
<p><strong>error_callback</strong>: Called if there was a <strong>ERROR</strong> frame in the stream. By default,
this raises a <strong>StompError</strong> exception with the error message.</p>
</li>
<li>
<p><strong>heartbeat_callback</strong>: Called when a server heartbeat is received.</p>
</li>
<li>
<p><strong>message_callback</strong>: Called when a <strong>MESSAGE</strong> frame is received.</p>
</li>
<li>
<p><strong>missed_heartbeat_callback</strong>: Called when the Stomp socket is idle longer than
the specified heartbeat time -- usually an indication of a problem.  The default behavior</p>
</li>
</ul>
<p>raises a <strong>StompError</strong> exception.</p>
<ul>
<li><strong>receipt_callback</strong>: Called when a <strong>RECEIPT</strong> frame is received.</li>
</ul>
<h3>Custom headers</h3>
<p>Depending on the broker, you may be able to add addtional features to outgoing messages
by adding specific headers.  You can also add &quot;x-headers&quot; that are carried between messages.</p>
<p>Another use is to issue &quot;receipts&quot; on sends or subscriptions, to ensure the broker has
processed your request.  Here&apos;s an example of how to perform receipt processing:</p>
<pre>  <code>#!nimrod
proc accept_receipt( c: StompClient, r: StompResponse ) =
   var receipt = r[ &quot;receipt-id&quot; ]
   # ... match this receipt up to the request that generated it

var client = newStompClient( socket, &quot;...&quot; )

client.receipt_callback = accept_receipt
client.connect

var headers = seq[ tuple[name:string, value:string] ]
headers.add( (&quot;x-breakfast&quot;, &quot;tequila&quot;) )
headers.add( (&quot;receipt&quot;, &quot;special-identifier&quot;) )

client.send( &quot;/destination&quot;, &quot;message!&quot;, &quot;text/plain&quot;, headers )
</code></pre>
<h3>Transactions</h3>
<p>This library has full support for transactions.  Once entering a
transaction, any messages or acknowledgments attached to it must be
committed before the broker will release them.</p>
<p>With one open transaction, messages are automatically attached to it.
If you have multiple open transactions, you&apos;ll need to add which one
you want a message to be part of via the custom headers.</p>
<pre>  <code>#!nimrod
# Single transaction
#
client.begin( &quot;trans-1&quot; )
client.send( &quot;/destination&quot;, &quot;hi&quot; ) # Part of &quot;trans-1&quot;
client.send( &quot;/destination&quot;, &quot;yo&quot; ) # Part of &quot;trans-1&quot;
client.send( &quot;/destination&quot;, &quot;whaddup&quot; ) # Part of &quot;trans-1&quot;
client.commit # or client.abort

# Multiple simultaneous transactions
#
client.begin( &quot;trans-1&quot; )
client.begin( &quot;trans-2&quot; )
client.begin( &quot;trans-3&quot; )

var headers = seq[ tuple[name:string, value:string] ]
headers.add( (&quot;transaction&quot;, &quot;trans-1&quot;) )
client.send( &quot;/destination&quot;, &quot;hi&quot;, nil, headers ) # Part of &quot;trans-1&quot;

headers = @[]
headers.add( (&quot;transaction&quot;, &quot;trans-2&quot;) )
client.send( &quot;/destination&quot;, &quot;hi&quot;, nil, headers ) # Part of &quot;trans-2&quot;
client.ack( &quot;some-ack-id&quot;, &quot;trans-2&quot; ) # Part of &quot;trans-2&quot;

headers = @[]
headers.add( (&quot;transaction&quot;, &quot;trans-3&quot;) )
client.send( &quot;/destination&quot;, &quot;hi&quot;, nil, headers ) # Part of &quot;trans-3&quot;
client.ack( &quot;some-ack-id&quot;, &quot;trans-3&quot; ) # Part of &quot;trans-3&quot;

client.abort( &quot;trans-1&quot; )  # anything &quot;trans-1&quot; never happened
client.commit( &quot;trans-2&quot; ) # &quot;trans-2&quot; messages and acks are released
client.abort( &quot;trans-3&quot; )  # anything &quot;trans-3&quot; never happened
</code></pre>
<h3>Example</h3>
<p>This is a complete client that does the following:</p>
<ul>
<li>Connect to an AMQP server at <strong>mq.example.com</strong> via SSL as the <strong>test</strong> user,
in the <strong>/example</strong> vhost.</li>
<li>Request heartbeats every <strong>5</strong> seconds.</li>
<li>Subscribe to a topic exchange <strong>events</strong> with the key of <strong>user.create</strong>, requiring message
acknowledgement.</li>
<li>Accept incoming messages, parsing the JSON payloads.</li>
<li>If parsing was successful, ACK the message and emit a new message to the exchange
with JSON results to the <strong>user.created</strong> key -- presumably to be picked up by another
process elsewhere.</li>
</ul>
<pre>  <code>#!nimrod
# (This should be compiled with -d:ssl)

import
   std/[net,json],
   stomp

let
   socket = newSocket()
   sslContext = newContext( verifyMode = CVerifyNone )

sslContext.wrapSocket( socket )
var client = newStompClient( socket, &quot;stomp+ssl://test:test@mq.example.com/%2Fexample?heartbeat=5&quot; )

# Announce when we&apos;re connected.
proc connected( c: StompClient, r: StompResponse ) =
   echo &quot;Connected to a &quot;, c[&quot;server&quot;], &quot; server.&quot;

# Echo to screen when we see a heartbeat.
proc heartbeat( c: StompClient, r: StompResponse ) =
   echo &quot;Heartbeat at: &quot;,  c.last_msgtime

# Parse JSON, perform work, send success message.
proc message( c: StompClient, r: StompResponse ) =
   let id = r[ &quot;ack&quot; ]

   if r[ &quot;content-type&quot; ] != &quot;application/json&quot;:
       echo &quot;I expect JSON payloads.&quot;
       c.nack( id )
       return

   try:
       var json = r.payload.parse_json

       # ... do the heavy lifting with the parsed data.
       # ... and assuming is was successful, ack and emit!
       
       c.ack( id )

       var message = %*{ &quot;user&quot;: json[&quot;user&quot;].getStr, &quot;otherstuff&quot;: true }
       c.send( &quot;/exchange/events/user.created&quot;, $message, &quot;application/json&quot; )

   except JsonParsingError:
       echo &quot;Couldn&apos;t parse JSON! &quot;, r.payload
       c.nack( id )

# Attach callbacks
client.connected_callback = connected
client.message_callback = message
client.heartbeat_callback = heartbeat

# Open a session with the broker
client.connect

# Subscribe to a topic key, requiring acknowledgements.
client.subscribe( &quot;/exchange/events/user.create&quot;, &quot;client-individual&quot; )

# Enter message loop.
client.wait_for_messages
</code></pre>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/mahlonsmith/nim-stomp">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2024-02-13T01:08:04Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
