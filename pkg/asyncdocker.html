<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">asyncdocker</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">async</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">docker</button></a>
                </span>
            
        </p>
        
            <p class="pkg-desc">Asynchronous docker client written by Nim-lang</p>
        
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install asyncdocker" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><p>This module implements an Docker Engine client based on Docker Remotet API. It&apos;s
asynchronous (non-blocking) that it can be used to write web services for deploying
swarm cluster and containers automatically on cloud environment. Of course, it
can also be used to write any local deployment tools. see <a href="http://tulayang.github.io/asyncdocker.html">  <strong>API Documentation</strong></a></p>
<p>See <a href="https://github.com/tulayang/asyncdocker/blob/master/tests/test.nim">tests</a> and <a href="https://github.com/tulayang/asyncdocker/blob/master/tests/test_ssl.nim">test_ssl</a> to get started; <a href="https://github.com/tulayang/asyncdocker/blob/master/tests/deploy_nossl_docker.sh">deploy docker</a> and <a href="https://github.com/tulayang/asyncdocker/blob/master/tests/deploy_ssl_docker.sh">deploy tls docker</a> to deploy docker daemon automatically.</p>
<pre>  <code class="language-sh">nimble install asyncdocker
</code></pre>
<h2>Docker CLI vs Asyncdocker</h2>
<p>The docker cli example:</p>
<pre>  <code class="language-sh">  export DOCKER_HOST=127.0.0.1:2375
  docker create --name hello --hostname 192.168.0.1 \
                ubuntu:14.04 /bin/bash -c &apos;echo hello&apos;
  docker start hello
</code></pre>
<p>And the equivalent asyncdocker example:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">json</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">main</span>() {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>} <span class="op">=</span> </div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="str">&quot;127.0.0.1&quot;</span>, <span class="ide">Port</span>(<span class="num">2375</span>))</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">ret</span> <span class="op">=</span> <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">create</span>(<span class="ide">image</span> <span class="op">=</span> <span class="str">&quot;ubuntu:14.04&quot;</span>, </div></div><div class="line"><div class="line-content">                                  <span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;hello&quot;</span>,</div></div><div class="line"><div class="line-content">                                  <span class="ide">hostname</span> <span class="op">=</span> <span class="str">&quot;192.168.0.1&quot;</span>,</div></div><div class="line"><div class="line-content">                                  <span class="ide">cmd</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;/bin/bash&quot;</span>, <span class="str">&quot;-c&quot;</span>, <span class="str">&quot;echo hello&quot;</span>])</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;Container Id: &quot;</span>, <span class="ide">ret</span>[<span class="str">&quot;Id&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>()</div></div><div class="line"><div class="line-content">    <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">start</span>(<span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;hello&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">docker</span><span class="op">.</span><span class="ide">close</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">waitFor</span> <span class="ide">main</span>()</div></div>  </code></pre>
<h2>Simulate Pull Image</h2>
<p>This example simulates the docker cli <code>docker pull ubuntu:14.10</code> to download
the image and print progress bars:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">json</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">const</span></div></div><div class="line"><div class="line-content">  <span class="ide">hostname</span> <span class="op">=</span> <span class="str">&quot;127.0.0.1&quot;</span></div></div><div class="line"><div class="line-content">  <span class="ide">port</span> <span class="op">=</span> <span class="ide">Port</span>(<span class="num">2375</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">pullCb</span>(<span class="ide">state</span>: <span class="ide">JsonNode</span>): <span class="ide">Future</span>[<span class="ide">bool</span>] {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>} <span class="op">=</span> </div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">state</span><span class="op">.</span><span class="ide">hasKey</span>(<span class="str">&quot;progress&quot;</span>):</div></div><div class="line"><div class="line-content">    <span class="kwd">let</span> <span class="ide">current</span> <span class="op">=</span> <span class="ide">state</span>[<span class="str">&quot;progressDetail&quot;</span>][<span class="str">&quot;current&quot;</span>]<span class="op">.</span><span class="ide">getNum</span>()</div></div><div class="line"><div class="line-content">    <span class="kwd">let</span> <span class="ide">total</span> <span class="op">=</span> <span class="ide">state</span>[<span class="str">&quot;progressDetail&quot;</span>][<span class="str">&quot;total&quot;</span>]<span class="op">.</span><span class="ide">getNum</span>()</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;</span>\r<span class="str">&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;id&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;: &quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;status&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot; &quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="op">$</span><span class="ide">current</span> <span class="op">&amp;</span> <span class="str">&quot;/&quot;</span> <span class="op">&amp;</span> <span class="op">$</span><span class="ide">total</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot; &quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;progress&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="ide">current</span> <span class="op">==</span> <span class="ide">total</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;</span>\n<span class="str">&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">stdout</span><span class="op">.</span><span class="ide">flushFile</span>()</div></div><div class="line"><div class="line-content">  <span class="kwd">else</span>:</div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="ide">state</span><span class="op">.</span><span class="ide">hasKey</span>(<span class="str">&quot;id&quot;</span>):</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;id&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;: &quot;</span>)</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;status&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;</span>\n<span class="str">&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">else</span>: </div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="ide">state</span>[<span class="str">&quot;status&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>())</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;</span>\n<span class="str">&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">main</span>() {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>} <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="ide">hostname</span>, <span class="ide">port</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">pull</span>(<span class="ide">fromImage</span> <span class="op">=</span> <span class="str">&quot;ubuntu&quot;</span>, <span class="ide">tag</span> <span class="op">=</span> <span class="str">&quot;14.10&quot;</span>, <span class="ide">cb</span> <span class="op">=</span> <span class="ide">pullCb</span>)          </div></div><div class="line"><div class="line-content">  <span class="ide">docker</span><span class="op">.</span><span class="ide">close</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">waitFor</span> <span class="ide">main</span>()</div></div>  </code></pre>
<p>output:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="num">14.10</span>: <span class="ide">Pulling</span> <span class="kwd">from</span> <span class="ide">library</span><span class="op">/</span><span class="ide">ubuntu</span></div></div><div class="line"><div class="line-content"><span class="ide">b0efe5c05b4c</span>: <span class="ide">Pulling</span> <span class="ide">fs</span> <span class="ide">layer</span></div></div><div class="line"><div class="line-content"><span class="num">0</span><span class="ide">a1f1b169319</span>: <span class="ide">Pulling</span> <span class="ide">fs</span> <span class="ide">layer</span></div></div><div class="line"><div class="line-content"><span class="num">1</span><span class="ide">ceb0a3c7c48</span>: <span class="ide">Pulling</span> <span class="ide">fs</span> <span class="ide">layer</span></div></div><div class="line"><div class="line-content"><span class="ide">a3ed95caeb02</span>: <span class="ide">Pulling</span> <span class="ide">fs</span> <span class="ide">layer</span></div></div><div class="line"><div class="line-content"><span class="ide">a3ed95caeb02</span>: <span class="ide">Waiting</span></div></div><div class="line"><div class="line-content"><span class="num">1</span><span class="ide">ceb0a3c7c48</span>: <span class="ide">Downloading</span> <span class="num">682</span><span class="op">/</span><span class="num">682</span> [<span class="op">==================================================&gt;</span>]    <span class="num">682</span> <span class="ide">B</span><span class="op">/</span><span class="num">682</span> <span class="ide">B</span></div></div><div class="line"><div class="line-content"><span class="num">1</span><span class="ide">ceb0a3c7c48</span>: <span class="ide">Verifying</span> <span class="ide">Checksum</span></div></div><div class="line"><div class="line-content"><span class="num">1</span><span class="ide">ceb0a3c7c48</span>: <span class="ide">Download</span> <span class="ide">complete</span></div></div><div class="line"><div class="line-content"><span class="ide">a3ed95caeb02</span>: <span class="ide">Downloading</span> <span class="num">32</span><span class="op">/</span><span class="num">32</span> [<span class="op">==================================================&gt;</span>]     <span class="num">32</span> <span class="ide">B</span><span class="op">/</span><span class="num">32</span> <span class="ide">BB</span><span class="op">/</span><span class="num">77.8</span> <span class="ide">kB</span></div></div><div class="line"><div class="line-content"><span class="ide">a3ed95caeb02</span>: <span class="ide">Verifying</span> <span class="ide">Checksum</span></div></div><div class="line"><div class="line-content"><span class="ide">a3ed95caeb02</span>: <span class="ide">Download</span> <span class="ide">complete</span></div></div><div class="line"><div class="line-content"><span class="num">0</span><span class="ide">a1f1b169319</span>: <span class="ide">Downloading</span> <span class="num">77797</span><span class="op">/</span><span class="num">77797</span> [<span class="op">==================================================&gt;</span>]  <span class="num">77.8</span> <span class="ide">kB</span><span class="op">/</span><span class="num">77.8</span> <span class="ide">kB</span></div></div><div class="line"><div class="line-content"><span class="num">0</span><span class="ide">a1f1b169319</span>: <span class="ide">Verifying</span> <span class="ide">Checksum</span></div></div><div class="line"><div class="line-content"><span class="num">0</span><span class="ide">a1f1b169319</span>: <span class="ide">Download</span> <span class="ide">complete</span></div></div><div class="line"><div class="line-content"><span class="ide">b0efe5c05b4c</span>: <span class="ide">Downloading</span> <span class="num">4848810</span><span class="op">/</span><span class="num">68321236</span> [<span class="op">===&gt;</span>                                               ] <span class="num">4.849</span> <span class="ide">MB</span><span class="op">/</span><span class="num">68.32</span> <span class="ide">MB</span></div></div>  </code></pre>
<h2>Web Service</h2>
<p>You can write a web service with <code>asynchttpserver</code>:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">asynchttpserver</span>, <span class="ide">json</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">server</span> <span class="op">=</span> <span class="ide">newAsyncHttpServer</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">cb</span>(<span class="ide">req</span>: <span class="ide">Request</span>) {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>} <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="str">&quot;127.0.0.1&quot;</span>, <span class="ide">Port</span>(<span class="num">2375</span>))</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">pass</span> <span class="op">=</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content">    <span class="kwd">try</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">var</span> <span class="ide">ret</span> <span class="op">=</span> <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">create</span>(<span class="ide">image</span> <span class="op">=</span> <span class="str">&quot;ubuntu:14.04&quot;</span>, </div></div><div class="line"><div class="line-content">                                    <span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;hello&quot;</span>,</div></div><div class="line"><div class="line-content">                                    <span class="ide">hostname</span> <span class="op">=</span> <span class="str">&quot;192.168.0.1&quot;</span>,</div></div><div class="line"><div class="line-content">                                    <span class="ide">cmd</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;/bin/bash&quot;</span>, <span class="str">&quot;-c&quot;</span>, <span class="str">&quot;echo&quot;</span>, <span class="str">&quot;hello&quot;</span>])</div></div><div class="line"><div class="line-content">      <span class="ide">echo</span> <span class="str">&quot;Container Id: &quot;</span>, <span class="ide">ret</span>[<span class="str">&quot;Id&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>()</div></div><div class="line"><div class="line-content">      <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">start</span>(<span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;hello&quot;</span>)</div></div><div class="line"><div class="line-content">      <span class="ide">await</span> <span class="ide">req</span><span class="op">.</span><span class="ide">respond</span>(<span class="ide">Http201</span>, <span class="str">&quot;OK&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">except</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">pass</span> <span class="op">=</span> <span class="ide">false</span></div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="kwd">not</span> <span class="ide">pass</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">await</span> <span class="ide">req</span><span class="op">.</span><span class="ide">respond</span>(<span class="ide">Http500</span>, <span class="str">&quot;Failure&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">docker</span><span class="op">.</span><span class="ide">close</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">waitFor</span> <span class="ide">server</span><span class="op">.</span><span class="ide">serve</span>(<span class="ide">Port</span>(<span class="num">8080</span>), <span class="ide">cb</span>)</div></div>  </code></pre>
<p>or with <code>jester</code>:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">asynchttpserver</span>, <span class="ide">json</span>, <span class="ide">jester</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">routes</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">post</span> <span class="str">&quot;/containers/@name/run&quot;</span></div></div><div class="line"><div class="line-content">      <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="str">&quot;127.0.0.1&quot;</span>, <span class="ide">Port</span>(<span class="num">2375</span>))</div></div><div class="line"><div class="line-content">      <span class="kwd">var</span> <span class="ide">pass</span> <span class="op">=</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content">      <span class="kwd">try</span>:</div></div><div class="line"><div class="line-content">        <span class="kwd">var</span> <span class="ide">ret</span> <span class="op">=</span> <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">create</span>(<span class="ide">image</span> <span class="op">=</span> <span class="str">&quot;ubuntu:14.04&quot;</span>, </div></div><div class="line"><div class="line-content">                                      <span class="ide">name</span> <span class="op">=</span> <span class="op">@</span><span class="str">&quot;name&quot;</span>,</div></div><div class="line"><div class="line-content">                                      <span class="ide">hostname</span> <span class="op">=</span> <span class="str">&quot;192.168.0.1&quot;</span>,</div></div><div class="line"><div class="line-content">                                      <span class="ide">cmd</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;/bin/bash&quot;</span>, <span class="str">&quot;-c&quot;</span>, <span class="str">&quot;echo&quot;</span>, <span class="str">&quot;hello&quot;</span>])</div></div><div class="line"><div class="line-content">        <span class="ide">echo</span> <span class="str">&quot;Container Id: &quot;</span>, <span class="ide">ret</span>[<span class="str">&quot;Id&quot;</span>]<span class="op">.</span><span class="ide">getStr</span>()</div></div><div class="line"><div class="line-content">        <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">start</span>(<span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;hello&quot;</span>)</div></div><div class="line"><div class="line-content">        <span class="ide">await</span> <span class="ide">req</span><span class="op">.</span><span class="ide">respond</span>(<span class="ide">Http201</span>, <span class="str">&quot;OK&quot;</span>)</div></div><div class="line"><div class="line-content">      <span class="kwd">except</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">pass</span> <span class="op">=</span> <span class="ide">false</span></div></div><div class="line"><div class="line-content">      <span class="kwd">if</span> <span class="kwd">not</span> <span class="ide">pass</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">await</span> <span class="ide">req</span><span class="op">.</span><span class="ide">respond</span>(<span class="ide">Http500</span>, <span class="str">&quot;Failure&quot;</span>)</div></div><div class="line"><div class="line-content">      <span class="ide">docker</span><span class="op">.</span><span class="ide">close</span>()</div></div>  </code></pre>
<h2>Stream support</h2>
<p>Supports to stream responses from the docker daemon with <code>attach</code>, <code>logs</code>,
<code>execStart</code>, etc. For example:</p>
<pre>  <code class="language-sh">docker logs --follow hello
</code></pre>
<p>equivalent to:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">logsCb</span>(): <span class="ide">VndCallback</span> <span class="op">=</span> </div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">i</span> <span class="op">=</span> <span class="num">0</span></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">cb</span>(<span class="ide">vnd</span>: <span class="ide">VndKind</span>, <span class="ide">data</span>: <span class="ide">string</span>): <span class="ide">Future</span>[<span class="ide">bool</span>] {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>} <span class="op">=</span> </div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="ide">vnd</span> <span class="op">==</span> <span class="ide">vndStdout</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;stdout: &quot;</span> <span class="op">&amp;</span> <span class="ide">data</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="ide">vnd</span> <span class="op">==</span> <span class="ide">vndStderr</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">stderr</span><span class="op">.</span><span class="ide">write</span>(<span class="str">&quot;stderr: &quot;</span> <span class="op">&amp;</span> <span class="ide">data</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="ide">i</span></div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="ide">i</span> <span class="op">==</span> <span class="num">5</span>:</div></div><div class="line"><div class="line-content">     <span class="ide">result</span> <span class="op">=</span> <span class="ide">true</span> <span class="com"># Close socket to stop receiving logs.</span></div></div><div class="line"><div class="line-content">    <span class="ide">inc</span>(<span class="ide">i</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">result</span> <span class="op">=</span> <span class="ide">cb</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">logs</span>(<span class="str">&quot;hello&quot;</span>, <span class="ide">follow</span> <span class="op">=</span> <span class="ide">true</span>, <span class="ide">cb</span> <span class="op">=</span> <span class="ide">logsCb</span>())</div></div>  </code></pre>
<h2>TLS Verify</h2>
<p>Supports <code>--tls</code> and <code>--tlsverify</code> to protect docker daemon socket.</p>
<p>This requires the OpenSSL library, fortunately it&apos;s widely used and installed on
many operating systems. Client will use SSL automatically if you give any of
the functions a url with the <code>https</code> schema, for example: <code>https://github.com/</code>,
you also have to compile with <code>ssl</code> defined like so: <code>nim c -d:ssl ...</code>.</p>
<p>For <code>--tls</code>:</p>
<pre>  <code class="language-sh">  docker --host 127.0.0.1:2376 \
         --tls \
         --tlskey /home/docker/.docker/key.pem \
         --tlscert /home/docker/.docker/cert.pem \
         ps
</code></pre>
<p>equivalent to:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">json</span>, <span class="ide">openssl</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">const</span></div></div><div class="line"><div class="line-content">    <span class="ide">key</span> <span class="op">=</span> <span class="str">&quot;/home/docker/.docker/key.pem&quot;</span></div></div><div class="line"><div class="line-content">    <span class="ide">cert</span> <span class="op">=</span> <span class="str">&quot;/home/docker/.docker/cert.pem&quot;</span></div></div><div class="line"><div class="line-content">  </div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">main</span>() {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>}</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="str">&quot;127.0.0.1&quot;</span>, <span class="ide">Port</span>(<span class="num">2376</span>), <span class="kwd">nil</span>, <span class="ide">key</span>, <span class="ide">cert</span>, <span class="ide">CVerifyNone</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">containers</span> <span class="op">=</span> <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">ps</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">waitFor</span> <span class="ide">main</span>()</div></div>  </code></pre>
<p>For <code>--tlsverify</code>:</p>
<pre>  <code class="language-sh">  docker --host 127.0.0.1:2376 \
         --tlsverify \
         --tlscacert /home/docker/.docker/ca.pem \
         --tlskey /home/docker/.docker/key.pem \
         --tlscert /home/docker/.docker/cert.pem \
         ps   
</code></pre>
<p>equivalent to:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">asyncdocker</span>, <span class="ide">asyncdispatch</span>, <span class="ide">json</span>, <span class="ide">openssl</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">const</span></div></div><div class="line"><div class="line-content">    <span class="ide">cacert</span> <span class="op">=</span> <span class="str">&quot;/home/docker/.docker/ca.pem&quot;</span></div></div><div class="line"><div class="line-content">    <span class="ide">key</span> <span class="op">=</span> <span class="str">&quot;/home/docker/.docker/key.pem&quot;</span></div></div><div class="line"><div class="line-content">    <span class="ide">cert</span> <span class="op">=</span> <span class="str">&quot;/home/docker/.docker/cert.pem&quot;</span></div></div><div class="line"><div class="line-content">  </div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">main</span>() {<span class="op">.</span><span class="ide">async</span><span class="op">.</span>}</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">docker</span> <span class="op">=</span> <span class="ide">newAsyncDocker</span>(<span class="str">&quot;127.0.0.1&quot;</span>, <span class="ide">Port</span>(<span class="num">2376</span>), <span class="ide">cacert</span>, <span class="ide">key</span>, <span class="ide">cert</span>, <span class="ide">CVerifyPeer</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">containers</span> <span class="op">=</span> <span class="ide">await</span> <span class="ide">docker</span><span class="op">.</span><span class="ide">ps</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">waitFor</span> <span class="ide">main</span>()</div></div>  </code></pre>
<h2>Swarm cluster support</h2>
<p>The Docker Swarm API is mostly compatible with the Docker Remote API. see <a href="https://docs.docker.com/swarm/swarm-api/">Docker Swarm Reference</a></p>
<p>  <a href="http://tulayang.github.io/asyncdocker.html">    <strong>API Documentation</strong>  </a></p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://tulayang.github.io/asyncdocker.html">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2024-01-26T01:09:18Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
