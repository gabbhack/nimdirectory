<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">textformats</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">parsing</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">formats</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">textfiles</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
        </p>
        
            <p class="pkg-desc">Easy specification of text formats for structured data</p>
        
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install textformats" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>TextFormats</h1>
<p>TextFormats is a library for rapidly defining and using text formats for
structured data, and allows for rapid prototyping of parsers for
such file formats in Nim, Python and C/C++.</p>
<p>Given a format definition, expressed in a simple declarative language (TFSL,
Text Formats Specification Language), the library provides functions for
switching from the text representation of the data (&quot;encoded string&quot;) to the
actual data it represents (&quot;decoded data&quot;) and vice-versa.</p>
<p>The definition of the formats in TFSL is human readable and reduces the
requirement of complex regular expression. As opposed to lexers or regular
expressions, it does not only validates and splits different parts of a format,
but converts them to data in built-in scalar and compound datatypes, allowing
for fine tuning of the conversion.</p>
<h2>Python</h2>
<p>The Python API of TextFormats is documented in the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/Python_API.md">Python API manual</a>
and <a href="https://github.com/ggonnella/textformats/blob/main/cheatsheets/Python_API.md">cheatsheet</a>
and can be installed using:</p>
<pre>  <code>pip install textformats
</code></pre>
<p>If a binary package compatible with the system is available, it will
be downloaded and installed. Nim installation is not required.</p>
<p>If no binary package is available, the source distribution is downloaded.
In this case, the <a href="https://github.com/ggonnella/textformats/blob/main/manuals/howto_install_nim.md">Nim compiler version &gt;= 1.6.0 must be installed</a>
and the <code>nim</code> binary must be in PATH.  Then,
the <code>pip install textformats</code> command will automatically compile and install
the package.</p>
<p>Example applications based on the Python API are available in the git repository
<a href="https://github.com/ggonnella/textformats/tree/main/python/examples">here</a>
and <a href="https://github.com/ggonnella/textformats/tree/main/python/benchmarks">here</a>.</p>
<h2>Nim</h2>
<p>The Nim API of TextFormats is documented in the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/Nim_API.md">Nim API manual</a>
and <a href="https://github.com/ggonnella/textformats/blob/main/cheatsheets/Nim_API.md">cheatsheet</a>.
and is installed using:</p>
<pre>  <code>nimble install textformats
</code></pre>
<p>Example applications based on the Nim API are available in the git repository
<a href="https://github.com/ggonnella/textformats/tree/main/examples">here</a>
and <a href="https://github.com/ggonnella/textformats/tree/main/benchmarks">here</a>.</p>
<h2>C/C++</h2>
<p>The C API of TextFormats is documented in the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/C_API.md">C API manual</a>
and <a href="https://github.com/ggonnella/textformats/blob/main/cheatsheets/C_API.md">cheatsheet</a>
and is obtained by cloning the
<a href="https://github.com/ggonnella/textformats.git">git repository</a>.
Furthermore <a href="https://github.com/ggonnella/textformats/blob/main/manuals/howto_install_nim.md">Nim compiler version &gt;= 1.6.0 must be installed</a></p>
<p>The C API are in the in the <code>C</code> directory of the git repository.
Example applications based on the C API are available in the git repository
<a href="https://github.com/ggonnella/textformats/tree/main/C/examples">here</a>
and <a href="https://github.com/ggonnella/textformats/tree/main/C/benchmarks">here</a>.</p>
<h2>Command line tools</h2>
<p>The CLI tools developed with TextFormats allows the use of the library
from the command line (e.g. in Bash scripts). For using it, the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/howto_install_nim.md">Nim compiler version &gt;= 1.6.0 must be installed</a>
and the textformats Nim package installed (<code>nimble install textformats</code>).
The tools are thereby installed and compiled. They are <code>tf_spec</code> (work with TFSL specifications),
<code>tf_decode</code> (convert a format to JSON), <code>tf_encode</code> (convert JSON to a format)
and <code>tf_validate</code> (validate data or its text representations).</p>
<p>The CLI tools are documented in the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/CLI.md">CLI manual</a>,
<a href="https://github.com/ggonnella/textformats/blob/main/cheatsheets/CLI.md">cheatsheet</a>.
Man pages can be generated using <code>nimble climan</code> from the source code
directory.</p>
<p>Examples of use of the CLI tools are given in the git repository
<a href="https://github.com/ggonnella/textformats/tree/main/cli/examples">here</a>
<a href="https://github.com/ggonnella/textformats/tree/main/cli/tests">here</a>.</p>
<h2>Format specifications</h2>
<p>The TFSL (TextFormats Specification Language) is usually input by the user
as a YAML file. In alternative, the interactive Python script <code>tf_genspec.py</code>
can be used, which allows the generation of a specification from scratch.</p>
<p>Several specifications are made available with the package and are contained
in the git repository in the
<a href="https://github.com/ggonnella/textformats/tree/main/spec">spec directory</a></p>
<p>The specification language is documented in a
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/TFSL_syntax.md">manual</a>,
and a
<a href="https://github.com/ggonnella/textformats/blob/main/cheatsheet/TFSL.md">cheatsheet</a>,
describing the syntax,
a <a href="https://github.com/ggonnella/textformats/blob/main/manuals/TFSL_howto.md">howto</a>
explaining how to define text representations
for different kind of values: strings, numeric, boolean, list, dictionaries, etc.
and a
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/TFSL_tests.md">tests manual</a>,
describing how to implement specification tests.</p>
<h3>Format specifications: an example</h3>
<p>In multiple biological sequence analysis formats (e.g. SAM, GFA),
a CIGAR string represents a list of multi-edit operations, each consisting
of a length (positive integer value) and an operation code (one among a short
list of possible codes).</p>
<p>A string representation of a CIGAR is for example
&quot;10M1D20M1I40M&quot;. The string compactly represents a list of mappings,
each with two members &quot;length&quot; and &quot;code&quot;. In JSON its representation would
be: [{length: 10, code: &quot;M&quot;}, {length: 1, code: &quot;D&quot;}, {length: 20, code: &quot;M&quot;},
{length: 1, code: &quot;I&quot;}, {length: 40, code: &quot;M&quot;}].</p>
<p>The definition of a CIGAR in TextFormats would be:</p>
<pre>  <code>cigar:
  list_of:
    composed_of:
    - length: {unsigned_integer: {min: 1}}
    - code: {values: [M, D, I, P] }
</code></pre>
<p>Once the definition is provided, the library provides the following functions:</p>
<pre>  <code># decoding: string representation =&gt; data
&quot;10M1D&quot;.decode(cigar)
# =&gt; [{length: 10, code: &quot;M&quot;}, {length: 1, code: &quot;D&quot;}]

# encoding: data =&gt; string representation
[{length: 10, code: &quot;M&quot;}, {length: 1, code: &quot;D&quot;}].encode(cigar)
# =&gt; &quot;10M1D&quot;

# validation of string representation
&quot;10M1D&quot;.is_valid(cigar)
# =&gt; true

# validation of data
[{length: 10, code: &quot;M&quot;}, {length: 1, code: &quot;D&quot;}].is_valid(cigar)
# =&gt; true
</code></pre>
<p>Furthermore, definitions can refer to each other, which allows splitting
a complex definition into smaller parts, and reuse them in different contexts.
For example, the previous definition could have been written as:</p>
<pre>  <code>cigar_code: {values: [M, D, I, P]}
pos_integer: {unsigned_integer: {min: 1}}
cigar_op: {composed_of: [length: pos_integer, code: cigar_code]}
cigar: {list_of: cigar_op}
</code></pre>
<p>Since definitions can be re-used in different contexts and formats, they
can be stored in modules, which can be imported from other specification files.
The import mechanism is flexible, featuring namespaces, partial imports and
redefinitions of parts of an imported module.</p>
<p>Finally, sometimes fine tuning of the conversion between encoded and
decoded data is necessary. Thus, the following operations can be included
in the definitions:</p>
<ul>
<li>providing more meaningful strings:
e.g. in the example above of cigar operation code, one can</li>
</ul>
<p>decode the &quot;M&quot; to the string &quot;replacement&quot; and the &quot;D&quot; to &quot;deletion&quot;</p>
<ul>
<li>converting to different types:
e.g. in some formats the symbols &quot;+&quot; and &quot;-&quot; represent</li>
</ul>
<p>the boolean values true and false, and should be converted accordingly</p>
<ul>
<li>add implicit values:
e.g. in many formats, in a particular context</li>
</ul>
<p>of the file, multiple kind of information can be stored, and can be recognized
from their different formatting; in this case, one
can add a label to the decoded data, describing the type of information</p>
<ul>
<li>remove formatting symbols:
often structured elements contain formatting constant strings such</li>
</ul>
<p>as separators, prefixes and suffixes, which must not be included in the
resulting decoded data</p>
<ul>
<li>define default values:
sometimes a given symbol or part of a string representation is missing</li>
</ul>
<p>when representing a default value.</p>
<h3>Understanding specification errors</h3>
<p>The tool <code>tf_spec</code> (see above Command line tools) can be used as
<code>tf_spec info -s &lt;SPECFILE&gt;</code> to list of datatypes of a (valid)
specification are output. An error will be output if the specification
is invalid.</p>
<p>A further tool to validate the syntax of a YAML or JSON specification, which can
be sometimes useful to better understand specification errors, is <code>tf_cerberus.py</code>,
provided under <code>scripts</code> in the
source code git repository.
It is based on the Python library <code>cerberus</code> (which is required in order to use this
tool). The script has some limitations: it is not always guaranteed that a
validated specification is indeed valid (e.g. circular or invalid references
are not found).</p>
<h3>Interactive generation</h3>
<p>An interactive script <code>tf_genspec.py</code> is provided under <code>scripts</code> in the
source code git repository.  It can be
used to generate a TextFormats specification in YAML file.
The script has some limitations: it is not always guaranteed that the generated
specification is correct (e.g. the user can create circular or invalid
references).</p>
<p>Thus the resulting output file should be tested, e.g. generating examples
from each of the defined datatypes using <code>cli/tf_spec generate_tests -s &lt;OUTFILE&gt;</code>. This command would fail if the specification is invalid.
Furthermore, the results can be inspected to check that the examples reflect
the expectations.</p>
<h2>Citation</h2>
<p>If you use this software, please cite: Gonnella G. (2022).
TextFormats: Simplifying the definition and parsing of text formats in
bioinformatics. PloS one, 17(5), e0268910.
https://doi.org/10.1371/journal.pone.0268910</p>
<h2>Developer notes</h2>
<p>The library is implemented using the programming language Nim.
This language was used, since it combines some of the advantages of Python
with those of compiled languages.</p>
<p>During compilation, C code is created and then compiled to binary.
Besides in Nim code itself, the resulting library can be easily employed
in C/C++ and in Python.</p>
<p>Code organization and conventions, used in the implementation of the
TextFormats library, addressed to the library software developer,
are documented in the
<a href="https://github.com/ggonnella/textformats/blob/main/manuals/developer_manual.md">developer manual</a></p>
<p>To run the unit test suite of the library, use the
<code>nimble test</code> command from the main project source code directory.
To run the CLI tools tests, first build it using <code>nimble build</code> or
<code>nimble install</code>, then use the <code>nimble clitest</code> command.
To run the C API tests, use <code>nimble ctest</code>.
To run the Python API tests, first build the package using
<code>nimble pymake</code>, then use <code>nimble pytest</code>.</p>
<h2>Known limitations</h2>
<ul>
<li>Only formats which are regular languages can be defined -- with at most some
exceptions (JSON elements can be included, since they are parsed by the json
library).</li>
<li>Unsigned integers cannot be larger than the largest signed integer <a href="reason:">^2</a></li>
</ul>
<p>JsonNode objects from the json nim standard library are
used to represent decoded values both for Nim code and for passing the values
through the API to functions written in other languages; however, JsonNode does
not have a representation for unsigned integers)</p>
<h2>Acknowledgements</h2>
<p>This software has been originally created in context of the DFG project GO 3192/1-1
“Automated characterization of microbial genomes and metagenomes by collection and verification of association rules”.
The funders had no role in study design, data collection and analysis.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        ISC
                    </p>
                

                
                    <p> <a href="https://github.com/ggonnella/textformats">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2024-01-12T01:13:29Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
