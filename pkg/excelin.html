<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">excelin</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">read-excel</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">create-excel</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">excel</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">pure</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Create and read Excel purely in Nim")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install excelin" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>Excelin - create and read Excel pure Nim</h1>
<p><a href="https://nimble.directory/ci/badges/excelin/nimdevel/output.html">  <img src="https://nimble.directory/ci/badges/excelin/version.svg" style="max-width: 100%;" alt="Build Status" /></a> <a href="https://nimble.directory/ci/badges/excelin/nimdevel/output.html">  <img src="https://nimble.directory/ci/badges/excelin/nimdevel/status.svg" style="max-width: 100%;" alt="Build Status" /></a> <a href="https://nimble.directory/ci/badges/excelin/nimdevel/doc_build_output.html">  <img src="https://nimble.directory/ci/badges/excelin/nimdevel/docstatus.svg" style="max-width: 100%;" alt="Build Status" /></a></p>
<p>A library to work with Excel file and/or data.</p>
<h2>Docs</h2>
<p>All available APIs can be find in <a href="https://mashingan.github.io/excelin/src/htmldocs/excelin.html">docs page</a>.</p>
<h1>Examples</h1>
<ul>
<li>  <a href="#common-operations">Common operations</a></li>
<li>  <a href="#working-with-sheets">Working with sheets</a></li>
<li>  <a href="#cell-formula">Cell formula</a></li>
<li>  <a href="#cell-styling">Cell styling</a></li>
<li>  <a href="#row-display">Row display</a></li>
<li>  <a href="#sheet-auto-filter">Sheet auto filter</a></li>
<li>  <a href="#cell-merge">Cell merge</a></li>
<li>  <a href="#sheet-page-breaks">Sheet page breaks</a></li>
</ul>
<h2>Common operations</h2>
<p>All operations available working with Excel worksheet are illustrated in below:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">times</span> <span class="kwd">import</span> <span class="ide">now</span>, <span class="ide">DateTime</span>, <span class="ide">Time</span>, <span class="ide">toTime</span>, <span class="ide">parse</span>, <span class="ide">Month</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">month</span>, <span class="ide">year</span>, <span class="ide">monthday</span>, <span class="ide">toUnix</span>, `<span class="op">$</span>`</div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">strformat</span> <span class="kwd">import</span> <span class="ide">fmt</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">sugar</span> <span class="kwd">import</span> `<span class="op">-&gt;</span>`, `<span class="op">=&gt;</span>`, <span class="ide">dump</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">strscans</span> <span class="kwd">import</span> <span class="ide">scanf</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">sequtils</span> <span class="kwd">import</span> <span class="ide">toSeq</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># `newExcel` returns Excel and Sheet object to immediately work</span></div></div><div class="line"><div class="line-content"><span class="com"># when creating an Excel data.</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># we of course can also read from Excel file directly using `readExcel`</span></div></div><div class="line"><div class="line-content"><span class="com"># we comment this out because the path is imaginary</span></div></div><div class="line"><div class="line-content"><span class="com">#let excelTemplate = readExcel(&quot;path/to/template.xlsx&quot;)</span></div></div><div class="line"><div class="line-content"><span class="com"># note readExcel only returns the Excel itself because there&apos;s no</span></div></div><div class="line"><div class="line-content"><span class="com"># known default sheet available. Use `excelin.getSheet(Excel,string): Sheet`</span></div></div><div class="line"><div class="line-content"><span class="com"># to get the sheet based on its name.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;Sheet1&quot;</span></div></div><div class="line"><div class="line-content"><span class="com"># by default the name sheet is Sheet1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># let&apos;s change it to other name</span></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;excelin-example&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;excelin-example&quot;</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># let&apos;s add/fetch some row to our sheet</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># excelin.row is immediately creating when the rows if it&apos;s not available</span></div></div><div class="line"><div class="line-content"><span class="com"># and if it&apos;s available, it&apos;s returning the existing.</span></div></div><div class="line"><div class="line-content"><span class="com"># With excelin.rowNum, we can check its row number.</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">rowNum</span> <span class="op">==</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># let&apos;s add another row, this time it&apos;s row 5</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row5</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">5</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row5</span><span class="op">.</span><span class="ide">rowNum</span> <span class="op">==</span> <span class="num">5</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># in this case, we immediately get the row 5 even though the existing</span></div></div><div class="line"><div class="line-content"><span class="com"># rows in the sheet are only one.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">type</span></div></div><div class="line"><div class="line-content">    <span class="ide">ForExample</span> <span class="op">=</span> <span class="kwd">object</span></div></div><div class="line"><div class="line-content">        <span class="ide">a</span>: <span class="ide">string</span></div></div><div class="line"><div class="line-content">        <span class="ide">b</span>: <span class="ide">int</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> `<span class="op">$</span>`(<span class="ide">f</span>: <span class="ide">ForExample</span>): <span class="ide">string</span> <span class="op">=</span> fmt"[{f.a}:{f.b}]"</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># let&apos;s put some values in row cells</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">nao</span> <span class="op">=</span> <span class="ide">now</span>()</div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;A&quot;</span>] <span class="op">=</span> <span class="str">&quot;this is string&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;C&quot;</span>] <span class="op">=</span> <span class="num">256</span></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;E&quot;</span>] <span class="op">=</span> <span class="num">42.42</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;B&quot;</span>] <span class="op">=</span> <span class="ide">nao</span> <span class="com"># Excelin support DateTime or Time and</span></div></div><div class="line"><div class="line-content">                <span class="com"># by default it will be formatted as yyyy-MM-dd&apos;T&apos;HH:mm:dd.fff&apos;.&apos;zz</span></div></div><div class="line"><div class="line-content">                <span class="com"># e.g.: 2200-12-01T22:10:23.456+01</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;D&quot;</span>] <span class="op">=</span> <span class="str">&quot;2200/12/01&quot;</span> <span class="com"># we put the date as string for later example when fetching</span></div></div><div class="line"><div class="line-content">                         <span class="com"># using supplied converter function from cell value</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;F&quot;</span>] <span class="op">=</span> <span class="op">$</span><span class="ide">ForExample</span>(<span class="ide">a</span>: <span class="str">&quot;A&quot;</span>, <span class="ide">b</span>: <span class="num">200</span>)</div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;H&quot;</span>] <span class="op">=</span> <span class="op">-</span><span class="num">111</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">srclink</span> <span class="op">=</span> <span class="ide">Hyperlink</span>(</div></div><div class="line"><div class="line-content">  <span class="ide">target</span>: <span class="str">&quot;https://github.com/mashingan/excelin&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">text</span>: <span class="str">&quot;excelin github page&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">tooltip</span>: <span class="str">&quot;lakad matataag, excelin excelin&quot;</span>,</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="str">&quot;J&quot;</span>] <span class="op">=</span> <span class="ide">srclink</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># notice above example we arbitrarily chose the column and by current implementation</span></div></div><div class="line"><div class="line-content"><span class="com"># Excel data won&apos;t add unnecessary empty cells. In other words, sparse row cells.</span></div></div><div class="line"><div class="line-content"><span class="com"># When we&apos;re sure working with large cells and often have to update its cell value,</span></div></div><div class="line"><div class="line-content"><span class="com"># we can supply the optional argument `cfFilled` to make our cells in the row filled</span></div></div><div class="line"><div class="line-content"><span class="com"># preemptively.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row2</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">2</span>, <span class="ide">cfFilled</span>) <span class="com"># default is cfSparse</span></div></div><div class="line"><div class="line-content"><span class="ide">clear</span> <span class="ide">row2</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># While example above the new row is already empty by default,</span></div></div><div class="line"><div class="line-content"><span class="com"># we can clear all cells in the row with `clear` proc.</span></div></div><div class="line"><div class="line-content"> </div></div><div class="line"><div class="line-content"><span class="com"># now let&apos;s fetch the data we inputted</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span>[<span class="str">&quot;A&quot;</span>, <span class="ide">string</span>] <span class="op">==</span> <span class="str">&quot;this is string&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">getCell</span>[:<span class="ide">uint</span>](<span class="str">&quot;C&quot;</span>) <span class="op">==</span> <span class="num">256</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span>[<span class="str">&quot;H&quot;</span>, <span class="ide">int</span>] <span class="op">==</span> <span class="op">-</span><span class="num">111</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span>[<span class="str">&quot;B&quot;</span>, <span class="ide">DateTime</span>]<span class="op">.</span><span class="ide">toTime</span><span class="op">.</span><span class="ide">toUnix</span> <span class="op">==</span> <span class="ide">nao</span><span class="op">.</span><span class="ide">toTime</span><span class="op">.</span><span class="ide">toUnix</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span>[<span class="str">&quot;B&quot;</span>, <span class="ide">Time</span>]<span class="op">.</span><span class="ide">toUnix</span> <span class="op">==</span> <span class="ide">nao</span><span class="op">.</span><span class="ide">toTime</span><span class="op">.</span><span class="ide">toUnix</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span>[<span class="str">&quot;E&quot;</span>, <span class="ide">float</span>] <span class="op">==</span> <span class="num">42.42</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">destlink</span> <span class="op">=</span> <span class="ide">row1</span>[<span class="str">&quot;J&quot;</span>, <span class="ide">Hyperlink</span>]</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">destlink</span><span class="op">.</span><span class="ide">target</span> <span class="op">==</span> <span class="ide">srclink</span><span class="op">.</span><span class="ide">target</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">destlink</span><span class="op">.</span><span class="ide">text</span> <span class="op">==</span> <span class="ide">srclink</span><span class="op">.</span><span class="ide">text</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">destlink</span><span class="op">.</span><span class="ide">tooltip</span> <span class="op">==</span> <span class="ide">srclink</span><span class="op">.</span><span class="ide">tooltip</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># in above example, we fetched various values from its designated cell position</span></div></div><div class="line"><div class="line-content"><span class="com"># using the two kind of function, `getCell` and `[]`. `[]` often used for</span></div></div><div class="line"><div class="line-content"><span class="com"># elementary/primitive types those supported by Excelin by default. `getCell`</span></div></div><div class="line"><div class="line-content"><span class="com"># has 3rd parameter, a closure with signature `string -&gt; R`, which default to `nil`,</span></div></div><div class="line"><div class="line-content"><span class="com"># that will give users the flexibility to read the string value representation</span></div></div><div class="line"><div class="line-content"><span class="com"># to the what intended to convert. We&apos;ll see it below</span></div></div><div class="line"><div class="line-content"><span class="com">#</span></div></div><div class="line"><div class="line-content"><span class="com"># note also that we need to compare to its second for DateTime|Time instead of directly using</span></div></div><div class="line"><div class="line-content"><span class="com"># times.`==` because the comparison precision up to nanosecond, something we</span></div></div><div class="line"><div class="line-content"><span class="com"># can&apos;t provide in this example</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">dt</span> <span class="op">=</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">getCell</span>[:<span class="ide">DateTime</span>](<span class="str">&quot;D&quot;</span>,</div></div><div class="line"><div class="line-content">  (<span class="ide">s</span>: <span class="ide">string</span>) <span class="op">-&gt;</span> <span class="ide">DateTime</span> <span class="op">=&gt;</span> (</div></div><div class="line"><div class="line-content">    <span class="ide">dump</span> <span class="ide">s</span>; <span class="ide">result</span> <span class="op">=</span> <span class="ide">parse</span>(<span class="ide">s</span>, <span class="str">&quot;yyyy/MM/dd&quot;</span>); <span class="ide">dump</span> <span class="ide">result</span>))</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dt</span><span class="op">.</span><span class="ide">year</span> <span class="op">==</span> <span class="num">2200</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dt</span><span class="op">.</span><span class="ide">month</span> <span class="op">==</span> <span class="ide">mDec</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dt</span><span class="op">.</span><span class="ide">monthday</span> <span class="op">==</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">fex</span> <span class="op">=</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">getCell</span>[:<span class="ide">ForExample</span>](<span class="str">&quot;F&quot;</span>, <span class="kwd">func</span>(<span class="ide">s</span>: <span class="ide">string</span>): <span class="ide">ForExample</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="kwd">discard</span> <span class="ide">scanf</span>(<span class="ide">s</span>, <span class="str">&quot;[$w:$i]&quot;</span>, <span class="ide">result</span><span class="op">.</span><span class="ide">a</span>, <span class="ide">result</span><span class="op">.</span><span class="ide">b</span>)</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fex</span><span class="op">.</span><span class="ide">a</span> <span class="op">==</span> <span class="str">&quot;A&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fex</span><span class="op">.</span><span class="ide">b</span> <span class="op">==</span> <span class="num">200</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># above examples we provide two example of using closure for converting</span></div></div><div class="line"><div class="line-content"><span class="com"># string representation of cell value to our intended object. With this,</span></div></div><div class="line"><div class="line-content"><span class="com"># users can roll their own conversion way to interpret the cell data.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Following the pattern like sequtils.map with sequtils.mapIt and others,</span></div></div><div class="line"><div class="line-content"><span class="com"># we also provide the shorthand with excelin.getCellIt</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">dtIt</span> <span class="op">=</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">getCellIt</span>[:<span class="ide">DateTime</span>](<span class="str">&quot;D&quot;</span>, <span class="ide">parse</span>(<span class="ide">it</span>, <span class="str">&quot;yyyy/MM/dd&quot;</span>))</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dtIt</span><span class="op">.</span><span class="ide">year</span> <span class="op">==</span> <span class="num">2200</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dtIt</span><span class="op">.</span><span class="ide">month</span> <span class="op">==</span> <span class="ide">mDec</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">dtIt</span><span class="op">.</span><span class="ide">monthday</span> <span class="op">==</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">fexIt</span> <span class="op">=</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">getCellIt</span>[:<span class="ide">ForExample</span>](<span class="str">&quot;F&quot;</span>, (</div></div><div class="line"><div class="line-content">    <span class="kwd">discard</span> <span class="ide">scanf</span>(<span class="ide">it</span>, <span class="str">&quot;[$w:$i]&quot;</span>, <span class="ide">result</span><span class="op">.</span><span class="ide">a</span>, <span class="ide">result</span><span class="op">.</span><span class="ide">b</span>)))</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fexIt</span><span class="op">.</span><span class="ide">a</span> <span class="op">==</span> <span class="str">&quot;A&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fexIt</span><span class="op">.</span><span class="ide">b</span> <span class="op">==</span> <span class="num">200</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># We also provide helpers `toNum` and `toCol` to convert string-int column</span></div></div><div class="line"><div class="line-content"><span class="com"># representation. Usually when we&apos;re working with array/seq of data,</span></div></div><div class="line"><div class="line-content"><span class="com"># we want to access the column string but we only have the int, so this</span></div></div><div class="line"><div class="line-content"><span class="com"># helpers will come handy.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row11</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">11</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">i</span> <span class="kwd">in</span> <span class="num">0</span> <span class="op">..&lt;</span> <span class="num">10</span>: <span class="com"># both toCol and toNum is starting from zero.</span></div></div><div class="line"><div class="line-content">    <span class="ide">row11</span>[<span class="ide">i</span><span class="op">.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">i</span><span class="op">.</span><span class="ide">toCol</span></div></div><div class="line"><div class="line-content">    </div></div><div class="line"><div class="line-content"><span class="com"># and let&apos;s see whether it&apos;s same or not</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">i</span>, <span class="ide">c</span> <span class="kwd">in</span> <span class="ide">toSeq</span>['A'<span class="op">..</span>'J']:</div></div><div class="line"><div class="line-content">    <span class="ide">doAssert</span> <span class="ide">row11</span>[<span class="op">$</span><span class="ide">c</span>, <span class="ide">string</span>]<span class="op">.</span><span class="ide">toNum</span> <span class="op">==</span> <span class="ide">i</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Starting from version 0.5.0, we add rows iterator for sheet and colums iterator</span></div></div><div class="line"><div class="line-content"><span class="com"># for row together with its last accessor. Let&apos;s see it in action.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">lastCol</span> <span class="op">==</span> <span class="str">&quot;J&quot;</span>        <span class="com"># lastCol returning string column</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row11</span><span class="op">.</span><span class="ide">lastCol</span> <span class="op">==</span> <span class="str">&quot;J&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">lastRow</span><span class="op">.</span><span class="ide">rowNum</span> <span class="op">==</span> <span class="num">11</span> <span class="com"># lastRow returning Row</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">col</span> <span class="kwd">in</span> <span class="ide">row11</span><span class="op">.</span><span class="ide">cols</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span> <span class="ide">col</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span>()</div></div><div class="line"><div class="line-content"><span class="com"># will print out:</span></div></div><div class="line"><div class="line-content"><span class="com">#ABCDEFGHIJ</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">row</span> <span class="kwd">in</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">rows</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">stdout</span><span class="op">.</span><span class="ide">write</span> <span class="ide">row</span><span class="op">.</span><span class="ide">rowNum</span>, <span class="str">&quot;, &quot;</span></div></div><div class="line"><div class="line-content"><span class="com"># will print out:</span></div></div><div class="line"><div class="line-content"><span class="com">#1, 11, </span></div></div><div class="line"><div class="line-content"><span class="com">#</span></div></div><div class="line"><div class="line-content"><span class="com"># note that row 2 and 5 are not shown because both are empty row even though we did access both row.</span></div></div><div class="line"><div class="line-content"><span class="com"># Fill with some value in its cells to make it not empty, and `Row.clear` does the reverse</span></div></div><div class="line"><div class="line-content"><span class="com"># by clearing all cells in a row.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">empty</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row5</span><span class="op">.</span><span class="ide">empty</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># finally, we have 2 options to access the binary Excel data, using `$` and</span></div></div><div class="line"><div class="line-content"><span class="com"># `writeFile`. Both of procs are the usual which `$` is stringify (that&apos;s</span></div></div><div class="line"><div class="line-content"><span class="com"># to return the string of Excel) and `writeFile` is accepting string path</span></div></div><div class="line"><div class="line-content"><span class="com"># to where the Excel data will be written.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">toSendToWire</span> <span class="op">=</span> <span class="op">$</span><span class="ide">excel</span></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span>(<span class="str">&quot;excelin-example-readme.xlsx&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># note that the current excelin.`$` is using the `writeFile` first to temporarily</span></div></div><div class="line"><div class="line-content"><span class="com"># write to file in $TEMP dir because the current zip lib dependency doesn&apos;t</span></div></div><div class="line"><div class="line-content"><span class="com"># provide the `$` to get the raw data from built zip directly.</span></div></div>  </code></pre>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Working-with-sheets</h2>
<p>Another example here we work directly with <code>Sheet</code> instead of the <code>Rows</code> and/or cells.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># prepare our excel</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">_</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet1&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># above we see that our excel has seq string with a member</span></div></div><div class="line"><div class="line-content"><span class="com"># &quot;Sheet1&quot;. The &quot;Sheet1&quot; is the default sheet when creating</span></div></div><div class="line"><div class="line-content"><span class="com"># a new Excel file.</span></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s add a sheet to our Excel.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">newsheet</span> <span class="op">=</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">addSheet</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">newsheet</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet1&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># above, we add a new sheet with supplied of the new-sheet name.</span></div></div><div class="line"><div class="line-content"><span class="com"># By checking with `sheetNames` proc, we see two sheets&apos; name.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s see what happen when we add a sheet without supplying the name</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">sheet3</span> <span class="op">=</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">addSheet</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">sheet3</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;Sheet3&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet1&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>, <span class="str">&quot;Sheet3&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># While the default name quite unexpected, we can guess the &quot;num&quot; part</span></div></div><div class="line"><div class="line-content"><span class="com"># for default sheet naming is related to how many we added/invoked</span></div></div><div class="line"><div class="line-content"><span class="com"># the `addSheet` proc. We&apos;ll see below example why it&apos;s done like this.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s add again</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">anewsheet</span> <span class="op">=</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">addSheet</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">anewsheet</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet1&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>, <span class="str">&quot;Sheet3&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Here, we added a new sheet using existing sheet name.</span></div></div><div class="line"><div class="line-content"><span class="com"># This can be done because internally Excel workbook holds the reference of</span></div></div><div class="line"><div class="line-content"><span class="com"># sheets is by using its id instead of the name. Hence adding a same name</span></div></div><div class="line"><div class="line-content"><span class="com"># for new sheet is possible.</span></div></div><div class="line"><div class="line-content"><span class="com"># For the consquence, let&apos;s see what happens when we delete a sheet below</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># work fine case</span></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">deleteSheet</span> <span class="str">&quot;Sheet1&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;new-sheet&quot;</span>, <span class="str">&quot;Sheet3&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># deleting sheet with name &quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">deleteSheet</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet3&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># will delete the older one since it&apos;s the first the sheet found with &quot;new-sheet&quot; name</span></div></div><div class="line"><div class="line-content"><span class="com"># when there&apos;s no name available, Excel file will do nothing.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">deleteSheet</span> <span class="str">&quot;aww-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet3&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># still same as before.</span></div></div><div class="line"><div class="line-content"><span class="com"># Below example we illustrate how to get by sheet name.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">anewsheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">1</span>)[<span class="str">&quot;A&quot;</span>] <span class="op">=</span> <span class="str">&quot;temptest&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">anewsheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">1</span>)[<span class="str">&quot;A&quot;</span>, <span class="ide">string</span>] <span class="op">==</span> <span class="str">&quot;temptest&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">addSheet</span> <span class="str">&quot;new-sheet&quot;</span> <span class="com"># add a new to make it duplicate</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">foundOlderSheet</span> <span class="op">=</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">getSheet</span> <span class="str">&quot;new-sheet&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">foundOlderSheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">1</span>)[<span class="str">&quot;A&quot;</span>, <span class="ide">string</span>] <span class="op">==</span> <span class="str">&quot;temptest&quot;</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Here we get sheet by name, and like deleting the sheet, fetching/getting</span></div></div><div class="line"><div class="line-content"><span class="com"># the sheet also returning the older sheet of the same name.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">excel</span><span class="op">.</span><span class="ide">sheetNames</span> <span class="op">==</span> <span class="op">@</span>[<span class="str">&quot;Sheet3&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>, <span class="str">&quot;new-sheet&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> (<span class="str">&quot;many-sheets.xlsx&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Write it to file and open it with our favorite Excel viewer to see 3 sheets:</span></div></div><div class="line"><div class="line-content"><span class="com"># Sheet3, new-sheet and new-sheet.</span></div></div><div class="line"><div class="line-content"><span class="com"># Using libreoffice to view the Excel file, the duplicate name will be appended with</span></div></div><div class="line"><div class="line-content"><span class="com"># format {sheetName}-{numDuplicated}.</span></div></div><div class="line"><div class="line-content"><span class="com"># We can replicate that behaviour too but currently we support duplicate sheet name.</span></div></div>  </code></pre>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Cell Formula</h2>
<p>We support rudimentary of filling and fetching cell with format of Formula.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">math</span> <span class="kwd">import</span> <span class="ide">cbrt</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">excelin</span> <span class="kwd">import</span></div></div><div class="line"><div class="line-content">    <span class="ide">newExcel</span>,   <span class="com"># the usual for creating empty excel</span></div></div><div class="line"><div class="line-content">    <span class="ide">row</span>,        <span class="com"># for fetching row from sheet</span></div></div><div class="line"><div class="line-content">    <span class="ide">toCol</span>,      <span class="com"># to get string column from integer</span></div></div><div class="line"><div class="line-content">    <span class="ide">Formula</span>,    <span class="com"># the cell type object this example for.</span></div></div><div class="line"><div class="line-content">    `[]<span class="op">=</span>`,      <span class="com"># fill cell</span></div></div><div class="line"><div class="line-content">    `[]`,       <span class="com"># fetch cell</span></div></div><div class="line"><div class="line-content">    <span class="ide">writeFile</span>,  <span class="com"># finally, to write to file</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s setup some simple data in a row 1 with col A..J simple seq of int</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">sum</span> <span class="op">=</span> <span class="num">0</span> <span class="com"># this will be our calculated result</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">i</span> <span class="kwd">in</span> <span class="num">0</span> <span class="op">..</span> <span class="num">9</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">row1</span>[<span class="ide">i</span><span class="op">.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">i</span></div></div><div class="line"><div class="line-content">    <span class="ide">sum</span> <span class="op">+=</span> <span class="ide">i</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Here, we simply fill A1 = 0, B1 = 1, ... J1 = 9</span></div></div><div class="line"><div class="line-content"><span class="com"># while the equation is to sum values from cell A to J in K1.</span></div></div><div class="line"><div class="line-content"><span class="com"># Additionally, we&apos;ll add another example which depend</span></div></div><div class="line"><div class="line-content"><span class="com"># on another formula cell with equation CUBE(K1) in L1</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="num">10.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">Formula</span>(<span class="ide">equation</span>: <span class="str">&quot;SUM(A1:J1)&quot;</span>, <span class="ide">valueStr</span>: <span class="op">$</span><span class="ide">sum</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">cubesum</span> <span class="op">=</span> <span class="ide">cbrt</span>(<span class="ide">float64</span> <span class="ide">sum</span>)</div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="num">11.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">Formula</span>(<span class="ide">equation</span>: <span class="str">&quot;CUBE(K1)&quot;</span>, <span class="ide">valueStr</span>: <span class="op">$</span><span class="ide">cubesum</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Formula has two public fields, equation which is the formula string itself</span></div></div><div class="line"><div class="line-content"><span class="com"># and valueStr, the string of calcluated value.</span></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s fetch and check it</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">fmr</span> <span class="op">=</span> <span class="ide">row1</span>[<span class="str">&quot;k&quot;</span>, <span class="ide">Formula</span>]</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fmr</span><span class="op">.</span><span class="ide">equation</span> <span class="op">==</span> <span class="str">&quot;SUM(A1:J1)&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fmr</span><span class="op">.</span><span class="ide">valueStr</span> <span class="op">==</span> <span class="str">&quot;45&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">f1l</span> <span class="op">=</span> <span class="ide">row1</span>[<span class="str">&quot;l&quot;</span>, <span class="ide">Formula</span>]</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">f1l</span><span class="op">.</span><span class="ide">equation</span> <span class="op">==</span> <span class="str">&quot;CUBE(K1)&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">f1l</span><span class="op">.</span><span class="ide">valueStr</span> <span class="op">==</span> <span class="op">$</span><span class="ide">cubesum</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># As this is rudimentary support for formula format, the equation itself</span></div></div><div class="line"><div class="line-content"><span class="com"># is simply string that we&apos;ll fill to cell, and the value is something</span></div></div><div class="line"><div class="line-content"><span class="com"># that we calculate manually on our end.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># What if we fill another formula with its equation only? The value is simply</span></div></div><div class="line"><div class="line-content"><span class="com"># nothing since we didn&apos;t fill its value.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span>[<span class="str">&quot;m&quot;</span>] <span class="op">=</span> <span class="ide">Formula</span>(<span class="ide">equation</span>: <span class="str">&quot;L1&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">f1m</span> <span class="op">=</span> <span class="ide">row1</span>[<span class="str">&quot;m&quot;</span>, <span class="ide">Formula</span>]</div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">f1m</span><span class="op">.</span><span class="ide">equation</span> <span class="op">==</span> <span class="str">&quot;L1&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">f1m</span><span class="op">.</span><span class="ide">valueStr</span> <span class="op">==</span> <span class="str">&quot;&quot;</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># lastly, as usual, let&apos;s write to file and check it other excel viewer apps.</span></div></div><div class="line"><div class="line-content"><span class="com"># note for cell M1 as we supplied empty value in above.</span></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-sum-example.xlsx&quot;</span></div></div>  </code></pre>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Cell styling</h2>
<p>In this example we&apos;ll see various styling provided for cells in row.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">std</span><span class="op">/</span><span class="ide">colors</span> <span class="com"># to work with coloring</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">sequtils</span> <span class="kwd">import</span> <span class="ide">repeat</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">strutils</span> <span class="kwd">import</span> <span class="ide">join</span></div></div><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">excelin</span> <span class="kwd">import</span></div></div><div class="line"><div class="line-content">    <span class="ide">newExcel</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">row</span>,</div></div><div class="line"><div class="line-content">    `[]<span class="op">=</span>`,</div></div><div class="line"><div class="line-content">    </div></div><div class="line"><div class="line-content">    <span class="ide">BorderProp</span>,  <span class="com"># The object of Border which style is ready to be applied</span></div></div><div class="line"><div class="line-content">    <span class="ide">BorderStyle</span>, <span class="com"># Enum for selecting border style,</span></div></div><div class="line"><div class="line-content">                 <span class="com"># not to confuse with `borderStyle` proc for setting up</span></div></div><div class="line"><div class="line-content">                 <span class="com"># style mentioned below section</span></div></div><div class="line"><div class="line-content">    <span class="ide">PatternType</span>, <span class="com"># Enum for selecting fill style pattern</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">    <span class="com"># This part of APIs is for setting up the style.</span></div></div><div class="line"><div class="line-content">    <span class="com"># The naming pattern is `{objectTypeName}style` viz.</span></div></div><div class="line"><div class="line-content">    <span class="com"># Font -&gt; fontStyle</span></div></div><div class="line"><div class="line-content">    <span class="com"># Border -&gt; borderStyle</span></div></div><div class="line"><div class="line-content">    <span class="com"># etc</span></div></div><div class="line"><div class="line-content">    <span class="ide">style</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">fontStyle</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">borderStyle</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">borderPropStyle</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">fillStyle</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">patternFillStyle</span>,</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">    <span class="com"># For linking style between cells</span></div></div><div class="line"><div class="line-content">    <span class="ide">shareStyle</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">copyStyle</span>,</div></div><div class="line"><div class="line-content">    </div></div><div class="line"><div class="line-content">    <span class="com"># This part of APIs is for getting the style.</span></div></div><div class="line"><div class="line-content">    <span class="com"># The naming pattern is `style{ObjectTypeName}` viz.</span></div></div><div class="line"><div class="line-content">    <span class="com"># Font -&gt; styleFont, Fill -&gt; styleFill, Border -&gt; styleBorder</span></div></div><div class="line"><div class="line-content">    <span class="ide">styleFont</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">styleFill</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">styleBorder</span>,</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">    <span class="ide">height</span>,</div></div><div class="line"><div class="line-content">    `<span class="ide">height</span><span class="op">=</span>`,</div></div><div class="line"><div class="line-content">    <span class="ide">writeFile</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row2</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">2</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com">## Let&apos;s fill some data.</span></div></div><div class="line"><div class="line-content"><span class="ide">row2</span>[<span class="str">&quot;D&quot;</span>] <span class="op">=</span> <span class="str">&quot;temperian temptest&quot;</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com">## Now we want to set some style for this particular cell D2.</span></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">style</span>(<span class="str">&quot;D&quot;</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">font</span> <span class="op">=</span> <span class="ide">fontStyle</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">name</span> <span class="op">=</span> <span class="str">&quot;DejaVu Sans Mono&quot;</span>,</div></div><div class="line"><div class="line-content">        <span class="ide">size</span> <span class="op">=</span> <span class="num">11</span>,</div></div><div class="line"><div class="line-content">        <span class="ide">color</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colBlue</span>, <span class="com"># blue font</span></div></div><div class="line"><div class="line-content">    ),</div></div><div class="line"><div class="line-content">    <span class="ide">border</span> <span class="op">=</span> <span class="ide">borderStyle</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">top</span> <span class="op">=</span> <span class="ide">borderPropStyle</span>(<span class="ide">style</span> <span class="op">=</span> <span class="ide">bsMedium</span>, <span class="ide">color</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colRed</span>),</div></div><div class="line"><div class="line-content">        <span class="ide">bottom</span> <span class="op">=</span> <span class="ide">borderPropStyle</span>(<span class="ide">style</span> <span class="op">=</span> <span class="ide">bsMediumDashDot</span>, <span class="ide">color</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colGreen</span>),</div></div><div class="line"><div class="line-content">    ),</div></div><div class="line"><div class="line-content">    <span class="ide">fill</span> <span class="op">=</span> <span class="ide">fillStyle</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">pattern</span> <span class="op">=</span> <span class="ide">patternFillStyle</span>(<span class="ide">patternType</span> <span class="op">=</span> <span class="ide">ptLightGrid</span>, <span class="ide">fgColor</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colRed</span>)</div></div><div class="line"><div class="line-content">    ),</div></div><div class="line"><div class="line-content">    </div></div><div class="line"><div class="line-content">    <span class="com"># Lastly alignment as openarray of pair (string, string),</span></div></div><div class="line"><div class="line-content">    <span class="com"># using openarray for easier to iterate and can be selectively</span></div></div><div class="line"><div class="line-content">    <span class="com"># chosen which style to be applied, other attributes that not recognized</span></div></div><div class="line"><div class="line-content">    <span class="com"># by excel will do nothing.</span></div></div><div class="line"><div class="line-content">    <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;horizontal&quot;</span>: <span class="str">&quot;center&quot;</span>, <span class="str">&quot;vertical&quot;</span>: <span class="str">&quot;center&quot;</span>,</div></div><div class="line"><div class="line-content">        <span class="str">&quot;wrapText&quot;</span>: <span class="op">$</span><span class="ide">true</span>, <span class="str">&quot;textRotation&quot;</span>: <span class="op">$</span><span class="num">45</span>})</div></div><div class="line"><div class="line-content">        </div></div><div class="line"><div class="line-content"><span class="com"># Libreoffice apparently doesn&apos;t support grid filling hence the bgColor is</span></div></div><div class="line"><div class="line-content"><span class="com"># ignored and only read the fgColor.</span></div></div><div class="line"><div class="line-content"><span class="com"># Above we setup the style after putting the value, the reverse is valid too.</span></div></div><div class="line"><div class="line-content"><span class="com"># i.e. set the style and put the value.</span></div></div><div class="line"><div class="line-content"><span class="com"># For setting up font, border and fill, we&apos;re using object initializer proc</span></div></div><div class="line"><div class="line-content"><span class="com"># with pattern of &quot;{objectName}Style&quot;.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">style</span>(<span class="str">&quot;E&quot;</span>,</div></div><div class="line"><div class="line-content">    <span class="ide">border</span> <span class="op">=</span> <span class="ide">borderStyle</span>(`<span class="kwd">end</span>` <span class="op">=</span> <span class="ide">borderPropStyle</span>(<span class="ide">style</span> <span class="op">=</span> <span class="ide">bsDashDot</span>, <span class="ide">color</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colAzure</span>)),</div></div><div class="line"><div class="line-content">    <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;wrapText&quot;</span>: <span class="op">$</span><span class="ide">true</span>},</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">longstr</span> <span class="op">=</span> <span class="str">&quot;brown fox jumps over the lazy dog&quot;</span><span class="op">.</span><span class="ide">repeat</span>(<span class="num">5</span>)<span class="op">.</span><span class="ide">join</span>(<span class="str">&quot;;&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">row2</span>[<span class="str">&quot;E&quot;</span>] <span class="op">=</span> <span class="ide">longstr</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># We can also modify set style and change the existing</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">style</span> <span class="str">&quot;D&quot;</span>, <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;textRotation&quot;</span>: <span class="op">$</span><span class="num">90</span>}</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># here, we changed the alignment style from diagonal direction (45)  to upstand (90).</span></div></div><div class="line"><div class="line-content"><span class="com"># We can also share a cell style to other cells and since it&apos;s shared, any changes to</span></div></div><div class="line"><div class="line-content"><span class="com"># other cells for its styling will affect all others cell it&apos;s related.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">shareStyle</span>(<span class="str">&quot;D2&quot;</span>, <span class="str">&quot;D4&quot;</span>, <span class="str">&quot;E4&quot;</span>, <span class="str">&quot;F4&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">shareStyle</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;D4&quot;</span>, <span class="str">&quot;E4&quot;</span>, <span class="str">&quot;F4&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Above, we shares D2 cell style to cells D4, E4, and F4 using two differents</span></div></div><div class="line"><div class="line-content"><span class="com"># proc which work same. This way we can work whether we only have the sheet</span></div></div><div class="line"><div class="line-content"><span class="com"># or we already have the row.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Another way is to copyStyle, as its named so, we copy style from source cell</span></div></div><div class="line"><div class="line-content"><span class="com"># to target cell(s). This way any changes to any cells it&apos;s copied from and to</span></div></div><div class="line"><div class="line-content"><span class="com"># will not affect each others.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">copyStyle</span>(<span class="str">&quot;D2&quot;</span>, <span class="str">&quot;D5&quot;</span>, <span class="str">&quot;E5&quot;</span>, <span class="str">&quot;F5&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">copyStyle</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;D5&quot;</span>, <span class="str">&quot;E5&quot;</span>, <span class="str">&quot;F5&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Apart from sharing and/or copying the style, we can actually fetch the specific</span></div></div><div class="line"><div class="line-content"><span class="com"># setting from cell style.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">font</span> <span class="op">=</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">styleFont</span> <span class="str">&quot;D&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">font</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;DejaVu Sans Mono&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">font</span><span class="op">.</span><span class="ide">size</span> <span class="op">==</span> <span class="num">11</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">font</span><span class="op">.</span><span class="ide">color</span> <span class="op">==</span> <span class="op">$</span><span class="ide">colBlue</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">font</span><span class="op">.</span><span class="ide">family</span> <span class="op">==</span> <span class="op">-</span><span class="num">1</span>  <span class="com"># negative value means it will be ignored when applying syle</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">font</span><span class="op">.</span><span class="ide">charset</span> <span class="op">==</span> <span class="op">-</span><span class="num">1</span> <span class="com"># idem</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">fill</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">styleFill</span> <span class="str">&quot;D2&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fill</span><span class="op">.</span><span class="ide">pattern</span><span class="op">.</span><span class="ide">fgColor</span> <span class="op">==</span> <span class="op">$</span><span class="ide">colRed</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fill</span><span class="op">.</span><span class="ide">pattern</span><span class="op">.</span><span class="ide">patternType</span> <span class="op">==</span> <span class="ide">ptLightGrid</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fill</span><span class="op">.</span><span class="ide">gradient</span><span class="op">.</span><span class="ide">stop</span><span class="op">.</span><span class="ide">color</span> <span class="op">==</span> <span class="str">&quot;&quot;</span> <span class="com"># we didn&apos;t set the gradient when setting the fillStyle</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">fill</span><span class="op">.</span><span class="ide">gradient</span><span class="op">.</span><span class="ide">stop</span><span class="op">.</span><span class="ide">position</span> <span class="op">==</span> <span class="num">0.0</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">border</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">styleBorder</span> <span class="str">&quot;D2&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">border</span><span class="op">.</span><span class="ide">top</span><span class="op">.</span><span class="ide">style</span> <span class="op">==</span> <span class="ide">bsMedium</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">border</span><span class="op">.</span><span class="ide">top</span><span class="op">.</span><span class="ide">color</span> <span class="op">==</span> <span class="op">$</span><span class="ide">colRed</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">border</span><span class="op">.</span><span class="ide">bottom</span><span class="op">.</span><span class="ide">style</span> <span class="op">==</span> <span class="ide">bsMediumDashDot</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">border</span><span class="op">.</span><span class="ide">bottom</span><span class="op">.</span><span class="ide">color</span> <span class="op">==</span> <span class="op">$</span><span class="ide">colGreen</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Above, we fetch specifically for font, fill, and border using two different (which work same)</span></div></div><div class="line"><div class="line-content"><span class="com"># ways, row proc and sheet proc. Sheet proc underlyingly is using row proc too but both</span></div></div><div class="line"><div class="line-content"><span class="com"># are provided in case we only has row or sheet. The only difference that row only needs to</span></div></div><div class="line"><div class="line-content"><span class="com"># specified the column while the sheet needs to to specify column row cell.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Now we want to see the cell in its row.</span></div></div><div class="line"><div class="line-content"><span class="com"># Since the cell E2 is quite long and with its alignment has wrapText true, we can also</span></div></div><div class="line"><div class="line-content"><span class="com"># manually change the row height to see all the text.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">height</span> <span class="op">=</span> <span class="num">200</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># By definition, the value is point but it&apos;s not clear the relation what&apos;s the point points.</span></div></div><div class="line"><div class="line-content"><span class="com"># So if we want to leave how the height for other application to read, we can reset by</span></div></div><div class="line"><div class="line-content"><span class="com"># setting the height 0</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">height</span> <span class="op">=</span> <span class="num">0</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># But let&apos;s set back to 200 to see how it looks when written to excel file.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row2</span><span class="op">.</span><span class="ide">height</span> <span class="op">=</span> <span class="num">200</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">height</span> <span class="op">==</span> <span class="num">200</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># And of course we can check what&apos;s its set height like above,</span></div></div><div class="line"><div class="line-content"><span class="com"># return 0 if the height reset.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-example-row-style.xlsx&quot;</span></div></div>  </code></pre>
<p>This is what it looks like when viewed with Libreoffice.</p>
<p>  <img src="assets/cell-style.png" style="max-width: 100%;" alt="cell style" /></p>
<p>And below is what it looks like when viewed with WPS spreadsheet.</p>
<p>  <img src="assets/cell-style-wps.png" style="max-width: 100%;" alt="cell style in wps" /></p>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Row display</h2>
<p>In this example, we&apos;ll see how to hide, adding the outline level and collapse
the row.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">std</span><span class="op">/</span><span class="ide">with</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">template</span> <span class="ide">hideLevel</span>(<span class="ide">rnum</span>, <span class="ide">olevel</span>: <span class="ide">int</span>): <span class="ide">untyped</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">r</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="ide">rnum</span></div></div><div class="line"><div class="line-content">  <span class="ide">with</span> <span class="ide">r</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">hide</span> <span class="op">=</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content">    <span class="ide">outlineLevel</span> <span class="op">=</span> <span class="ide">olevel</span></div></div><div class="line"><div class="line-content">  <span class="ide">r</span></div></div><div class="line"><div class="line-content">    </div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">2</span>)<span class="op">.</span><span class="ide">hide</span> <span class="op">=</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="num">3.</span><span class="ide">hideLevel</span> <span class="num">3</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="num">4.</span><span class="ide">hideLevel</span> <span class="num">2</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="num">5.</span><span class="ide">hideLevel</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row6</span> <span class="op">=</span> <span class="num">6.</span><span class="ide">hideLevel</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"><span class="ide">row6</span><span class="op">.</span><span class="ide">collapsed</span> <span class="op">=</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row7</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">7</span></div></div><div class="line"><div class="line-content"><span class="ide">row7</span><span class="op">.</span><span class="ide">outlineLevel</span> <span class="op">=</span> <span class="num">7</span> <span class="com"># we&apos;ll use this to reset the outline below</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Above example we setup 3 rows, row 3 - 5 which each has different</span></div></div><div class="line"><div class="line-content"><span class="com"># outline level decreasing from 3 to 1.</span></div></div><div class="line"><div class="line-content"><span class="com"># For row 6, we set it to be collapsed by setting it true.</span></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s reset the row 7 outline level by set it to 0.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">row7</span><span class="op">.</span><span class="ide">outlineLevel</span> <span class="op">=</span> <span class="num">0</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-example-row-display.xlsx&quot;</span></div></div>  </code></pre>
<p>  <img src="assets/rows-outline-collapsing.gif" style="max-width: 100%;" alt="rows outline collapsing" /></p>
<p>As we can see above, the row 2 is hidden with outline level 0 so we can&apos;t see it anymore.<br />
While row 3, 4, 5 has different outline level with row 6 has outline level 1 and it&apos;s collapsed.<br />
So we can expand and collapse due different outline level.</p>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Sheet auto filter</h2>
<p>In this example, we&apos;ll see how to add auto filter by setting ranges to sheet.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">strformat</span> <span class="kwd">import</span> <span class="ide">fmt</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s add a function for easier to populate data in row.</span></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">populateRow</span>(<span class="ide">row</span>: <span class="ide">Row</span>, <span class="ide">col</span>, <span class="ide">cat</span>: <span class="ide">string</span>, <span class="ide">data</span>: <span class="ide">array</span>[<span class="num">3</span>, <span class="ide">float</span>]) <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">startcol</span> <span class="op">=</span> <span class="ide">col</span><span class="op">.</span><span class="ide">toNum</span> <span class="op">+</span> <span class="num">1</span></div></div><div class="line"><div class="line-content">  <span class="ide">row</span>[<span class="ide">col</span>] <span class="op">=</span> <span class="ide">cat</span></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">sum</span> <span class="op">=</span> <span class="num">0.0</span></div></div><div class="line"><div class="line-content">  <span class="kwd">for</span> <span class="ide">i</span>, <span class="ide">d</span> <span class="kwd">in</span> <span class="ide">data</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">row</span>[(<span class="ide">startcol</span><span class="op">+</span><span class="ide">i</span>)<span class="op">.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">d</span></div></div><div class="line"><div class="line-content">    <span class="ide">sum</span> <span class="op">+=</span> <span class="ide">d</span></div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">rnum</span> <span class="op">=</span> <span class="ide">row</span><span class="op">.</span><span class="ide">rowNum</span></div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">eqrange</span> <span class="op">=</span> fmt"SUM({col}{rnum}:{(startcol+data.len-1).toCol}{rnum})" </div></div><div class="line"><div class="line-content">  <span class="ide">dump</span> <span class="ide">eqrange</span></div></div><div class="line"><div class="line-content">  <span class="ide">row</span>[(<span class="ide">startcol</span><span class="op">+</span><span class="ide">data</span><span class="op">.</span><span class="ide">len</span>)<span class="op">.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">Formula</span>(<span class="ide">equation</span>: <span class="ide">eqrange</span>, <span class="ide">valueStr</span>: <span class="op">$</span><span class="ide">sum</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># The row data we will work in will be in format</span></div></div><div class="line"><div class="line-content"><span class="com"># D{rnum}: string (Category)</span></div></div><div class="line"><div class="line-content"><span class="com"># E{rnum}: float (Num1)</span></div></div><div class="line"><div class="line-content"><span class="com"># F{rnum}: float (Num2)</span></div></div><div class="line"><div class="line-content"><span class="com"># G{rnum}: float (Num3)</span></div></div><div class="line"><div class="line-content"><span class="com"># H{rnum}: float (Total) with formula SUM(E{rnum}:G{rnum})</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row5</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">5</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">startcol</span> <span class="op">=</span> <span class="str">&quot;D&quot;</span><span class="op">.</span><span class="ide">toNum</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">i</span>, <span class="ide">s</span> <span class="kwd">in</span> [<span class="str">&quot;Category&quot;</span>, <span class="str">&quot;Num1&quot;</span>, <span class="str">&quot;Num2&quot;</span>, <span class="str">&quot;Num3&quot;</span>, <span class="str">&quot;Total&quot;</span>]:</div></div><div class="line"><div class="line-content">  <span class="ide">row5</span>[(<span class="ide">startcol</span><span class="op">+</span><span class="ide">i</span>)<span class="op">.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="ide">s</span></div></div><div class="line"><div class="line-content">  </div></div><div class="line"><div class="line-content"><span class="com"># Above, we set the row 5 starting from D to H i.e. D5:H5  </span></div></div><div class="line"><div class="line-content"><span class="com"># as header for data we will work on.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">6</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;A&quot;</span>, [<span class="num">0.18460660235998017</span>, <span class="num">0.93463071023892952</span>, <span class="num">0.58647760893211043</span>])</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">7</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;A&quot;</span>, [<span class="num">0.50425224796279555</span>, <span class="num">0.25118866081991786</span>, <span class="num">0.26918159410869791</span>])</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">8</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;A&quot;</span>, [<span class="num">0.6006019062877066</span>, <span class="num">0.18319235857964333</span>, <span class="num">0.12254334000604317</span>])</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">9</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;A&quot;</span>, [<span class="num">0.78015011938458589</span>, <span class="num">0.78159963723670689</span>, <span class="num">6.7448346870105036E-2</span>])</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">10</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;B&quot;</span>, [<span class="num">0.63608141933645479</span>, <span class="num">0.35635845012920608</span>, <span class="num">0.67122053637107193</span>])</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span>(<span class="num">11</span>)<span class="op">.</span><span class="ide">populateRow</span>(<span class="str">&quot;D&quot;</span>, <span class="str">&quot;B&quot;</span>, [<span class="num">0.33327331908137214</span>, <span class="num">0.2256497329592122</span>, <span class="num">0.5793989116090501</span>])</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">ranges</span> <span class="op">=</span> (<span class="str">&quot;D5&quot;</span>, <span class="str">&quot;H11&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">autoFilter</span> <span class="op">=</span> (<span class="str">&quot;D5&quot;</span>, <span class="str">&quot;H11&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># We set the range to sheet by assigning Range which is (top left cell, bottom right cell).</span></div></div><div class="line"><div class="line-content"><span class="com"># Setting up range will not setup the auto filter but setup the auto filter will setup</span></div></div><div class="line"><div class="line-content"><span class="com"># sheet range.</span></div></div><div class="line"><div class="line-content"><span class="com"># We can remove the auto filter by supplying it with empty range (&quot;&quot;, &quot;&quot;).</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s fill the filtering itself.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">filterCol</span> <span class="num">0</span>, <span class="ide">Filter</span>(<span class="ide">kind</span>: <span class="ide">ftFilter</span>, <span class="ide">valuesStr</span>: <span class="op">@</span>[<span class="str">&quot;A&quot;</span>])</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Here, we setup simple filter that will be equal to what value it&apos;s provided.</span></div></div><div class="line"><div class="line-content"><span class="com"># In above case, we filter the Category column which has value &quot;A&quot;, and &quot;B&quot; so</span></div></div><div class="line"><div class="line-content"><span class="com"># we only get the column that has Category &quot;A&quot;. We can also the valuesStr with</span></div></div><div class="line"><div class="line-content"><span class="com"># @[&quot;A&quot;, &quot;B&quot;] to get both of data. If there&apos;s N data we want to match, supply</span></div></div><div class="line"><div class="line-content"><span class="com"># those all in valuesStr field.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Below we see another supported filter, custom logic filter</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">filterCol</span> <span class="num">1</span>, <span class="ide">Filter</span>(<span class="ide">kind</span>: <span class="ide">ftCustom</span>, <span class="ide">logic</span>: <span class="ide">cflAnd</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">customs</span>: <span class="op">@</span>[(<span class="ide">foGt</span>, <span class="op">$</span><span class="num">0</span>), (<span class="ide">foLt</span>, <span class="op">$</span><span class="num">0.7</span>)])</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># here we provide the filter with filter type custom (ftCustom)</span></div></div><div class="line"><div class="line-content"><span class="com"># with its logic &quot;and&quot; (cflAnd).</span></div></div><div class="line"><div class="line-content"><span class="com"># In this custom filter, we set the column 1, which Num1 to be</span></div></div><div class="line"><div class="line-content"><span class="com"># value greater than 0 (foGt) and less than 0.7 (foLt)</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-example-autofilter.xlsx&quot;</span></div></div>  </code></pre>
<p>  <img src="assets/sheet-autofilter.png" style="max-width: 100%;" alt="resulted sheet auto filter range" /></p>
<p>Above is the result from Google sheet.</p>
<p>  <img src="assets/sheet-autofilter-wps.png" style="max-width: 100%;" alt="resulted sheet auto filter range in wps spreadsheet" /></p>
<p>And this is screenshot when checked with WPS spreadsheet. The difference
with Google sheet that in WPS the column 0 (Category) and column 1 (Num1)
has different icon because the filtering already defined in those two
columns in our example.</p>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Cell merge</h2>
<p>For this example, we&apos;ll see how to merge, reset it and also reset style
inherited from previous merged cells.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">std</span><span class="op">/</span><span class="ide">colors</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">cellsToMerge</span> <span class="op">=</span> [</div></div><div class="line"><div class="line-content">  (<span class="str">&quot;DejaVu Sans Mono&quot;</span>, <span class="num">1</span>, <span class="str">&quot;A&quot;</span>, <span class="ide">colGreen</span>, (<span class="str">&quot;A1&quot;</span>, <span class="str">&quot;E1&quot;</span>)), <span class="com"># merge in range A1:E1 with font Dejavu Sans Mono</span></div></div><div class="line"><div class="line-content">  (<span class="str">&quot;Roboto&quot;</span>, <span class="num">3</span>, <span class="str">&quot;A&quot;</span>, <span class="ide">colBlue</span>, (<span class="str">&quot;A3&quot;</span>, <span class="str">&quot;B5&quot;</span>)),</div></div><div class="line"><div class="line-content">  (<span class="str">&quot;Verdana&quot;</span>, <span class="num">3</span>, <span class="str">&quot;D&quot;</span>, <span class="ide">colRed</span>, (<span class="str">&quot;D3&quot;</span>, <span class="str">&quot;E5&quot;</span>)),</div></div><div class="line"><div class="line-content">  (<span class="str">&quot;Consolas&quot;</span>, <span class="num">7</span>, <span class="str">&quot;A&quot;</span>, <span class="ide">colBlack</span>, (<span class="str">&quot;A7&quot;</span>, <span class="str">&quot;E8&quot;</span>))          <span class="com"># used for deleting merged cells example</span></div></div><div class="line"><div class="line-content">]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> (<span class="ide">fontname</span>, <span class="ide">rownum</span>, <span class="ide">col</span>, <span class="ide">color</span>, `<span class="ide">range</span>`) <span class="kwd">in</span> <span class="ide">cellsToMerge</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">row</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="ide">rownum</span></div></div><div class="line"><div class="line-content">  <span class="ide">row</span><span class="op">.</span><span class="ide">style</span>(<span class="ide">col</span>,</div></div><div class="line"><div class="line-content">    <span class="com">#font = fontStyle(name = fontname, size = 13, color = $color),</span></div></div><div class="line"><div class="line-content">    <span class="ide">font</span> <span class="op">=</span> <span class="ide">fontStyle</span>(<span class="ide">name</span> <span class="op">=</span> <span class="ide">fontname</span>, <span class="ide">size</span> <span class="op">=</span> <span class="num">13</span>),</div></div><div class="line"><div class="line-content">    <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;horizontal&quot;</span>: <span class="str">&quot;center&quot;</span>, <span class="str">&quot;vertical&quot;</span>: <span class="str">&quot;center&quot;</span>},</div></div><div class="line"><div class="line-content">    <span class="ide">fill</span> <span class="op">=</span> <span class="ide">fillStyle</span>(</div></div><div class="line"><div class="line-content">      <span class="ide">pattern</span> <span class="op">=</span> <span class="ide">patternFillStyle</span>(<span class="ide">patternType</span> <span class="op">=</span> <span class="ide">ptLightTrellis</span>, <span class="ide">fgColor</span> <span class="op">=</span> <span class="op">$</span><span class="ide">color</span>),</div></div><div class="line"><div class="line-content">    ),</div></div><div class="line"><div class="line-content">  )</div></div><div class="line"><div class="line-content">  <span class="ide">row</span>[<span class="ide">col</span>] <span class="op">=</span> <span class="ide">fontname</span></div></div><div class="line"><div class="line-content">  <span class="ide">sheet</span><span class="op">.</span><span class="ide">mergeCells</span> <span class="op">=</span> `<span class="ide">range</span>`</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s remove the last merged cells.</span></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">resetMerge</span> <span class="ide">cellsToMerge</span>[<span class="op">^</span><span class="num">1</span>][<span class="num">4</span>]</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># By default, when resetting merge, the existing style (top left cell style)</span></div></div><div class="line"><div class="line-content"><span class="com"># is copied to its subsequent cells in the previous range.</span></div></div><div class="line"><div class="line-content"><span class="com"># We can use resetStyle to remove it.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># The reset merge in range A7:E8, we selectively reset cells.</span></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">resetStyle</span>(<span class="str">&quot;B7&quot;</span>, <span class="str">&quot;D7&quot;</span>, <span class="str">&quot;A8&quot;</span>, <span class="str">&quot;C8&quot;</span>, <span class="str">&quot;E8&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-example-merge-cells.xlsx&quot;</span></div></div>  </code></pre>
<p>This is the result when viewed with Libreoffice</p>
<p>  <img src="assets/merge-cells-libreoffice.png" style="max-width: 100%;" alt="cell merges libreoffice" /></p>
<p>This is the result when viewed with WPS</p>
<p>  <img src="assets/merge-cells-wps.png" style="max-width: 100%;" alt="cell merges wps" /></p>
<p>  <a href="#examples">Back to examples list</a></p>
<h2>Sheet page breaks</h2>
<p>This example we&apos;ll see how to add page break to our sheet.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">from</span> <span class="ide">std</span><span class="op">/</span><span class="ide">strformat</span> <span class="kwd">import</span> <span class="ide">fmt</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">std</span><span class="op">/</span><span class="ide">colors</span></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">excelin</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">excel</span>, <span class="ide">sheet</span>) <span class="op">=</span> <span class="ide">newExcel</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Let&apos;s add page break inserted at row 10 with some info</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row10</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">10</span></div></div><div class="line"><div class="line-content"><span class="ide">row10</span><span class="op">.</span><span class="ide">pageBreak</span>()</div></div><div class="line"><div class="line-content"><span class="ide">row10</span>[<span class="str">&quot;A&quot;</span>] <span class="op">=</span> <span class="str">&quot;Above this is the horizontal page break&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">row10</span><span class="op">.</span><span class="ide">style</span>(<span class="str">&quot;A&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">fill</span> <span class="op">=</span> <span class="ide">fillStyle</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">pattern</span> <span class="op">=</span> <span class="ide">patternFillStyle</span>(<span class="ide">patternType</span> <span class="op">=</span> <span class="ide">ptLightGray</span>, <span class="ide">fgColor</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colRed</span>),</div></div><div class="line"><div class="line-content">  ),</div></div><div class="line"><div class="line-content">  <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;horizontal&quot;</span>: <span class="str">&quot;center&quot;</span>},</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># For better illustration, we merge cells from column A to A+3 in</span></div></div><div class="line"><div class="line-content"><span class="com"># row 10, the last cell will be merged vertically</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">mergeCells</span> <span class="op">=</span> (<span class="str">&quot;A10&quot;</span>, fmt"{3.toCol}10") <span class="com"># remember toCol needs 0-based hence 3 is D</span></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">mergeCells</span> <span class="op">=</span> (<span class="str">&quot;E1&quot;</span>, <span class="str">&quot;E10&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Now let&apos;s add vertical page break after column E or inserted at column F.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">sheet</span><span class="op">.</span><span class="ide">pageBreakCol</span>(<span class="num">5.</span><span class="ide">toCol</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">sheet</span><span class="op">.</span><span class="ide">row</span> <span class="num">1</span></div></div><div class="line"><div class="line-content"><span class="ide">row1</span>[<span class="num">4.</span><span class="ide">toCol</span>] <span class="op">=</span> <span class="str">&quot;Right this is the vertical page break&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">row1</span><span class="op">.</span><span class="ide">style</span>(<span class="str">&quot;E&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">fill</span> <span class="op">=</span> <span class="ide">fillStyle</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">pattern</span> <span class="op">=</span> <span class="ide">patternFillStyle</span>(<span class="ide">patternType</span> <span class="op">=</span> <span class="ide">ptLightGray</span>, <span class="ide">fgColor</span> <span class="op">=</span> <span class="op">$</span><span class="ide">colGreen</span>),</div></div><div class="line"><div class="line-content">  ),</div></div><div class="line"><div class="line-content">  <span class="ide">alignment</span> <span class="op">=</span> {<span class="str">&quot;vertical&quot;</span>: <span class="str">&quot;center&quot;</span>, <span class="str">&quot;wrapText&quot;</span>: <span class="op">$</span><span class="ide">true</span>},</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">excel</span><span class="op">.</span><span class="ide">writeFile</span> <span class="str">&quot;excelin-example-pagebreak.xlsx&quot;</span></div></div>  </code></pre>
<p>The result as we can see below when viewed with Libreoffice</p>
<p>  <img src="assets/page-breaks-libreoffice.png" style="max-width: 100%;" alt="page breaks libreoffice" /></p>
<p>  <a href="#examples">Back to examples list</a></p>
<h1>Install</h1>
<p>Excelin requires minimum Nim version of <code>v1.4.0</code>.</p>
<p>For installation, we can choose several methods will be mentioned below.</p>
<p>Using Nimble package (when it&apos;s available):</p>
<pre>  <code>nimble install excelin
</code></pre>
<p>Or to install it locally</p>
<pre>  <code>git clone https://github.com/mashingan/excelin
cd excelin
nimble develop
</code></pre>
<p>or directly from Github repo</p>
<pre>  <code>nimble install https://github.com/mashingan/excelin 
</code></pre>
<p>to install the <code>#head</code> branch</p>
<pre>  <code>nimble install https://github.com/mashingan/excelin@#head
#or
nimble install excelin@#head
</code></pre>
<h1>License</h1>
<p>MIT</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/mashingan/excelin">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-09-12T01:05:40Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
