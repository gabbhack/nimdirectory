<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">kashae</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">cache</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Calculation caching library")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install kashae" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>Kashae - Yep, it&apos;s just <code>cache</code></h1>
<p>Kashae is a small implementation of caching return values for speeding up repetitive operations with the same parameters.</p>
<h2>How to use</h2>
<p>After installing <code>kashae</code>, simply annotate your procedure with <code>{.cache.}</code> to enable an unclearable  &quot;unlimited&quot; cache.
For instance with recursive Fibonacci number calculator:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>): <span class="ide">int</span> {<span class="op">.</span><span class="ide">cache</span><span class="op">.</span>} <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">n</span> <span class="op">&lt;=</span> <span class="num">1</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">result</span> <span class="op">=</span> <span class="ide">n</span></div></div><div class="line"><div class="line-content">  <span class="kwd">else</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">result</span> <span class="op">=</span> <span class="ide">fib</span>(<span class="ide">n</span> <span class="op">-</span> <span class="num">1</span>) <span class="op">+</span> <span class="ide">fib</span>(<span class="ide">n</span> <span class="op">-</span> <span class="num">2</span>)</div></div>  </code></pre>
<p>But shucks, what if we want to clear that pesky cache? Well this can be done using <code>cacheOpt:</code>. One way is to do:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>): <span class="ide">int</span> {<span class="op">.</span><span class="ide">cacheOpt</span>: {<span class="ide">clearParam</span>}<span class="op">.</span>}</div></div><div class="line"><div class="line-content"><span class="com"># This is now expanded to </span></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>, <span class="ide">clearCache</span> <span class="op">=</span> <span class="ide">false</span>): <span class="ide">int</span></div></div>  </code></pre>
<p>In the above example you can now do <code>fib(10, true)</code> and it&apos;d run <code>foo</code>&apos;s logic after clearing the cache, rebuilding it as it goes.
Secondly you can do:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>): <span class="ide">int</span> {<span class="op">.</span><span class="ide">cacheOpt</span>: {<span class="ide">clearFunc</span>}<span class="op">.</span>}</div></div>  </code></pre>
<p>And now <code>clearCache()</code> can be called inside the function when you want to clear the cache based off some conditional like if the sun is in your eyes. If you start running out of ram and cannot find a reliable source to download it, you may want to consider limiting the cache size. Which can be done in the following ways:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>): <span class="ide">int</span> {<span class="op">.</span><span class="ide">cacheOpt</span>: <span class="ide">CacheOptions</span>(<span class="ide">flags</span>: {<span class="ide">clearParam</span>}, <span class="ide">size</span>: <span class="num">10</span>)<span class="op">.</span>} <span class="com"># Hey we want options</span></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">fib</span>(<span class="ide">n</span>: <span class="ide">int</span>): <span class="ide">int</span> {<span class="op">.</span><span class="ide">cacheOpt</span>: <span class="num">10.</span>} <span class="com"># Freewill does not exist</span></div></div>  </code></pre>
<p>Now you might be scratching your head thinking &quot;but why?&quot;, two words, well one root word twice, speedy speed. Even with a cleared cache you can vastly outperform the equivalent without a cache due to calculations being in the table, my timing of the above <code>fib</code> without cache, clearing the cache, and with a built cache are as follows:</p>
<pre>  <code>name ............................... min time      avg time    std dv   runs
Un-kashaed Fib: 45 .............. 6970.467 ms   7014.019 ms   ±32.373    x10
Clearing Kashaed Fib: 45 ........... 0.002 ms      0.003 ms    ±0.002    x10
Kashaed Fib: 45 .................... 0.000 ms      0.000 ms    ±0.000    x10
</code></pre>
<p>Now stop writing a wrapper for that procedure in another module! We have magic in the way of <code>cacheProc</code>. Simply do the following to cache a prewritten procedrure.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">someProcedureSomewhereElse</span>(<span class="ide">a</span>, <span class="ide">b</span>: <span class="ide">int</span>): <span class="ide">int</span> <span class="com"># The procedure you want to cache</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">cachedVersion</span> <span class="op">=</span> <span class="ide">cacheProc</span>(<span class="ide">someProcedureSomewhereElse</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">cachedVersion</span>(<span class="num">100</span>, <span class="num">200</span>) <span class="com"># now we call this</span></div></div>  </code></pre>
<p>If the procedure is one that calls itself only the first call is cached.
Cache proc has three variants, one that takes an <code>int</code> to change the cache size, one that takes a <code>set[CacheOption]</code> and finally one that takes a <code>CacheOptions</code>.
Those overloads work identically to the <code>cacheOpt</code> ones, but only <code>clearParam</code> and <code>clearCacheAfterRun</code> work.</p>
<h2>Implementation details</h2>
<p>Presently Kashae by default uses a Ordered Table removing the oldest value first, which is beneficial for operations like the <code>fib</code> example since you have many branches that call values below it.</p>
<p>If you want to use a different type for the cache you can! It just requires matching the following concept signature.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Cacheable</span><span class="op">*</span>[<span class="ide">K</span>: <span class="ide">Hash</span>, <span class="ide">V</span>] <span class="op">=</span> <span class="kwd">concept</span> <span class="kwd">var</span> <span class="ide">c</span></div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">a</span>: <span class="ide">Hash</span></div></div><div class="line"><div class="line-content">    <span class="ide">c</span><span class="op">.</span><span class="ide">hasKey</span>(<span class="ide">a</span>) <span class="kwd">is</span> <span class="ide">bool</span></div></div><div class="line"><div class="line-content">    <span class="ide">c</span>[<span class="ide">a</span>] <span class="kwd">is</span> <span class="ide">V</span></div></div><div class="line"><div class="line-content">    <span class="ide">c</span>[<span class="ide">a</span>] <span class="op">=</span> <span class="ide">V</span></div></div><div class="line"><div class="line-content">    <span class="ide">c</span><span class="op">.</span><span class="ide">uncache</span>()</div></div><div class="line"><div class="line-content">    <span class="ide">c</span><span class="op">.</span><span class="ide">clear</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># If you prefer the Nim proc definitions:</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">hasKey</span><span class="op">*</span>[<span class="ide">K</span>, <span class="ide">V</span>](<span class="ide">col</span>: <span class="ide">YourCollection</span>, <span class="ide">v</span>: <span class="ide">V</span>): <span class="ide">bool</span></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> `[]`[<span class="ide">K</span>, <span class="ide">V</span>](<span class="ide">col</span>: <span class="ide">YourCollection</span>, <span class="ide">k</span>: <span class="ide">K</span>): <span class="ide">V</span></div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> `[]<span class="op">=</span>`[<span class="ide">K</span>, <span class="ide">V</span>](<span class="ide">col</span>: <span class="kwd">var</span> <span class="ide">YourCollection</span>, <span class="ide">k</span>: <span class="ide">K</span>, <span class="ide">v</span>: <span class="ide">V</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">uncache</span>(<span class="ide">col</span>: <span class="kwd">var</span> <span class="ide">YourCollection</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">proc</span> <span class="ide">clear</span>(<span class="ide">col</span>: <span class="kwd">var</span> <span class="ide">YourCollection</span>)</div></div>  </code></pre>
<p>After implementing all of those you can simply do <code>setCurrentCache YourCollection[Hash, int]</code>, <code>int</code> can be replaced with any type you desire, but is needed to match the concept.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/beef331/kashae">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-08-23T01:05:10Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
