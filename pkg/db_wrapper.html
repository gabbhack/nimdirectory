<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">db_wrapper</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">database</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">wrapper</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("this libraly able to use database/sql of Go")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install db_wrapper" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>db_wrapper</h1>
<p><a href="https://github.com/sivchari/db_wrapper/actions/workflows/nim_test.yml">  <img src="https://github.com/sivchari/db_wrapper/actions/workflows/nim_test.yml/badge.svg" style="max-width: 100%;" alt="nim_test" /></a>
<a href="https://github.com/sivchari/db">  <img src="https://circleci.com/gh/sivchari/db_wrapper.svg?style=svg" style="max-width: 100%;" alt="sivchari&gt;" /></a></p>
<p>db_wrapper provides intuitive DB methods.<br />
Just by using this library, you can use MySQL, PostgreSQL, and SQLite.<br />
By using connection pooling, parallel DB processing can be done at high speed.</p>
<h2>Performance using spwan or parallel</h2>
<p>  <img src="img/parallel_query.png" style="max-width: 100%;" alt="MySQL Parallel Benchmark" /></p>
<h3>db_mysql (Asynchronous because there is no connection pool)</h3>
<blockquote>
<p>31.146314212 sec</p>
</blockquote>
<h3>db_wrapper (Parallel)</h3>
<blockquote>
<p>12.02923 sec</p>
</blockquote>
<h2>Installation</h2>
<pre>  <code class="language-shell">nimble install https://github.com/sivchari/db_wrapper
nimble install db_wrapper
</code></pre>
<h2>Example</h2>
<h3>MySQL</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">db_wrapper</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">db</span> <span class="op">=</span> <span class="ide">open</span>(<span class="ide">MySQL</span>, <span class="str">&quot;database&quot;</span>, <span class="str">&quot;user&quot;</span>, <span class="str">&quot;Password!&quot;</span>, <span class="str">&quot;127.0.0.1&quot;</span>, <span class="str">&quot;3306&quot;</span>, <span class="num">10</span>)</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">db</span><span class="op">.</span><span class="ide">ping</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;insert&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;INSERT INTO sample(id, age, name) VALUES(?, ?, ?)&quot;</span>, <span class="num">1</span>, <span class="num">10</span>, <span class="str">&quot;New Nim&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;select&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = ?&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = ?&quot;</span>)<span class="op">.</span><span class="ide">query</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;update&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;UPDATE sample SET name = ? WHERE id = ?&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt1</span><span class="op">.</span><span class="ide">exec</span>(<span class="str">&quot;Change Nim&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;delete&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;DELETE FROM sample WHERE id = ?&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt2</span><span class="op">.</span><span class="ide">exec</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">db</span><span class="op">.</span><span class="ide">transaction</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">stmt3</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;UPDATE sample SET name = ? WHERE id = ?&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">discard</span> <span class="ide">stmt3</span><span class="op">.</span><span class="ide">exec</span>(<span class="str">&quot;Rollback Nim&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">raise</span> <span class="ide">newException</span>(<span class="ide">Exception</span>, <span class="str">&quot;rollback&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">close</span></div></div>  </code></pre>
<h3>PostgreSQL</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">db_wrapper</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">db</span> <span class="op">=</span> <span class="ide">open</span>(<span class="ide">PostgreSQL</span>, <span class="str">&quot;database&quot;</span>, <span class="str">&quot;user&quot;</span>, <span class="str">&quot;Password!&quot;</span>, <span class="str">&quot;127.0.0.1&quot;</span>, <span class="str">&quot;5432&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">db</span><span class="op">.</span><span class="ide">ping</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;insert&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;INSERT INTO sample(id, age, name) VALUES($1, $2, $3)&quot;</span>, <span class="num">1</span>, <span class="num">10</span>, <span class="str">&quot;New Nim&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;select&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = $1&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = $1&quot;</span>)<span class="op">.</span><span class="ide">query</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;update&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;UPDATE sample SET name = $1 WHERE id = $2&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt1</span><span class="op">.</span><span class="ide">exec</span>(<span class="str">&quot;Change Nim&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;delete&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;DELETE FROM sample WHERE id = $1&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt2</span><span class="op">.</span><span class="ide">exec</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">db</span><span class="op">.</span><span class="ide">transaction</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">stmt3</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;UPDATE sample SET name = $1 WHERE id = $2&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">discard</span> <span class="ide">stmt3</span><span class="op">.</span><span class="ide">exec</span>(<span class="str">&quot;Rollback Nim&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content">  <span class="kwd">raise</span> <span class="ide">newException</span>(<span class="ide">Exception</span>, <span class="str">&quot;rollback&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">close</span></div></div>  </code></pre>
<h3>SQLite</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">db_wrapper</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">db</span> <span class="op">=</span> <span class="ide">open</span>(<span class="ide">SQLite3</span>, <span class="str">&quot;sample.sqlite3&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">db</span><span class="op">.</span><span class="ide">ping</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">cmd</span> <span class="op">=</span> """CREATE TABLE IF NOT EXISTS sample (
     id INT
    ,age INT
    ,name VARCHAR
)"""</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="ide">cmd</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;insert&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;INSERT INTO sample(id, age, name) VALUES(?, ?, ?)&quot;</span>, <span class="num">1</span>, <span class="num">10</span>, <span class="str">&quot;New Nim&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;select&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = ?&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">row2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;SELECT * FROM sample WHERE id = ?&quot;</span>)<span class="op">.</span><span class="ide">query</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row1</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">all</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span>[<span class="num">0</span>]</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnTypes</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">row2</span><span class="op">.</span><span class="ide">columnNames</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;update&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt1</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;UPDATE sample SET name = ? WHERE id = ?&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt1</span><span class="op">.</span><span class="ide">exec</span>(<span class="str">&quot;Change Nim&quot;</span>, <span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;delete&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">stmt2</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">prepare</span>(<span class="str">&quot;DELETE FROM sample WHERE id = ?&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">stmt2</span><span class="op">.</span><span class="ide">exec</span>(<span class="num">1</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">discard</span> <span class="ide">db</span><span class="op">.</span><span class="ide">close</span></div></div>  </code></pre>
<h2>Cross Compile</h2>
<h3>Mac</h3>
<pre>  <code class="language-shell">GOARCH=arm64 CGO_ENABLED=1 go build -buildmode=c-shared -o sql_arm64.so *.go
GOARCH=amd64 CGO_ENABLED=1 go build -buildmode=c-shared -o sql_amd64.so *.go
</code></pre>
<h3>Linux</h3>
<pre>  <code class="language-shell">docker-compose up --build -d linux-compile
docker-compose exec linux-compile bash
cd src/database-resource/
go get golang.org/dl/go1.16
go1.16 download
GOOS=linux GOARCH=amd64 CGO_ENABLED=1 go1.16 build -buildmode=c-shared -o sql_linux_amd64.so *.go
</code></pre>
<h3>Windows</h3>
<pre>  <code class="language-shell">docker-compose up --build -d windows-compile
docker-compose exec windows-compile bash
cd src/database-resource/
apt -y update
apt -y install gcc-mingw-w64
apt -y install binutils-mingw-w64
GOOS=windows GOARCH=amd64 CGO_ENABLED=1 CXX=x86_64-w64-mingw32-g++ CC=x86_64-w64-mingw32-gcc go build -buildmode=c-shared -o sql_windows_amd64.dll *.go
</code></pre>
<h2>Benchmark</h2>
<p>There is an official database library for Nim, but it does not implement connection pooling.
However, this library (db_wrapper) allows connection pooling to be set at connection time.
This library (db_wrapper) implicitly sets the same value as the connection pool as idle connection when connecting.</p>
<p>  <code>There is a 9 second difference in performance between db_mysql and db_mysql for 150,000 queries issued.</code></p>
<p>Here is a benchmark of the official db_mysql and 15000 queries and 150000 run with async</p>
<h2>Loop 15000</h2>
<p>  <img src="img/mysql_loop_15000.png" style="max-width: 100%;" alt="MySQL 15000 Benchmark" /></p>
<h3>db_mysql</h3>
<blockquote>
<p>3.263424069 sec</p>
</blockquote>
<h3>db_wrapper</h3>
<blockquote>
<p>2.4392 sec</p>
</blockquote>
<p>The reason why only the standard library calls sleep in the 150000 loop is because the standard library does not support concurrency and will execute another query before the query is completed.</p>
<p>Here is the error message</p>
<pre>  <code class="language-shell">commands out of sync; you can&apos;t run this command now
</code></pre>
<h2>Loop 150000</h2>
<p>  <img src="img/mysql_loop_150000.png" style="max-width: 100%;" alt="MySQL 150000 Benchmark" /></p>
<h3>db_mysql</h3>
<blockquote>
<p>30.681650918 sec</p>
</blockquote>
<h3>db_wrapper</h3>
<blockquote>
<p>23.312019 sec</p>
</blockquote>
<h2>If you put async in both cases</h2>
<p>  <img src="img/async_mysql_loop_150000.png" style="max-width: 100%;" alt="MySQL async 150000 Benchmark" /></p>
<h3>db_mysql</h3>
<blockquote>
<p>38.237305311 sec</p>
</blockquote>
<h3>db_wrapper</h3>
<blockquote>
<p>29.214669 sec</p>
</blockquote>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/sivchari/db_wrapper">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-05-03T01:20:28Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
