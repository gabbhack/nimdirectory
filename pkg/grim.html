<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">grim</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">graph</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">data</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Graphs in nim!")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install grim" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><p align="center">
<img src="static/logo.svg" style="max-width: 100%;" width="100" alt="grim" />
</p>
<h1>grim brings property graphs to Nim</h1>
<p>Grim brings the <a href="https://en.wikipedia.org/wiki/Graph_database#Labeled-property_graph">labeled property graph</a> (LPG) data structure to the Nim language. This storage model is used in the <a href="https://neo4j.com">Neo4j</a> database and consists of labeled <strong>Nodes</strong> and <strong>Edges</strong>. The data itself is stored in key/value-pairs on these entities.</p>
<p align="center">
<img src="static/map.svg" style="max-width: 100%;" width="500" alt="grim" />
</p>
<p><strong>News:</strong>
See the <a href="Changelog.md">Changelog</a>.</p>
<ul>
<li>[2021-01-03] v0.3.1 released!</li>
<li>[2021-01-01] v0.3.0 released!</li>
<li>[2020-02-07] v0.2.0 released!</li>
</ul>
<hr />
<p><a href="#using-grim">Using grim</a> | <a href="#documentation-and-api">Documentation and API</a> | <a href="#running-the-tests">Running the tests</a> | <a href="#built-with">Built with</a> | <a href="#contributing">Contributing</a> | <a href="#authors">Authors</a> | <a href="#license">License</a></p>
<h2>Using grim</h2>
<p>Grim is provided with the Nimble package manager.</p>
<h3>Prerequisites</h3>
<p>Install the Nim compiler; see <a href="https://nim-lang.org">nim-lang</a> for instructions.</p>
<h3>Installing</h3>
<p>Use <code>nimble</code> to install <code>grim</code> on your local machine:</p>
<pre>  <code class="language-bash">nimble install grim
</code></pre>
<p>Use <code>grim</code> in a project by adding</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">requires</span> <span class="str">&quot;grim&quot;</span></div></div>  </code></pre>
<p>to its .nimble file.</p>
<h2>Documentation and API</h2>
<p><a href="#basic">Basic</a> | <a href="#iteration">Iteration</a> | <a href="loading-and-saving-graphs">Loading/saving</a> | <a href="#dsl-for-building-graphs">Graph-building DSL</a> | <a href="#communicating-with-neo4j-database">Neo4j</a> | <a href="#paths">Paths</a> | <a href="#navigating-paths">Navigating paths</a></p>
<p>The <code>grim</code> API is quite user-friendly. Check out usage examples in the <code>tests/</code> folder. The <a href="./tutorials/northwind.md">Northwind tutorial</a> shows how to translate a relational SQL model (of the sales in a small company) to a labeled property graph.</p>
<p>The <code>grim</code> documentation is <a href="https://ebran.github.io/grim">hosted on Github</a>.</p>
<h3>Basic</h3>
<p>Create a new graph:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">grim</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">g</span> <span class="op">=</span> <span class="ide">newGraph</span>(<span class="str">&quot;my graph&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">g</span><span class="op">.</span><span class="ide">name</span>    </div></div><div class="line"><div class="line-content"><span class="com"># =&gt; &quot;my graph&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">g</span><span class="op">.</span><span class="ide">numberOfNodes</span> <span class="op">==</span> <span class="num">0</span> <span class="kwd">and</span> <span class="ide">g</span><span class="op">.</span><span class="ide">numberOfEdges</span> <span class="op">==</span> <span class="num">0</span></div></div>  </code></pre>
<p>Add nodes to the graph:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> </div></div><div class="line"><div class="line-content">  <span class="ide">c1</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Country&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;Sweden&quot;</span>, <span class="ide">GDP_per_capita</span>: <span class="num">53208.0</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">c2</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Country&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;Norway&quot;</span>, <span class="ide">GDP_per_capita</span>: <span class="num">74536.0</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">c3</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Country&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;Germany&quot;</span>, <span class="ide">GDP_per_capita</span>: <span class="num">52559.0</span>))</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="ide">o1</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Organization&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;NATO&quot;</span>, <span class="ide">founded</span>: <span class="num">1949</span>, <span class="ide">active</span>: <span class="ide">true</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">o2</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Organization&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;EU&quot;</span>, <span class="ide">founded</span>: <span class="num">1993</span>, <span class="ide">active</span>: <span class="ide">true</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">o3</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addNode</span>(<span class="str">&quot;Organization&quot;</span>, <span class="op">%</span>(<span class="ide">name</span>: <span class="str">&quot;Nordic Council&quot;</span>, <span class="ide">founded</span>: <span class="num">1952</span>))</div></div>  </code></pre>
<p>Note:</p>
<ul>
<li>The <code>%</code>operator converts tuples to key/value properties which are stored as heterogeneous data tables on the LPG.</li>
<li><code>addNode</code> and <code>addEdge</code> return the <code>oid</code> for the entity (node or edge). The <code>oid</code> is a unique (string) identifier that can be set explicitly with the <code>oid</code> argument to <code>addNode</code> and <code>addEdge</code>, or is auto-generated if the <code>oid</code> argument is omitted.</li>
</ul>
<p>Here is how data is extracted from the graph:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">g</span><span class="op">.</span><span class="ide">node</span>(<span class="ide">c1</span>)<span class="op">.</span><span class="ide">label</span> <span class="op">==</span> <span class="str">&quot;Country&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">g</span><span class="op">.</span><span class="ide">node</span>(<span class="ide">c1</span>)[<span class="str">&quot;name&quot;</span>] <span class="op">==</span> <span class="str">&quot;Sweden&quot;</span></div></div>  </code></pre>
<p>Note:</p>
<ul>
<li>The <code>oid</code>s are used to identify the node.</li>
</ul>
<p>Add edges to the graph:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">  <span class="ide">e1</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addEdge</span>(<span class="ide">c1</span>, <span class="ide">o2</span>, <span class="str">&quot;MEMBER_OF&quot;</span>, <span class="op">%</span>(<span class="ide">since</span>: <span class="num">1995</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">e2</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addEdge</span>(<span class="ide">c1</span>, <span class="ide">o3</span>, <span class="str">&quot;MEMBER_OF&quot;</span>, <span class="op">%</span>(<span class="ide">since</span>: <span class="num">1952</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">e3</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">addEdge</span>(<span class="ide">c2</span>, <span class="ide">o3</span>, <span class="str">&quot;MEMBER_OF&quot;</span>, <span class="op">%</span>(<span class="ide">since</span>: <span class="num">1952</span>, <span class="ide">membership</span>: <span class="str">&quot;full&quot;</span>))</div></div>  </code></pre>
<p>Note:</p>
<ul>
<li>The <code>oid</code>s are used to identify the nodes and create the new edges (labeled &quot;MEMBER_OF&quot;) with key/value properties.</li>
<li>Since no <code>oid</code> argument is given to <code>addEdge</code>, the <code>oid</code> is auto-generated (and returned in the <code>e1</code>, <code>e2</code>, and <code>e3</code> variables).</li>
</ul>
<h3>Iteration</h3>
<p>All nodes:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">node</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">nodes</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">node</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">node</span></div></div>  </code></pre>
<p>Nodes with a certain label:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">node</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">nodes</span>(<span class="str">&quot;Country&quot;</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">node</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">node</span></div></div>  </code></pre>
<p>Nodes with filter (<code>node</code> is a special variable available when filtering nodes):</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">node</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">nodes</span>(<span class="str">&quot;Person&quot;</span>, <span class="ide">node</span><span class="op">.</span><span class="ide">name</span> <span class="op">==</span> <span class="str">&quot;Alice&quot;</span> <span class="kwd">and</span> <span class="ide">node</span><span class="op">.</span><span class="ide">age</span> <span class="op">&lt;</span> <span class="num">22</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">node</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">node</span></div></div>  </code></pre>
<p>All edges:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">edge</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">edges</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">edge</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">edge</span></div></div>  </code></pre>
<p>All edges with a certain label:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">edge</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">edges</span>(<span class="str">&quot;MEMBER_OF&quot;</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">edge</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">edge</span></div></div>  </code></pre>
<p>Edges with filter (<code>edge</code> is a special variable available when filtering edges):</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">node</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">edges</span>(<span class="str">&quot;MEMBER_OF&quot;</span>, <span class="ide">edge</span><span class="op">.</span><span class="ide">since</span> <span class="op">&gt;</span> <span class="num">2010</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">node</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">node</span></div></div>  </code></pre>
<p>All edges between two nodes:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">edge</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">edgesBetween</span>(<span class="ide">c1</span>, <span class="ide">o3</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">edge</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">edge</span></div></div>  </code></pre>
<p>Over neighbor nodes:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">node</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">neighbors</span>(<span class="ide">c1</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">node</span><span class="op">.</span><span class="ide">label</span>, <span class="str">&quot;: &quot;</span>, <span class="ide">node</span></div></div>  </code></pre>
<p>Note:</p>
<ul>
<li>The graph is directional so <code>addEdge(A, B, &quot;LABEL&quot;)</code> adds an edge with label &quot;LABEL&quot; pointing from A to B.</li>
<li>All iterators take a <code>direction</code> argument that specifies whether to include outgoing (<code>A-&gt;B</code>), incoming (<code>A&lt;-B</code>) or both (<code>A&lt;-&gt;B</code>) edges/neighbors.</li>
<li>The direction is specified with the enum values <code>Direction.Out</code>, <code>Direction.In</code>, and <code>Direction.OutIn</code>.</li>
</ul>
<h3>Loading and saving graphs</h3>
<p>Graph structures can be loaded and saved in YAML format with the <a href="https://nimyaml.org/">NimYAML</a> library. The procs <code>loadYaml</code> and <code>saveYaml</code> can be used (there are examples in the <code>tests/</code> folder).</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">grim</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">g</span> <span class="op">=</span> <span class="ide">loadYaml</span>(<span class="str">&quot;example.yaml&quot;</span>)    <span class="com"># Load graph from YAML file</span></div></div><div class="line"><div class="line-content"><span class="ide">g</span><span class="op">.</span><span class="ide">saveYaml</span>(<span class="str">&quot;example2.yaml&quot;</span>)         <span class="com"># Save a copy of the file</span></div></div>  </code></pre>
<h3>DSL for building graphs</h3>
<p>A small DSL is provided to reduce boilerplate when building graphs. A toy example:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">grim</span><span class="op">/</span><span class="ide">dsl</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">graph</span> <span class="ide">g</span> <span class="str">&quot;Some people&quot;</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">nodes</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">Person</span>:</div></div><div class="line"><div class="line-content">      <span class="str">&quot;a nice guy&quot;</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">name</span>: <span class="str">&quot;Santa Claus&quot;</span></div></div><div class="line"><div class="line-content">        <span class="ide">age</span>: <span class="num">108</span></div></div><div class="line"><div class="line-content">      <span class="str">&quot;a smart girl&quot;</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">name</span>: <span class="str">&quot;Jane Austen&quot;</span></div></div><div class="line"><div class="line-content">        <span class="ide">wealth</span>: <span class="num">10304.3</span></div></div><div class="line"><div class="line-content">  <span class="ide">edges</span>:</div></div><div class="line"><div class="line-content">    <span class="str">&quot;a nice guy&quot;</span> <span class="op">-&gt;</span> <span class="str">&quot;a smart girl&quot;</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">DELIVERS</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">category</span>: <span class="str">&quot;writing material&quot;</span></div></div><div class="line"><div class="line-content">        <span class="ide">value</span>: <span class="num">204</span></div></div>  </code></pre>
<p>This will expose the graph in the remainder of the code as the mutable variable <code>g</code>. This example shows how to access graph data:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">  <span class="ide">p1</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">node</span>(<span class="str">&quot;a nice guy&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">p2</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">node</span>(<span class="str">&quot;a smart girl&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">p1</span><span class="op">.</span><span class="ide">label</span> <span class="op">==</span> <span class="str">&quot;Character&quot;</span> <span class="kwd">and</span> <span class="ide">p2</span><span class="op">.</span><span class="ide">label</span> <span class="op">==</span> <span class="str">&quot;Character&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">p1</span>[<span class="str">&quot;name&quot;</span>]<span class="op">.</span><span class="ide">getStr</span> <span class="op">==</span> <span class="str">&quot;Santa Claus&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">p1</span>[<span class="str">&quot;age&quot;</span>]<span class="op">.</span><span class="ide">getInt</span> <span class="op">==</span> <span class="num">108</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">p2</span>[<span class="str">&quot;name&quot;</span>]<span class="op">.</span><span class="ide">getStr</span> <span class="op">==</span> <span class="str">&quot;Jane Austen&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">p2</span>[<span class="str">&quot;wealth&quot;</span>]<span class="op">.</span><span class="ide">getFloat</span> <span class="op">==</span> <span class="num">10304.3</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">e</span> <span class="kwd">in</span> <span class="ide">g</span><span class="op">.</span><span class="ide">edgesBetween</span>(<span class="str">&quot;a nice guy&quot;</span>, <span class="str">&quot;a smart girl&quot;</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">e</span><span class="op">.</span><span class="ide">label</span> <span class="op">==</span> <span class="str">&quot;DELIVERS&quot;</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">e</span>[<span class="str">&quot;category&quot;</span>]<span class="op">.</span><span class="ide">getStr</span> <span class="op">==</span> <span class="str">&quot;writing material&quot;</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">e</span>[<span class="str">&quot;value&quot;</span>]<span class="op">.</span><span class="ide">getInt</span> <span class="op">==</span> <span class="num">204</span></div></div>  </code></pre>
<h3>Communicating with a Neo4j database</h3>
<p>The <code>neo4j</code> submodule is used to communicate with a Neo4j database. Data is transferred via Neo4j&apos;s http REST API since the bolt protocol is not supported at present.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">grim</span><span class="op">/</span>[<span class="ide">neo4j</span>, <span class="ide">utils</span>]</div></div>  </code></pre>
<p>The <code>utils</code> module provides the <code>getEnvOrRaise</code> proc, which reads an evironment variable or raises a runtime error when the variable is not defined.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">    <span class="ide">username</span> <span class="op">=</span> <span class="ide">getEnvOrRaise</span>(<span class="str">&quot;NEO4J_USERNAME&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">password</span> <span class="op">=</span> <span class="ide">getEnvOrRaise</span>(<span class="str">&quot;NEO4J_PASSWORD&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">hostname</span> <span class="op">=</span> <span class="ide">getEnvOrRaise</span>(<span class="str">&quot;NEO4J_HOSTNAME&quot;</span>)</div></div>  </code></pre>
<p>The contents of NEO4J_USERNAME and NEO4J_PASSWORD are self-explanatory, and the NEO4J_HOSTNAME contains the address to the database on the form <code>mydatabase.com</code> (or simply <code>localhost</code> if you are running a local instance).</p>
<p>Start the client and dump the database as a grim LPG:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span></div></div><div class="line"><div class="line-content">    <span class="ide">client</span> <span class="op">=</span> <span class="ide">initNeo4jClient</span>(<span class="ide">hostname</span>, <span class="ide">auth</span> <span class="op">=</span> (<span class="ide">username</span>, <span class="ide">password</span>))</div></div><div class="line"><div class="line-content">    <span class="ide">g</span> <span class="op">=</span> <span class="ide">client</span><span class="op">.</span><span class="ide">dump</span>(<span class="str">&quot;my graph&quot;</span>)</div></div><div class="line"><div class="line-content">  </div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">g</span><span class="op">.</span><span class="ide">describe</span></div></div>  </code></pre>
<h3>Paths</h3>
<p>A path in the graph is defined by a sequence of continuous edges (members), which link together a number of nodes. The path can be <code>walked</code> (or traversed) by iterating from the beginning of the path. The paths starts at an <em>anchor</em> node.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">p</span> <span class="op">=</span> <span class="ide">newPath</span>(<span class="ide">myNode</span>)</div></div>  </code></pre>
<p><code>p</code> is now an empty path starting at <code>myNode</code>. We can now start building the path by repeatedly adding members to the path.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">p</span> <span class="op">=</span> <span class="ide">p</span><span class="op">.</span><span class="ide">add</span>(<span class="ide">myFirstEdge</span>)<span class="op">.</span><span class="ide">add</span>(<span class="ide">mySecondEdge</span>)<span class="op">.</span><span class="ide">add</span>(<span class="ide">myThirdEdge</span>)</div></div>  </code></pre>
<p>The add proc returns the path and can therefore be chained. Note that paths and members are ref objects so to create a copy of a path we need to use the explicit <code>copy</code> function</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">p2</span> <span class="op">=</span> <span class="ide">p</span><span class="op">.</span><span class="ide">copy</span></div></div>  </code></pre>
<p>Walk the path by iterating</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">edge</span> <span class="kwd">in</span> <span class="ide">p</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">edge</span></div></div><div class="line"><div class="line-content"><span class="com"># myFirstEdge, mySecondEdge, myThirdEdge</span></div></div>  </code></pre>
<p>Get the first, last, and n:th member by convenience functions:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">p</span><span class="op">.</span><span class="ide">first</span>    <span class="com"># myFirstEdge</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">p</span><span class="op">.</span><span class="ide">last</span>     <span class="com"># myThirdEdge</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">p</span><span class="op">.</span><span class="ide">nth</span>(<span class="num">1</span>)   <span class="com"># mySecondEdge (zero-indexed)</span></div></div>  </code></pre>
<p>The first two are O(1) operations, but the last is O(n) and slower on long paths.</p>
<h3>Navigating paths</h3>
<p>The real power of paths emerge when navigating path via patterns. This is an efficient method for simple traversal of similar paths in the graph. The paths can be scanned and modified in a single sweep.</p>
<p>Let&apos;s start our example by building a graph:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">grim</span><span class="op">/</span><span class="ide">dsl</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">graph</span> <span class="ide">g</span> <span class="str">&quot;People&quot;</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">nodes</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">Person</span>:</div></div><div class="line"><div class="line-content">      <span class="str">&quot;alice&quot;</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">name</span>: <span class="str">&quot;Alice&quot;</span></div></div><div class="line"><div class="line-content">      <span class="str">&quot;bob&quot;</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">name</span>: <span class="str">&quot;Bob&quot;</span></div></div><div class="line"><div class="line-content">      <span class="str">&quot;charlie&quot;</span>:</div></div><div class="line"><div class="line-content">        <span class="ide">name</span>: <span class="str">&quot;Charlie&quot;</span></div></div><div class="line"><div class="line-content">  <span class="ide">edges</span>:</div></div><div class="line"><div class="line-content">    <span class="str">&quot;alice&quot;</span> <span class="op">-&gt;</span> <span class="str">&quot;bob&quot;</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">KNOWS</span></div></div><div class="line"><div class="line-content">    <span class="str">&quot;bob&quot;</span> <span class="op">-&gt;</span> <span class="str">&quot;charlie&quot;</span></div></div><div class="line"><div class="line-content">      <span class="ide">KNOWS</span></div></div><div class="line"><div class="line-content">    <span class="str">&quot;bob&quot;</span> <span class="op">-&gt;</span> <span class="str">&quot;charlie&quot;</span></div></div><div class="line"><div class="line-content">      <span class="ide">KNOWS</span></div></div>  </code></pre>
<p>The graph is <code>Alice -KNOWS-&gt; Bob =KNOWS=&gt; Charlie</code> ,where <code>-&gt;</code> and <code>=&gt;</code> denotes single and double edges, respectively. Let&apos;s say we want to navigate this graph by the pattern Person-KNOWS-Person. There are three such paths of length 1 (containing one member): one is Alice-Bob (which is a single edge) and the other two are Bob-Charlie (which is a double edge).</p>
<p>We start navigating with the graph&apos;s <code>navigate</code> proc:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">pc</span> <span class="op">=</span> <span class="ide">g</span><span class="op">.</span><span class="ide">navigate</span>(<span class="str">&quot;Person&quot;</span>)    <span class="com"># PathCollection</span></div></div>  </code></pre>
<p>The navigation starts at an anchor node (&quot;Person&quot;). The result is a <code>PathCollection</code>, which is exactly what it sounds like: A collection of paths matching the given pattern. In other words, the <code>navigate</code> constructs a PathCollection with empty paths anchored at nodes matching the label Person. We can iterate over the matched paths in the PathCollection:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">path</span> <span class="kwd">in</span> <span class="ide">pc</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">path</span>, <span class="ide">path</span><span class="op">.</span><span class="ide">anchor</span>[<span class="str">&quot;name&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="com"># (&quot;Empty Path&quot;, &quot;Alice&quot;), (&quot;Empty Path&quot;, &quot;Bob&quot;), (&quot;Empty Path&quot;, &quot;Charlie&quot;)</span></div></div><div class="line"><div class="line-content"><span class="com"># The matching order is not guaranteed.</span></div></div>  </code></pre>
<p>Let&apos;s now expand the navigation to the pattern matched by taking the step:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">pc</span> <span class="op">=</span> <span class="ide">pc</span><span class="op">.</span><span class="ide">step</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>)</div></div>  </code></pre>
<p>With the help of the anchors, we have now matched all paths fulfilling the pattern Person-KNOWS-Person. Each step taken when navigating returns a modified copy of the PathCollection, encouraging sequential steps to be chained:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">pc</span> <span class="op">=</span> <span class="ide">g</span></div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">navigate</span>(<span class="str">&quot;Person&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">step</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">step</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>)</div></div>  </code></pre>
<p>In fact, this pattern is so common that there is a convenience function for repeating a number of identical steps:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">pc</span> <span class="op">=</span> <span class="ide">g</span></div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">navigate</span>(<span class="str">&quot;Person&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">steps</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>, <span class="num">2</span>)</div></div>  </code></pre>
<p>This navigation will search the graph for motifs of the kind Person-KNOWS-&gt;Person-KNOWS-&gt;Person, i.e., friends of friends. Note that the match is exhaustive, i.e.,</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">pc</span> <span class="op">=</span> <span class="ide">g</span></div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">navigate</span>(<span class="str">&quot;Person&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">step</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>, <span class="num">3</span>)</div></div>  </code></pre>
<p>will return no matches (i.e., a path collection of empty paths anchored at &quot;Person&quot; labels).</p>
<p>There is one more important path navigation function, namely <code>follow</code>. This will match all patterns of variable length until there are no more matching paths. In our example,</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">pc</span> <span class="op">=</span> <span class="ide">g</span></div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">navigate</span>(<span class="str">&quot;Person&quot;</span>)</div></div><div class="line"><div class="line-content">  <span class="op">.</span><span class="ide">follow</span>(<span class="str">&quot;KNOWS&quot;</span>, <span class="str">&quot;Person&quot;</span>)</div></div>  </code></pre>
<p>will match Person-KNOWS-Person, Person-KNOWS-Person-KNOWS-Person, etc. In our graph, we expect matches:</p>
<ul>
<li>One 1-step path Alice-KNOWS-Bob.</li>
<li>Two 1-step paths Bob-KNOWS-Charlie (because of two edges).</li>
<li>Two 2-step paths Alice-KNOWS-Bob-KNOWS-Charlie (because of two edges between Bob and Charlie).</li>
</ul>
<p>After matching patterns, we can simply iterate over the paths in the collection:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">path</span> <span class="kwd">in</span> <span class="ide">pc</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">path</span>, <span class="ide">path</span><span class="op">.</span><span class="ide">anchor</span></div></div><div class="line"><div class="line-content"><span class="com"># Three 1-step paths, two 2-step paths</span></div></div><div class="line"><div class="line-content"><span class="com"># Anchors: Alice (1-step path), Bob (1-step path), Bob (1-step path), Alice (2-step path), Alice (2-step path).</span></div></div>  </code></pre>
<h2>Running the tests</h2>
<p>The unit tests can be run with nimble, they test basic usage of the package such as creating and modifying graphs, the DSL, and loading/saving graphs as YAML.</p>
<pre>  <code class="language-bash">nimble test
</code></pre>
<h2>Built With</h2>
<ul>
<li><a href="https://nim-lang.org/">Nim</a> - The Nim programming language.</li>
<li><a href="https://nimyaml.org/">NimYAML</a> - A pure YAML implementation for Nim.</li>
</ul>
<h2>Contributing</h2>
<p>I&apos;ll be happy to accept and review PRs and discuss other things on submitted to Issues.</p>
<h2>Authors</h2>
<ul>
<li><strong>Erik G. Brandt</strong> - <em>Original author</em> - <a href="https://github.com/ebran">ebran</a></li>
</ul>
<h2>License</h2>
<p>This project is licensed under the MIT License.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/ebran/grim">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-05-16T01:20:30Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
