<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">ndup</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">rolling hash</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">content-sensitive framing</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">content-defined chunking</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">CDC</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">near duplicate</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">duplicate</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">detection</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">binary files</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">set file manipulation</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Near-Duplicate File Detection")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install ndup" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h2>Overview</h2>
<p>Finding strictly duplicate files is <a href="https://github.com/c-blake/cligen/blob/master/examples/dups.nim">a pretty
straightforward</a>
problem with most optimization opportunities being just filesystem size
filtering and IO things.  Finding only &quot;near duplicate&quot; files is far more
subtle, but there are many applications - plagiarism detection, automatic
related work finding, clean up of chaotically duplicated files, probably with
human inspection in the loop.</p>
<h2>Choices</h2>
<p>Choices to define &quot;near&quot; abound.  Each has various false positive|negative rates
in various settings.  Here &quot;false&quot; itself is relative to other, possibly &quot;know
it when I see it&quot;/subjective assessments.  Computational complexity of nearness
definitions, such as edit distance, can present new challenges.  Since answers
to these questions are unclear &amp; likely very context dependent, this package is
more a toolkit/framework to research methods on various collections rather than
a &quot;turn key solution&quot;.</p>
<h2>Core Idea</h2>
<p><a href="https://rsync.samba.org/tech_report/">The rsync/Spam Sum algorithm</a> relates to
the core idea.  That &amp; <a href="http://www.sosp.org/2001/papers/mazieres.pdf">LBFS</a> was
my personal inspiration. { There is also this 2006 paper by <a href="https://www.sciencedirect.com/science/article/pii/S1742287606000764">Jesse Kornblum I
read</a> that
I found around 10 years ago when I first worked on this.  I haven&apos;t looked into
more recent academic work.  References are welcome. }</p>
<p>The core idea of all the above is context-sensitive variable size frames (rather
than fixed size blocks) decided by when the lower N bits of a <a href="https://en.wikipedia.org/wiki/Rolling_hash">rolling
hash</a> (I use Bob Uzgalis&apos; BuzHash
for its extreme simplicity) matches some fixed value.  Once framing has been so
decided, a more collision-resistant hash is used for frame identity.  There are
fine points to the digesting process like minimum block/file sizes, but this
core digesting idea is simple &amp; powerful.  It is elaborated upon in the papers
mentioned above.  What it prevents is effects like &quot;edit the first byte &amp; shift
everything&quot; that come up in fixed length block-oriented ideas.</p>
<p>Depending upon &quot;how near&quot; files in a collection are, you will get more or fewer
exact frame matches for &quot;similar&quot; files.  Set intersection thresholds (roughly
<a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a>) alone are
pretty good, but one can also do slower edit distances {TODO: need to port or
just maybe just call <code>cligen/textUt.distDamerau</code>}.  Similarity thresholds/knobs
need to be user-driven/tunable since use cases determine desirability of false
positive-negative trade-offs.</p>
<h2>Maybe Novel Wrinkle</h2>
<p>Unlike a fully automated context, near duplicate systems may be able to have
&quot;iterated by a human in the loop&quot; deployment.  One thing I came up with myself
(but may have prior work somewhere) is <em>multiple statistically independent
framings</em>.  This can mitigate &quot;unlucky framing&quot;.  Concretely, you can pick
different matching values (or different seeds for BuzHash Sboxes) to get
entirely independent framings.  Then you can consider two or more files (with
<em>the same</em> framing rules) according to N samples (5..12 work ok).  This idea is
more salient to the near duplicate use-case where an end-user may want to tune
false positive rates.</p>
<p>Of course, one can also get &quot;lucky framing&quot; &amp; want to automate multiple trials
with voting, say a threshold of 4/5 or something.  Depending upon thresholds,
this seems to boost sensitivity (fewer false negatives) without much adverse
false positive creation. {TODO: I automated this in a C version, and almost all
bits &amp; pieces are present in the Nim port, but I must close a few loops to
finish this.}  This really needs a reference solution in an organic context for
proper evaluation {TODO}.</p>
<h2>Evaluation</h2>
<p>While no test data set is perfect, an ArpaNet/InterNet Request For Comment (RFC)
collection is nice for many reasons.  It&apos;s a public dataset with clear right to
distribute.  It is just small enough to perhaps be humanly manageable.  Spanning
a half century, it exhibits fairly organic chaos.  On the other hand, textual
patterns like &apos;^Obsoletes: NUMBERS&apos;, cross-refs, some standards showing up as
drafts earlier all afford defining results which &quot;should&quot; be found by &quot;sensitive
enough&quot; near duplicate detectors (false negative rates).</p>
<p>Meanwhile, in a weak sense, the entire document set notionally relates &quot;somehow&quot;
(being &quot;About The Internet&quot;).  This topical similarity enables studying false
discovery rate controls from &quot;tight similarity&quot; all the way to &quot;very loose&quot;.
9200 documents is small enough to enable rapid idea iteration yet big enough to
be performance-relevant.  E.g. 9200^2/2=43e6 naive file comparisons shows off
the inverted index optimization (over 500X less work with default parameters).</p>
<p>As mentioned in &quot;Choices&quot; and &quot;Core Idea&quot; above, evaluation is hard since there
is neither a fully objective answer and there may be several axes of degrees of
similarity.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT/ISC
                    </p>
                

                
                    <p> <a href="https://github.com/c-blake/ndup">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-08-22T01:06:26Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
