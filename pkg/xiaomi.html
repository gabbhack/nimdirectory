<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">xiaomi</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">xiaomi</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">iot</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Read and write to Xiaomi IOT devices.")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install xiaomi" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><p>  <em>This README was generated with   <a href="https://github.com/ThomasTJdev/nimtomd">Nim to Markdown</a></em></p>
<h1>XIAOMI</h1>
<p>Library for working with Xiaomi IOT devices.</p>
<h2>Requirements</h2>
<ul>
<li>nim &gt;= 0.19.0</li>
<li>multicast &gt;= 0.1.1</li>
<li>nimcrypto &gt;= 0.3.2</li>
</ul>
<h2>Devices</h2>
<p>Xiaomi IOT devices are supported. The following devices has been thoroughly tested:</p>
<ul>
<li>  <a href="https://www.lightinthebox.com/en/p/xiao-mi-multi-function-gateway-16-million-color-night-light-remote-control-connect-other-intelligent-devices_p5362296.html?prm=1.18.104.0">Gateway</a></li>
<li>  <a href="https://www.lightinthebox.com/en/p/xiao-mi-door-and-window-sensor-millet-intelligent-home-suite-household-door-and-window-alarm-used-with-multi-function-gateway_p5362299.html?prm=1.18.104.0">Door/window sensor</a></li>
<li>  <a href="https://www.lightinthebox.com/en/p/xaomi-aqara-human-body-sensor-infrared-detector-platform-infrared-detectorforhome_p6599215.html?prm=1.18.104.0">PIR sensor</a></li>
<li>  <a href="https://www.lightinthebox.com/en/p/original-xiaomi-temperature-and-humidity-sensor-real-time-monitoring-of-temperature-and-humidity-changes_p5376891.html?prm=1.18.104.0">Temperature &amp; Humidity sensor</a></li>
</ul>
<h2>Working with Xiaomi</h2>
<p>You can interact with the Xiaomi devices in 3 ways:</p>
<ol>
<li><strong>Read</strong> - Asking for a status, e.g. is the door open (door sensor)</li>
<li><strong>Report</strong> - Awaiting an action, e.g. when the door opens, it sends a notification (door sensor)</li>
<li><strong>Write</strong> - Send a message to the device (only some devices accepted this), e.g. play a sound (gateway)</li>
</ol>
<p>All you Xiaomi devices are connected to a gateway. It is through this gateway, we are communicating with each of the devices. Each devices is identified with a SID.</p>
<h1>Examples (basic)</h1>
<h2>Discover devices</h2>
<p>But before we get started, you need to acquire your devices SID.</p>
<p>  <strong>Get the gateways SID</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiGatewayGetSid</span>()</div></div>  </code></pre>
<p>  <strong>Get the devices SID</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiDiscover</span>()</div></div>  </code></pre>
<h2>Read</h2>
<p>There are numerous ways to read. Some proc&apos;s just read the next message, some waits for a specific device, etc.</p>
<p>  <strong>Read the next message sent</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiReadMessage</span>()</div></div>  </code></pre>
<p>  <strong>Request a device status and read the reply</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiReadDevice</span>(<span class="str">&quot;device-SID&quot;</span>)</div></div>  </code></pre>
<p><strong>Read the next message from custom-x</strong>
This will await that the cmd = &quot;heartbeat&quot; and the model = &quot;gateway&quot;.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiReadCustom</span>(<span class="str">&quot;heartbeat&quot;</span>, <span class="str">&quot;gateway&quot;</span>)</div></div>  </code></pre>
<p>  <strong>Read messages forever</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiListenForever</span>()</div></div>  </code></pre>
<h2>Report</h2>
<p>For PIR sensors you will receive a report, when there&apos;s motion or there hasn&apos;t been motion for 300 seconds.</p>
<p>For magnet sensors you will receive a report when they are connected (<code>close</code>) and disconnected (<code>open</code>).</p>
<p>  <strong>Read next report</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiReportAck</span>()</div></div>  </code></pre>
<p>  <strong>Read next report for device</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiConnect</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="ide">xiaomiReadReport</span>(<span class="str">&quot;device-SID&quot;</span>)</div></div>  </code></pre>
<h1>Write to a device</h1>
<p>To write to a device, we need to exchange an encrypted key with the gateway based on an ever-changing token. We are utilizing nimcrypto AES CBC 128 to do this.</p>
<h2>Gateway password</h2>
<p>But before we can generate the key, you need to gather you gateway password. Follow this guide <a href="https://www.domoticz.com/wiki/Xiaomi_Gateway_(Aqara)#Adding_the_Xiaomi_Gateway_to_Domoticz">Domotics</a> or the bullets below. Remember to write the key down.</p>
<ol>
<li>Install the Xiaomi app</li>
<li>Set the region to Mainland China under Settings-&gt;Locale</li>
<li>You can set the language to English, even though the region is China</li>
<li>Sign in/Make an account</li>
<li>Select your Gateway in the app</li>
<li>Tap the 3 dots in top right corner</li>
<li>Click About</li>
<li>Tap on the version repeatedly until a new menu appear</li>
<li>Click on Wireless communication protocol</li>
<li>Enable the this and write down you password and press Ok</li>
</ol>
<h2>Setting the password</h2>
<p>If you need to write to a device, insert your password in the global variable at the top of your code:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">xiaomiGatewayPassword</span> <span class="op">=</span> <span class="str">&quot;secretPassword&quot;</span></div></div>  </code></pre>
<h2>Getting the encrypted key</h2>
<p>The gateways token is changing all the time. You therefore need to the generate the encrypted key before each writing.</p>
<p>This is done with:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">xiaomiTokenRefresh</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiSecretUpdate</span>()</div></div>  </code></pre>
<p>  <strong>OR</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">xiaomiTokenRefresh</span>(<span class="ide">true</span>)</div></div>  </code></pre>
<p>  <strong>OR while writing</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">xiaomiWrite</span>(<span class="str">&quot;device-SID&quot;</span>, <span class="str">&quot;message&quot;</span>, <span class="ide">true</span>)</div></div>  </code></pre>
<h2>Gateway writing options</h2>
<p>There are 2 main elements you can write to the gateway - the light and sound.</p>
<p>  <strong>Light writing</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiGatewayPassword</span> <span class="op">=</span> <span class="str">&quot;secretPassword&quot;</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiTokenRefresh</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiWrite</span>(<span class="ide">xiaomiGatewaySid</span>, <span class="str">&quot;</span>\"<span class="str">rgb</span>\"<span class="str">: 4294914304&quot;</span>)</div></div>  </code></pre>
<p>  <strong>Light options</strong></p>
<p>To assign a RGB color, you have to use the Android() color format.</p>
<p>You can convert HEX to Android() at this <a href="https://convertingcolors.com/android-color-4294914304.html">website</a>.</p>
<ul>
<li>Red = <code>4294914304</code></li>
<li>Green = <code>4283359807</code></li>
<li>Purple = <code>4283637131</code></li>
<li>Yellow = <code>4292211292</code></li>
<li>Blue = <code>4283327469</code></li>
<li>Off = <code>0</code></li>
</ul>
<p>  <strong>Sound writing</strong></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">xiaomi</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiGatewayPassword</span> <span class="op">=</span> <span class="str">&quot;secretPassword&quot;</span></div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiTokenRefresh</span>()</div></div><div class="line"><div class="line-content"> <span class="ide">xiaomiWrite</span>(<span class="ide">xiaomiGatewaySid</span>, <span class="str">&quot;</span>\"<span class="str">mid</span>\"<span class="str">: 7, </span>\"<span class="str">vol</span>\"<span class="str">: 4&quot;</span>)</div></div>  </code></pre>
<p>  <strong>Sound options</strong></p>
<p>The volume is in percentage, whereas 10 = 100%.</p>
<p>The following sounds are available:</p>
<p>Alarms:</p>
<ul>
<li>0 - Police car 1</li>
<li>1 - Police car 2</li>
<li>2 - Accident</li>
<li>3 - Countdown</li>
<li>4 - Ghost</li>
<li>5 - Sniper rifle</li>
<li>6 - Battle</li>
<li>7 - Air raid</li>
<li>8 - Bark</li>
</ul>
<p>Doorbells</p>
<ul>
<li>10 - Doorbell</li>
<li>11 - Knock at a door</li>
<li>12 - Amuse</li>
<li>13 - Alarm clock</li>
</ul>
<p>Alarm clock</p>
<ul>
<li>20 - MiMix</li>
<li>21 - Enthusiastic</li>
<li>22 - GuitarClassic</li>
<li>23 - IceWorldPiano</li>
<li>24 - LeisureTime</li>
<li>25 - ChildHood</li>
<li>26 - MorningStream</li>
<li>27 - MusicBox</li>
<li>28 - Orange</li>
<li>29 - Thinker</li>
</ul>
<h1>Types</h1>
<h2>Procs</h2>
<h3>proc xiaomiSecretUpdate*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiSecretUpdate</span><span class="op">*</span>(<span class="ide">password</span> <span class="op">=</span> <span class="ide">xiaomiGatewayPassword</span>, <span class="ide">token</span> <span class="op">=</span> <span class="ide">xiaomiGatewayToken</span>) <span class="op">=</span></div></div>  </code></pre>
<p>Update encrypt the secret for writing</p>
<h3>proc xiaomiTokenRefresh*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiTokenRefresh</span><span class="op">*</span>(<span class="ide">updateKey</span> <span class="op">=</span> <span class="ide">false</span>) <span class="op">=</span></div></div>  </code></pre>
<p>Wait for updated Gateway token.
This does also populate the gateway sid.</p>
<h3>proc xiaomiWrite*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiWrite</span><span class="op">*</span>(<span class="ide">sid</span>, <span class="ide">message</span>: <span class="ide">string</span>, <span class="ide">updateKey</span> <span class="op">=</span> <span class="ide">false</span>) <span class="op">=</span></div></div>  </code></pre>
<p>Send a write command to the
specified &quot;sid&quot; with a &quot;message&quot;.</p>
<h3>proc xiaomiSendRead*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiSendRead</span><span class="op">*</span>(<span class="ide">deviceSid</span>: <span class="ide">string</span>) <span class="op">=</span></div></div>  </code></pre>
<p>Tell the device to reply with it&apos;s status.
This proc does not read the reply, only
ask the device for sending a message with
it&apos;s status and the cmd = read_ack.</p>
<h3>proc xiaomiSend*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiSend</span><span class="op">*</span>(<span class="ide">message</span>: <span class="ide">string</span>) <span class="op">=</span></div></div>  </code></pre>
<p>Send a custom message</p>
<h3>proc xiaomiReadMessage*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiReadMessage</span><span class="op">*</span>(): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Read a single Xiaomi message
and return it.</p>
<h3>proc xiaomiReadCustom*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiReadCustom</span><span class="op">*</span>(<span class="ide">cmd</span> <span class="op">=</span> <span class="str">&quot;&quot;</span>, <span class="ide">model</span> <span class="op">=</span> <span class="str">&quot;&quot;</span>, <span class="ide">sid</span> <span class="op">=</span> <span class="str">&quot;&quot;</span>): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Tell the device to reply with status.
and return the reply if the custom
parameters are fulfilled.
It is optional to specify the parameters.
Example:
cmd =&gt; heartbeat
model =&gt; gateway</p>
<h3>proc xiaomiReadDevice*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiReadDevice</span><span class="op">*</span>(<span class="ide">deviceSid</span>: <span class="ide">string</span>): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Tell the device to reply with it&apos;s status
and return the reply.</p>
<h3>proc xiaomiReadAck*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiReadAck</span><span class="op">*</span>(<span class="ide">deviceSid</span> <span class="op">=</span> <span class="str">&quot;&quot;</span>): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Return next message with
cmd = &quot;read_ack&quot;. This is useful
after telling a device to reply
with it&apos;s status</p>
<h3>proc xiaomiReadReport*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiReadReport</span><span class="op">*</span>(<span class="ide">deviceSid</span> <span class="op">=</span> <span class="str">&quot;&quot;</span>): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Return next message with
cmd = &quot;report&quot;. This is useful
if you are waiting for a sensor
to reply with a change</p>
<h3>proc xiaomiGatewayGetSid*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiGatewayGetSid</span><span class="op">*</span>(): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Get the gateway&apos;s sid</p>
<h3>proc xiaomiGatewayGetToken*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiGatewayGetToken</span><span class="op">*</span>(): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Get the gateway&apos;s token</p>
<h3>proc xiaomiDiscover*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiDiscover</span><span class="op">*</span>(): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Discover xiaomi devices</p>
<h3>proc xiaomiUpdateToken*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiUpdateToken</span><span class="op">*</span>(<span class="ide">message</span>: <span class="ide">string</span>): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<p>Updates the gateway token if
possible and returns the data</p>
<h3>proc xiaomiListenForever*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiListenForever</span><span class="op">*</span>() <span class="op">=</span></div></div>  </code></pre>
<p>Listen for Xiaomi mesages</p>
<h3>proc xiaomiDisconnect*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiDisconnect</span><span class="op">*</span>() <span class="op">=</span></div></div>  </code></pre>
<p>Close connection to multicast</p>
<h3>proc xiaomiConnect*</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">xiaomiConnect</span><span class="op">*</span>() <span class="op">=</span></div></div>  </code></pre>
<p>Initialize socket</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/ThomasTJdev/nim_xiaomi">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-08-01T01:27:51Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
