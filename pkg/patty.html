<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">patty</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">pattern</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">adt</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">variant</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">pattern matching</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">algebraic data type</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Algebraic data types and pattern matching")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install patty" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>Patty - A pattern matching library</h1>
<p><a href="https://travis-ci.org/andreaferretti/patty">  <img src="https://travis-ci.org/andreaferretti/patty.svg?branch=master" style="max-width: 100%;" alt="Build Status" /></a>
<a href="https://github.com/yglukhov/nimble-tag">  <img src="https://raw.githubusercontent.com/yglukhov/nimble-tag/master/nimble_js.png" style="max-width: 100%;" alt="nimble" /></a></p>
<p>Patty is a library to perform pattern matching in Nim. Make sure to also have a
look at <a href="https://github.com/alehander42/gara">Gara</a>, which is a more complete
solution. Unlike Patty, Gara misses a macro to generate variant objects, but it
is otherwise much more comprehensive. You can follow <a href="https://github.com/alehander42/gara/issues/5">here</a>
about adding a macro for object variants in Gara.</p>
<p>The patterns have to be
<a href="http://nim-lang.org/docs/manual.html#types-object-variants">variant objects</a>,
which in Nim are encoded with a field (usually called <code>kind</code>) which varies in
an enum, and a different object layout based on the value of this tag.
An example would be</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">type</span></div></div><div class="line"><div class="line-content">  <span class="ide">ShapeKind</span> <span class="op">=</span> <span class="kwd">enum</span></div></div><div class="line"><div class="line-content">    <span class="ide">Circle</span>, <span class="ide">Rectangle</span></div></div><div class="line"><div class="line-content">  <span class="ide">Shape</span> <span class="op">=</span> <span class="kwd">object</span></div></div><div class="line"><div class="line-content">    <span class="kwd">case</span> <span class="ide">kind</span>: <span class="ide">ShapeKind</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">r</span>: <span class="ide">float</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">float</span></div></div>  </code></pre>
<p>If you have such an algebraic data type, you can do the following with Patty:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">patty</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">makeRect</span>(<span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">float</span>): <span class="ide">Shape</span> <span class="op">=</span> <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">Rectangle</span>, <span class="ide">w</span>: <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">h</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">r</span>: <span class="ide">radius</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">width</span>, <span class="ide">h</span>: <span class="ide">height</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a rectangle of height &quot;</span>, <span class="ide">height</span></div></div>  </code></pre>
<p>This will be translated by the <code>match</code> macro into the following form</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> :<span class="ide">tmp</span> <span class="op">=</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">case</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">kind</span></div></div><div class="line"><div class="line-content"><span class="kwd">of</span> <span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">radius</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">r</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content"><span class="kwd">of</span> <span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span></div></div><div class="line"><div class="line-content">    <span class="ide">width</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">w</span></div></div><div class="line"><div class="line-content">    <span class="ide">height</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">h</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is a rectangle of height &quot;</span>, <span class="ide">height</span></div></div>  </code></pre>
<p>Matching by position is also valid, like this:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">radius</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">width</span>, <span class="ide">height</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a rectangle of height &quot;</span>, <span class="ide">height</span></div></div>  </code></pre>
<p>One can also use <code>_</code> for a variable, in which case it will not be bound.
That is, the following</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">patty</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">makeRect</span>(<span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">float</span>): <span class="ide">Shape</span> <span class="op">=</span> <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">Rectangle</span>, <span class="ide">w</span>: <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">h</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">r</span>: <span class="ide">radius</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">_</span>, <span class="ide">h</span>: <span class="ide">height</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a rectangle of height &quot;</span>, <span class="ide">height</span></div></div>  </code></pre>
<p>becomes</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> :<span class="ide">tmp</span> <span class="op">=</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">case</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">kind</span></div></div><div class="line"><div class="line-content"><span class="kwd">of</span> <span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">radius</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">r</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content"><span class="kwd">of</span> <span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">height</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">h</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is a rectangle of height &quot;</span>, <span class="ide">height</span></div></div>  </code></pre>
<p>The wildcard <code>_</code> can also be used as a stand alone pattern, in which case it
will match anything.
It is translated into an <code>else</code> clause, that is, the following</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">patty</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">makeRect</span>(<span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">float</span>): <span class="ide">Shape</span> <span class="op">=</span> <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">Rectangle</span>, <span class="ide">w</span>: <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">h</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">r</span>: <span class="ide">radius</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content">  <span class="ide">_</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is not a circle&quot;</span></div></div>  </code></pre>
<p>becomes</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> :<span class="ide">tmp</span> <span class="op">=</span> <span class="ide">makeRect</span>(<span class="num">3</span>, <span class="num">4</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">case</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">kind</span></div></div><div class="line"><div class="line-content"><span class="kwd">of</span> <span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">radius</span> <span class="op">=</span> :<span class="ide">tmp</span><span class="op">.</span><span class="ide">r</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is a circle of radius &quot;</span>, <span class="ide">radius</span></div></div><div class="line"><div class="line-content"><span class="kwd">else</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="str">&quot;it is not a circle&quot;</span></div></div>  </code></pre>
<p>Notice that in the examples, the field you dispatch on is called <code>kind</code>, but
any other name would do. Also, checks are exhaustive: if you miss a case, the
compiler will complain.</p>
<p>One can instead pattern-match on non-variant objects, which essentially amounts
to deconstructing fields:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">type</span> <span class="ide">Person</span> <span class="op">=</span> <span class="kwd">object</span></div></div><div class="line"><div class="line-content">  <span class="ide">name</span>: <span class="ide">string</span></div></div><div class="line"><div class="line-content">  <span class="ide">age</span>: <span class="ide">int</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">p</span> <span class="op">=</span> <span class="ide">Person</span>(<span class="ide">name</span>: <span class="str">&quot;John Doe&quot;</span>, <span class="ide">age</span>: <span class="num">37</span>)</div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">p</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Person</span>(<span class="ide">name</span>: <span class="ide">n</span>, <span class="ide">age</span>: <span class="ide">a</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="ide">n</span>, <span class="str">&quot;is &quot;</span>, <span class="ide">a</span>, <span class="str">&quot; years old&quot;</span></div></div>  </code></pre>
<p>Again, this is the same as</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">p</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Person</span>(<span class="ide">n</span>, <span class="ide">a</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="ide">n</span>, <span class="str">&quot;is &quot;</span>, <span class="ide">a</span>, <span class="str">&quot; years old&quot;</span></div></div>  </code></pre>
<p>Pattern matching also works as an expression:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">coord</span> <span class="op">=</span> <span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">x</span>: <span class="ide">x</span>, <span class="ide">y</span>: <span class="ide">y</span>, <span class="ide">r</span>: <span class="ide">r</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">x</span></div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">h</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">h</span></div></div>  </code></pre>
<h2>Constructing variant objects</h2>
<p>Patty also provides another macro to create algebraic data types. It looks like</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">variant</span> <span class="ide">Shape</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">r</span>: <span class="ide">float</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">float</span>, <span class="ide">h</span>: <span class="ide">float</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">UnitCircle</span></div></div>  </code></pre>
<p>and expands to</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">type</span></div></div><div class="line"><div class="line-content">  <span class="ide">ShapeKind</span> {<span class="op">.</span><span class="ide">pure</span><span class="op">.</span>} <span class="op">=</span> <span class="kwd">enum</span></div></div><div class="line"><div class="line-content">    <span class="ide">Circle</span>, <span class="ide">Rectangle</span>, <span class="ide">UnitCircle</span></div></div><div class="line"><div class="line-content">  <span class="ide">Shape</span> <span class="op">=</span> <span class="kwd">object</span></div></div><div class="line"><div class="line-content">    <span class="kwd">case</span> <span class="ide">kind</span>: <span class="ide">ShapeKind</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">r</span>: <span class="ide">float</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">      <span class="ide">w</span>: <span class="ide">float</span></div></div><div class="line"><div class="line-content">      <span class="ide">h</span>: <span class="ide">float</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">UnitCircle</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">nil</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> `<span class="op">==</span>`(<span class="ide">a</span>: <span class="ide">Shape</span>; <span class="ide">b</span>: <span class="ide">Shape</span>): <span class="ide">bool</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">a</span><span class="op">.</span><span class="ide">kind</span> <span class="op">==</span> <span class="ide">b</span><span class="op">.</span><span class="ide">kind</span>:</div></div><div class="line"><div class="line-content">    <span class="kwd">case</span> <span class="ide">a</span><span class="op">.</span><span class="ide">kind</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">return</span> <span class="ide">a</span><span class="op">.</span><span class="ide">r</span> <span class="op">==</span> <span class="ide">b</span><span class="op">.</span><span class="ide">r</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">return</span> <span class="ide">a</span><span class="op">.</span><span class="ide">w</span> <span class="op">==</span> <span class="ide">b</span><span class="op">.</span><span class="ide">w</span> <span class="kwd">and</span> <span class="ide">a</span><span class="op">.</span><span class="ide">h</span> <span class="op">==</span> <span class="ide">b</span><span class="op">.</span><span class="ide">h</span></div></div><div class="line"><div class="line-content">    <span class="kwd">of</span> <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">UnitCircle</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">return</span> <span class="ide">true</span></div></div><div class="line"><div class="line-content">  <span class="kwd">else</span>:</div></div><div class="line"><div class="line-content">    <span class="kwd">return</span> <span class="ide">false</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">Circle</span>(<span class="ide">r</span>: <span class="ide">float</span>): <span class="ide">Shape</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Circle</span>, <span class="ide">r</span>: <span class="ide">r</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">float</span>; <span class="ide">h</span>: <span class="ide">float</span>): <span class="ide">Shape</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">Rectangle</span>, <span class="ide">w</span>: <span class="ide">w</span>, <span class="ide">h</span>: <span class="ide">h</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">UnitCircle</span>(): <span class="ide">Shape</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="ide">Shape</span>(<span class="ide">kind</span>: <span class="ide">ShapeKind</span><span class="op">.</span><span class="ide">UnitCircle</span>)</div></div>  </code></pre>
<p>Notice that the macro also generates three convenient constructors
(<code>Circle</code> ,<code>Rectangle</code> and <code>UnitCircle</code>), and in fact the enum is pure to avoid
a name conflict. Also, a proper definition of equality based on the actual
contents of the record is generated.</p>
<p><strong>By default the generated ADT is private to the module</strong>. If you want to
generate a public ADT use the <code>variantp</code> macro, which has the same syntax
as <code>variant</code> but makes the types, fields, equality definition and generated
constructors public.</p>
<p>A limitation of the <code>variant</code> macro is that field names must be unique across
branches (that is, different variants cannot have two fields with the same name).
This is actually a limitation of Nim.</p>
<p>In the future, Patty may also add copy constructors. Also, some work needs to
be done to make it easier to use the generated contructors with <code>ref</code> types,
in particular for the important case of recursive algebraic data types.</p>
<h2>Example</h2>
<p>The following example uses the <code>variant</code> macro to define a linked list type,
and then uses pattern matching to define the sum of a list of integers:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">patty</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> `<span class="op">~</span>`[<span class="ide">A</span>](<span class="ide">a</span>: <span class="ide">A</span>): <span class="kwd">ref</span> <span class="ide">A</span> <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="ide">new</span>(<span class="ide">result</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">result</span>[] <span class="op">=</span> <span class="ide">a</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">variant</span> <span class="ide">List</span>[<span class="ide">A</span>]:</div></div><div class="line"><div class="line-content">  <span class="kwd">Nil</span></div></div><div class="line"><div class="line-content">  <span class="ide">Cons</span>(<span class="ide">x</span>: <span class="ide">A</span>, <span class="ide">xs</span>: <span class="kwd">ref</span> <span class="ide">List</span>[<span class="ide">A</span>])</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">listHelper</span>[<span class="ide">A</span>](<span class="ide">xs</span>: <span class="ide">seq</span>[<span class="ide">A</span>]): <span class="ide">List</span>[<span class="ide">A</span>] <span class="op">=</span></div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">xs</span><span class="op">.</span><span class="ide">len</span> <span class="op">==</span> <span class="num">0</span>: <span class="kwd">Nil</span>[<span class="ide">A</span>]()</div></div><div class="line"><div class="line-content">  <span class="kwd">else</span>: <span class="ide">Cons</span>(<span class="ide">xs</span>[<span class="num">0</span>], <span class="op">~</span><span class="ide">listHelper</span>(<span class="ide">xs</span>[<span class="num">1</span> <span class="op">..</span> <span class="ide">xs</span><span class="op">.</span><span class="ide">high</span>]))</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">list</span>[<span class="ide">A</span>](<span class="ide">xs</span>: <span class="ide">varargs</span>[<span class="ide">A</span>]): <span class="ide">List</span>[<span class="ide">A</span>] <span class="op">=</span> <span class="ide">listHelper</span>(<span class="op">@</span><span class="ide">xs</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">sum</span>(<span class="ide">xs</span>: <span class="ide">List</span>[<span class="ide">int</span>]): <span class="ide">int</span> <span class="op">=</span> (<span class="kwd">block</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">match</span> <span class="ide">xs</span>:</div></div><div class="line"><div class="line-content">    <span class="kwd">Nil</span>: <span class="num">0</span></div></div><div class="line"><div class="line-content">    <span class="ide">Cons</span>(<span class="ide">y</span>, <span class="ide">ys</span>): <span class="ide">y</span> <span class="op">+</span> <span class="ide">sum</span>(<span class="ide">ys</span>[])</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">sum</span>(<span class="ide">list</span>(<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>))</div></div>  </code></pre>
<h2>Versions</h2>
<p>Patty 0.3.0 works for latest Nim (devel). For older versions of Nim (up to 0.16.0),
use Patty 0.2.1.</p>
<h2>Things that do not work (yet)</h2>
<p>One would expect many forms of pattern matching but, at least for now, the
support in Patty is very limited. Things that would be nice to support but do
not work yet include:</p>
<ul>
<li>matching a constant</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="str">&quot;hello&quot;</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;the string was hello&quot;</span></div></div>  </code></pre>
<ul>
<li>matching an existing variable</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">x</span> <span class="op">=</span> <span class="num">5</span></div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">x</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;c == 5&quot;</span></div></div>  </code></pre>
<ul>
<li>nested pattern matching</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">Point</span>(<span class="ide">x</span>: <span class="ide">x</span>, <span class="ide">y</span>: <span class="ide">y</span>), <span class="ide">r</span>: <span class="ide">r</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;the abscissa of the center is &quot;</span>, <span class="ide">x</span></div></div>  </code></pre>
<ul>
<li>matching without binding</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a circle!&quot;</span></div></div>  </code></pre>
<ul>
<li>binding subpatterns</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">getMeACircle</span>():</div></div><div class="line"><div class="line-content">  <span class="ide">c</span><span class="op">@</span><span class="ide">Circle</span>(<span class="ide">x</span>, <span class="ide">y</span>, <span class="ide">r</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;there you have &quot;</span>, <span class="ide">c</span></div></div>  </code></pre>
<ul>
<li>unification</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">r</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Rectangle</span>(<span class="ide">w</span>: <span class="ide">x</span>, <span class="ide">h</span>: <span class="ide">x</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a square&quot;</span></div></div>  </code></pre>
<ul>
<li>guards</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span>(<span class="ide">x</span>: <span class="ide">x</span>, <span class="ide">y</span>: <span class="ide">y</span>, <span class="ide">r</span>: <span class="ide">r</span>) <span class="kwd">if</span> <span class="ide">r</span> <span class="op">&lt;</span> <span class="num">0</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;the circle has negative length&quot;</span></div></div>  </code></pre>
<ul>
<li>variable-length pattern matching, such as with arrays</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  [<span class="ide">a</span>, <span class="ide">b</span>, <span class="ide">c</span>]:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;the length is 3 and the first elements is &quot;</span>, <span class="ide">a</span></div></div>  </code></pre>
<ul>
<li>custom pattern matchers, such as in regexes</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">Email</span> <span class="op">=</span> r"(\w+)@(\w+).(\w+)"</div></div><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Email</span>(<span class="ide">name</span>, <span class="ide">domain</span>, <span class="ide">tld</span>):</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;hello &quot;</span>, <span class="ide">name</span></div></div>  </code></pre>
<ul>
<li>combining patterns with <code>or</code></li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">match</span> <span class="ide">c</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">Circle</span> <span class="kwd">or</span> <span class="ide">Rectangle</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="str">&quot;it is a shape&quot;</span></div></div>  </code></pre>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        Apache License 2.0
                    </p>
                

                
                    <p> <a href="https://github.com/andreaferretti/patty">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-09-19T01:08:09Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
