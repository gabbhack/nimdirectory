<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">sqlbuilder</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">sql</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">sqlbuilder</button></a>
                </span>
            
        </p>
        
            <p class="pkg-desc">A SQLbuilder with support for NULL values</p>
        
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install sqlbuilder" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><p>  <em>This readme is generated with   <a href="https://github.com/ThomasTJdev/nimtomd">Nim to Markdown</a></em></p>
<h1>SQL builder</h1>
<p>SQL builder for <code>INSERT</code>, <code>UPDATE</code>, <code>SELECT</code> and <code>DELETE</code> queries.
The builder will check for NULL values and build a query with them.</p>
<p>After Nim&apos;s update to 0.19.0, the check for NULL values was removed
due to the removal of <code>nil</code>.</p>
<p>This library allows the user, to insert NULL values into queries and
ease the creating of queries.</p>
<h1>TOC</h1>
<ul>
<li>General
<ul>
<li>  <a href="#importing">Importing and use</a></li>
<li>  <a href="#macro-generated-queries">Macro generated queries</a></li>
<li>  <a href="#null-values">NULL values</a></li>
</ul>
</li>
<li>Main examples
<ul>
<li>  <a href="#examples-insert">Examples (INSERT)</a></li>
<li>  <a href="#examples-update">Examples (UPDATE)</a></li>
<li>  <a href="#examples-select">Examples (SELECT)</a></li>
</ul>
</li>
<li>Utilities
<ul>
<li>  <a href="#custom-args">Custom args</a></li>
<li>  <a href="#dynamic-selection-of-columns">Dynamic selection of columns</a></li>
<li>  <a href="#query-calls-for-the-lazy">Query calls for the lazy</a></li>
<li>  <a href="#convert-result-to-types">Convert result to types</a></li>
</ul>
</li>
<li>  <a href="#examples">Examples</a></li>
</ul>
<h1>Importing</h1>
<h2>Import all</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">sqlbuilder</span></div></div>  </code></pre>
<h2>Import only the SELECT builder</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">select</span></div></div>  </code></pre>
<h2>Import and set global soft delete marker</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">const</span> <span class="ide">tablesWithDeleteMarkerInit</span> <span class="op">=</span> [<span class="str">&quot;table_with_deletemarker&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="kwd">include</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilder_include</span></div></div>  </code></pre>
<h2>Import all but with legacy softdelete fix</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">sqlbuilderpkg</span><span class="op">/</span><span class="ide">insert</span></div></div><div class="line"><div class="line-content"><span class="kwd">export</span> <span class="ide">insert</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">sqlbuilderpkg</span><span class="op">/</span><span class="ide">update</span></div></div><div class="line"><div class="line-content"><span class="kwd">export</span> <span class="ide">update</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">sqlbuilderpkg</span><span class="op">/</span><span class="ide">delete</span></div></div><div class="line"><div class="line-content"><span class="kwd">export</span> <span class="ide">delete</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">sqlbuilderpkg</span><span class="op">/</span><span class="ide">utils</span></div></div><div class="line"><div class="line-content"><span class="kwd">export</span> <span class="ide">utils</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># This enables the softdelete columns for the legacy selector</span></div></div><div class="line"><div class="line-content"><span class="kwd">const</span> <span class="ide">tablesWithDeleteMarker</span> <span class="op">=</span> [<span class="str">&quot;tasks&quot;</span>, <span class="str">&quot;persons&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="com"># Notice the include instead of import</span></div></div><div class="line"><div class="line-content"><span class="kwd">include</span> <span class="ide">src</span><span class="op">/</span><span class="ide">sqlbuilderpkg</span><span class="op">/</span><span class="ide">select</span></div></div>  </code></pre>
<h1>Macro generated queries</h1>
<p>The library supports generating some queries with a macro which can improve the
performance due to query being generated on compile time.</p>
<h1>NULL values</h1>
<p>After Nim&apos;s update to 0.19.0, the check for NULL values was removed
due to the removal of <code>nil</code>.</p>
<p>You can use <code>NULL</code> values in different ways. See the examples.</p>
<h2>Inline in query</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">sqlSelect</span>(</div></div><div class="line"><div class="line-content">      <span class="ide">table</span>     <span class="op">=</span> <span class="str">&quot;tasks&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="ide">tableAs</span>   <span class="op">=</span> <span class="str">&quot;t&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="ide">select</span>    <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;id&quot;</span>, <span class="str">&quot;name&quot;</span>, <span class="str">&quot;description&quot;</span>, <span class="str">&quot;created&quot;</span>, <span class="str">&quot;updated&quot;</span>, <span class="str">&quot;completed&quot;</span>],</div></div><div class="line"><div class="line-content">      <span class="ide">where</span>     <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;id =&quot;</span>, <span class="str">&quot;name != NULL&quot;</span>, <span class="str">&quot;description = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      <span class="ide">useDeleteMarker</span> <span class="op">=</span> <span class="ide">false</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;SELECT id, name, description, created, updated, completed FROM tasks AS t WHERE id = ? AND name != NULL AND description = NULL &quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>, <span class="str">&quot;info = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;id =&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE table SET name = ?, age = ?, info = NULL WHERE id = ?&quot;</span>))</div></div>  </code></pre>
<h2>Custom args</h2>
<h3>A NULL value</h3>
<p>The global <code>const dbNullVal</code> represents a NULL value. Use <code>dbNullVal</code>
in your args if you need to insert/update to a NULL value.</p>
<h3>Insert value or NULL</h3>
<p>The global <code>proc dbValOrNull()</code> will check, if it contains a value
or is empty. If it contains a value, the value will be used in the args,
otherwise a NULL value (<code>dbNullVal</code>) will be used.</p>
<p><code>dbValOrNull()</code> accepts all types due to <code>value: auto</code>.</p>
<h3>Auto NULL-values</h3>
<p>There are two generators, which can generate the <code>NULL</code> values for you.</p>
<ul>
<li><code>genArgs</code> does only set a field to <code>NULL</code> if <code>dbNullVal</code>/<code>dbValOrNull()</code> is passed.</li>
<li><code>genArgsSetNull</code> sets empty field (<code>&quot;&quot;</code> / <code>c.len() == 0</code>) to <code>NULL</code>.</li>
</ul>
<h1>Examples (INSERT)</h1>
<h2>Insert default</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlInsert</span>(<span class="str">&quot;my-table&quot;</span>, [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>])</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;INSERT INTO my-table (name, age) VALUES (?, ?)&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlInsert</span>(<span class="str">&quot;my-table&quot;</span>, [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age = NULL&quot;</span>])</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;INSERT INTO my-table (name, age) VALUES (?, NULL)&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">vals</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;thomas&quot;</span>, <span class="str">&quot;&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlInsert</span>(<span class="str">&quot;my-table&quot;</span>, [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>], <span class="ide">vals</span>)</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;INSERT INTO my-table (name, age) VALUES (?, NULL)&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlInsertMacro</span>(<span class="str">&quot;my-table&quot;</span>, [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age = NULL&quot;</span>])</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;INSERT INTO my-table (name, age) VALUES (?, NULL)&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="str">&quot;em@em.com&quot;</span>, <span class="ide">dbNullVal</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlInsert</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; INSERT INTO myTable (email) VALUES (?)</span></div></div>  </code></pre>
<h1>Examples (UPDATE)</h1>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>, <span class="str">&quot;info&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;id =&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE table SET name = ?, age = ?, info = ? WHERE id = ?&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>, <span class="str">&quot;info = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;id =&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE table SET name = ?, age = ?, info = NULL WHERE id = ?&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;name = NULL&quot;</span>, <span class="str">&quot;age&quot;</span>, <span class="str">&quot;info = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;id =&quot;</span>, <span class="str">&quot;epoch &gt;&quot;</span>, <span class="str">&quot;parent IS NULL&quot;</span>, <span class="str">&quot;name IS NOT NULL&quot;</span>, <span class="str">&quot;age != 22&quot;</span>, <span class="str">&quot;age !=&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE table SET name = NULL, age = ?, info = NULL WHERE id = ? AND epoch &gt; ? AND parent IS NULL AND name IS NOT NULL AND age != 22 AND age != ?&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;parents = ARRAY_APPEND(id, ?)&quot;</span>, <span class="str">&quot;age = ARRAY_REMOVE(id, ?)&quot;</span>, <span class="str">&quot;info = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;last_name NOT IN (&apos;Anderson&apos;, &apos;Johnson&apos;, &apos;Smith&apos;)&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE table SET parents = ARRAY_APPEND(id, ?), age = ARRAY_REMOVE(id, ?), info = NULL WHERE last_name NOT IN (&apos;Anderson&apos;, &apos;Johnson&apos;, &apos;Smith&apos;)&quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="com"># sqlUpdate or sqlUpdateMacro</span></div></div><div class="line"><div class="line-content">  <span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(</div></div><div class="line"><div class="line-content">      <span class="str">&quot;table&quot;</span>,</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;name = NULL&quot;</span>, <span class="str">&quot;age&quot;</span>, <span class="str">&quot;info = NULL&quot;</span>],</div></div><div class="line"><div class="line-content">      [<span class="str">&quot;id =&quot;</span>, <span class="str">&quot;epoch &gt;&quot;</span>, <span class="str">&quot;parent IS NULL&quot;</span>, <span class="str">&quot;name IS NOT NULL&quot;</span>, <span class="str">&quot;age != 22&quot;</span>, <span class="str">&quot;age !=&quot;</span>],</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">  <span class="com"># ==&gt; UPDATE table SET name = NULL, age = ?, info = NULL WHERE id = ? AND epoch &gt; ? AND parent IS NULL AND name IS NOT NULL AND age != 22 AND age != ?</span></div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">a2</span> <span class="op">=</span> <span class="ide">genArgsSetNull</span>(<span class="str">&quot;hje&quot;</span>, <span class="str">&quot;&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">q</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(<span class="str">&quot;my-table&quot;</span>, [<span class="str">&quot;name&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;id&quot;</span>], <span class="ide">a2</span><span class="op">.</span><span class="ide">query</span>)</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">q</span>, <span class="ide">sql</span>(<span class="str">&quot;UPDATE my-table SET name = ?, age = NULL WHERE id = ?&quot;</span>))</div></div>  </code></pre>
<h1>Examples (SELECT)</h1>
<h2>Example on builder</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlSelect</span>(</div></div><div class="line"><div class="line-content">  <span class="ide">table</span>     <span class="op">=</span> <span class="str">&quot;tasks&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">tableAs</span>   <span class="op">=</span> <span class="str">&quot;t&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">select</span>    <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;id&quot;</span>, <span class="str">&quot;name&quot;</span>],</div></div><div class="line"><div class="line-content">  <span class="ide">where</span>     <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;id =&quot;</span>],</div></div><div class="line"><div class="line-content">  <span class="ide">joinargs</span>  <span class="op">=</span> <span class="op">@</span>[(<span class="ide">table</span>: <span class="str">&quot;projects&quot;</span>, <span class="ide">tableAs</span>: <span class="str">&quot;&quot;</span>, <span class="ide">on</span>: <span class="op">@</span>[<span class="str">&quot;projects.id = t.project_id&quot;</span>, <span class="str">&quot;projects.status = 1&quot;</span>])],</div></div><div class="line"><div class="line-content">  <span class="ide">jointype</span>  <span class="op">=</span> <span class="ide">INNER</span></div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>(<span class="str">&quot;SELECT id, name FROM tasks AS t INNER JOIN projects ON (projects.id = t.project_id AND projects.status = 1) WHERE id = ? &quot;</span>))</div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlSelect</span>(</div></div><div class="line"><div class="line-content">  <span class="ide">table</span>     <span class="op">=</span> <span class="str">&quot;tasksitems&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">tableAs</span>   <span class="op">=</span> <span class="str">&quot;tasks&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">select</span>    <span class="op">=</span> <span class="op">@</span>[</div></div><div class="line"><div class="line-content">      <span class="str">&quot;tasks.id&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;tasks.name&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;tasks.status&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;tasks.created&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;his.id&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;his.name&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;his.status&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;his.created&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;projects.id&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;projects.name&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;person.id&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;person.name&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;person.email&quot;</span></div></div><div class="line"><div class="line-content">    ],</div></div><div class="line"><div class="line-content">  <span class="ide">where</span>     <span class="op">=</span> <span class="op">@</span>[</div></div><div class="line"><div class="line-content">      <span class="str">&quot;projects.id =&quot;</span>,</div></div><div class="line"><div class="line-content">      <span class="str">&quot;tasks.status &gt;&quot;</span></div></div><div class="line"><div class="line-content">    ],</div></div><div class="line"><div class="line-content">  <span class="ide">joinargs</span>  <span class="op">=</span> <span class="op">@</span>[</div></div><div class="line"><div class="line-content">      (<span class="ide">table</span>: <span class="str">&quot;history&quot;</span>, <span class="ide">tableAs</span>: <span class="str">&quot;his&quot;</span>, <span class="ide">on</span>: <span class="op">@</span>[<span class="str">&quot;his.id = tasks.hid&quot;</span>, <span class="str">&quot;his.status = 1&quot;</span>]),</div></div><div class="line"><div class="line-content">      (<span class="ide">table</span>: <span class="str">&quot;projects&quot;</span>, <span class="ide">tableAs</span>: <span class="str">&quot;&quot;</span>, <span class="ide">on</span>: <span class="op">@</span>[<span class="str">&quot;projects.id = tasks.project_id&quot;</span>, <span class="str">&quot;projects.status = 1&quot;</span>]),</div></div><div class="line"><div class="line-content">      (<span class="ide">table</span>: <span class="str">&quot;person&quot;</span>, <span class="ide">tableAs</span>: <span class="str">&quot;&quot;</span>, <span class="ide">on</span>: <span class="op">@</span>[<span class="str">&quot;person.id = tasks.person_id&quot;</span>])</div></div><div class="line"><div class="line-content">    ],</div></div><div class="line"><div class="line-content">  <span class="ide">whereInField</span> <span class="op">=</span> <span class="str">&quot;tasks.id&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">whereInValue</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;1&quot;</span>, <span class="str">&quot;2&quot;</span>, <span class="str">&quot;3&quot;</span>],</div></div><div class="line"><div class="line-content">  <span class="ide">customSQL</span> <span class="op">=</span> <span class="str">&quot;ORDER BY tasks.created DESC&quot;</span>,</div></div><div class="line"><div class="line-content">  <span class="ide">tablesWithDeleteMarker</span> <span class="op">=</span> <span class="ide">tableWithDeleteMarker</span></div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, (<span class="ide">sql</span>("""
    SELECT
      tasks.id,
      tasks.name,
      tasks.status,
      tasks.created,
      his.id,
      his.name,
      his.status,
      his.created,
      projects.id,
      projects.name,
      person.id,
      person.name,
      person.email
    FROM
      tasksitems AS tasks
    LEFT JOIN history AS his ON
      (his.id = tasks.hid AND his.status = 1 AND his.is_deleted IS NULL)
    LEFT JOIN projects ON
      (projects.id = tasks.project_id AND projects.status = 1)
    LEFT JOIN person ON
      (person.id = tasks.person_id)
    WHERE
          projects.id = ?
      AND tasks.status > ?
      AND tasks.id in (1,2,3)
      AND tasks.is_deleted IS NULL
    ORDER BY
      tasks.created DESC
  """)))</div></div>  </code></pre>
<h2>Convert legacy</h2>
<p>The legacy SELECT builder is deprecated and will be removed in the future. It
is commented out in the source code, and a converter has been added to convert
the legacy query to the new builder.</p>
<p>That means, you don&apos;t have to worry, but you should definitely convert your
legacy queries to the new builder.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="com"># Legacy builder</span></div></div><div class="line"><div class="line-content"><span class="ide">test</span> <span class="op">=</span> <span class="ide">sqlSelect</span>(<span class="str">&quot;tasks AS t&quot;</span>, [<span class="str">&quot;t.id&quot;</span>, <span class="str">&quot;t.name&quot;</span>, <span class="str">&quot;p.id&quot;</span>], [<span class="str">&quot;project AS p ON p.id = t.project_id&quot;</span>], [<span class="str">&quot;t.id =&quot;</span>], <span class="str">&quot;&quot;</span>, <span class="str">&quot;&quot;</span>, <span class="str">&quot;&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">check</span> <span class="ide">querycompare</span>(<span class="ide">test</span>, <span class="ide">sql</span>("""
    SELECT
      t.id,
      t.name,
      p.id
    FROM
      tasks AS t
    LEFT JOIN project AS p ON
      (p.id = t.project_id)
    WHERE
      t.id = ?
  """))</div></div>  </code></pre>
<h1>Custom args</h1>
<h2>Update string &amp; int</h2>
<h3>Version 1</h3>
<p>  <em>Required if NULL values could be expected</em></p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="str">&quot;em@em.com&quot;</span>, <span class="num">20</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; string, int</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = ?, age = ? WHERE name = ?</span></div></div>  </code></pre>
<h3>Version 2</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>]), <span class="str">&quot;em@em.com&quot;</span>, <span class="num">20</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; string, int</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = ?, age = ? WHERE name = ?</span></div></div>  </code></pre>
<h3>Version 3</h3>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgsSetNull</span>(<span class="str">&quot;em@em.com&quot;</span>, <span class="str">&quot;&quot;</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; string, NULL</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = ?, age = NULL WHERE name = ?</span></div></div>  </code></pre>
<h2>Update NULL &amp; int</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="str">&quot;&quot;</span>, <span class="num">20</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; NULL, int</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = NULL, age = ? WHERE name = ?</span></div></div>  </code></pre>
<h2>Update string &amp; NULL</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="str">&quot;aa@aa.aa&quot;</span>, <span class="ide">dbNullVal</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; string, NULL</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = ?, age = NULL WHERE name = ?</span></div></div>  </code></pre>
<h2>Error: Update string &amp; NULL into an integer column</h2>
<p>An empty string, &quot;&quot;, will be inserted into the database as NULL.
Empty string cannot be used for an INTEGER column. You therefore
need to use the <code>dbValOrNull()</code> or <code>dbNullVal</code> for <code>int-values</code>.</p>
<p>This is due to, that the library does not know you DB-architecture, so it
is your responsibility to respect the columns.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="str">&quot;aa@aa.aa&quot;</span>, <span class="str">&quot;&quot;</span>, <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; string, ERROR</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = ?, age = ? WHERE name = ?</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; To insert a NULL into a int-field, it is required to use dbValOrNull()</span></div></div><div class="line"><div class="line-content"> <span class="com">#     or dbNullVal, it is only possible to pass and empty string.</span></div></div>  </code></pre>
<h2>Update NULL &amp; NULL</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">cc</span> <span class="op">=</span> <span class="str">&quot;&quot;</span></div></div><div class="line"><div class="line-content"> <span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="ide">dbValOrNull</span>(<span class="ide">cc</span>), <span class="ide">dbValOrNull</span>(<span class="ide">cc</span>), <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; NULL, NULL</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE myTable SET email = NULL, age = NULL WHERE name = ?</span></div></div>  </code></pre>
<h2>Update unknow value - maybe NULL</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">a</span> <span class="op">=</span> <span class="ide">genArgs</span>(<span class="ide">dbValOrNull</span>(<span class="ide">var1</span>), <span class="ide">dbValOrNull</span>(<span class="ide">var2</span>), <span class="str">&quot;John&quot;</span>)</div></div><div class="line"><div class="line-content"> <span class="ide">exec</span>(<span class="ide">db</span>, <span class="ide">sqlUpdate</span>(<span class="str">&quot;myTable&quot;</span>, [<span class="str">&quot;email&quot;</span>, <span class="str">&quot;age&quot;</span>], [<span class="str">&quot;name&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>), <span class="ide">a</span><span class="op">.</span><span class="ide">args</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; AUTO or NULL, AUTO or NULL, string</span></div></div>  </code></pre>
<h1>Dynamic selection of columns</h1>
<p>Select which columns to include.</p>
<p>Lets say, that you are importing data from a spreadsheet with static
columns, and you need to update your DB with the new values.</p>
<p>If the spreadsheet contains an empty field, you can update your DB with the
NULL value. But sometimes the spreadsheet only contains 5 out of the 10
static columns. Now you don&apos;t know the values of the last 5 columns,
which will result in updating the DB with NULL values.</p>
<p>The template <code>genArgsColumns()</code> allows you to use the same query, but  selecting
only the columns which shall be updated. When importing your spreadsheet, check
if the column exists (bool), and pass that as the <code>use: bool</code> param. If
the column does not exists, it will be skipped in the query.</p>
<h2>Insert &amp; Delete</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">s</span>, <span class="ide">a</span>) <span class="op">=</span> <span class="ide">genArgsColumns</span>((<span class="ide">true</span>, <span class="str">&quot;name&quot;</span>, <span class="str">&quot;Thomas&quot;</span>), (<span class="ide">true</span>, <span class="str">&quot;age&quot;</span>, <span class="num">30</span>), (<span class="ide">false</span>, <span class="str">&quot;nim&quot;</span>, <span class="str">&quot;never&quot;</span>))</div></div><div class="line"><div class="line-content"> <span class="com"># We are using the column `name` and `age` and ignoring the column `nim`.</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="op">$</span><span class="ide">a</span><span class="op">.</span><span class="ide">args</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; Args: @[&quot;Thomas&quot;, &quot;30&quot;]</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="kwd">let</span> <span class="ide">a1</span> <span class="op">=</span> <span class="ide">sqlInsert</span>(<span class="str">&quot;my-table&quot;</span>, <span class="ide">s</span>, <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; INSERT INTO my-table (name, age) VALUES (?, ?)</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="kwd">let</span> <span class="ide">a2</span> <span class="op">=</span> <span class="ide">sqlDelete</span>(<span class="str">&quot;my-table&quot;</span>, <span class="ide">s</span>, <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; DELETE FROM my-table WHERE name = ? AND age = ?</span></div></div>  </code></pre>
<h2>Update &amp; Select</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> (<span class="ide">s</span>, <span class="ide">a</span>) <span class="op">=</span> <span class="ide">genArgsColumns</span>((<span class="ide">true</span>, <span class="str">&quot;name&quot;</span>, <span class="str">&quot;Thomas&quot;</span>), (<span class="ide">true</span>, <span class="str">&quot;age&quot;</span>, <span class="num">30</span>), (<span class="ide">false</span>, <span class="str">&quot;nim&quot;</span>, <span class="str">&quot;&quot;</span>), (<span class="ide">true</span>, <span class="str">&quot;&quot;</span>, <span class="str">&quot;154&quot;</span>))</div></div><div class="line"><div class="line-content"> <span class="com"># We are using the column `name` and `age` and ignoring the column `nim`. We</span></div></div><div class="line"><div class="line-content"> <span class="com"># are using the value `154` as our identifier, therefor the column is not</span></div></div><div class="line"><div class="line-content"> <span class="com"># specified</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="ide">echo</span> <span class="op">$</span><span class="ide">a</span><span class="op">.</span><span class="ide">args</span></div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; Args: @[&quot;Thomas&quot;, &quot;30&quot;, &quot;154&quot;]</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="kwd">let</span> <span class="ide">a3</span> <span class="op">=</span> <span class="ide">sqlUpdate</span>(<span class="str">&quot;my-table&quot;</span>, <span class="ide">s</span>, [<span class="str">&quot;id&quot;</span>], <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; UPDATE my-table SET name = ?, age = ? WHERE id = ?</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"> <span class="kwd">let</span> <span class="ide">a4</span> <span class="op">=</span> <span class="ide">sqlSelect</span>(<span class="str">&quot;my-table&quot;</span>, <span class="ide">s</span>, [<span class="str">&quot;&quot;</span>], [<span class="str">&quot;id =&quot;</span>], <span class="str">&quot;&quot;</span>, <span class="str">&quot;&quot;</span>, <span class="str">&quot;&quot;</span>, <span class="ide">a</span><span class="op">.</span><span class="ide">query</span>)</div></div><div class="line"><div class="line-content"> <span class="com"># ==&gt; SELECT name, age FROM my-table WHERE id = ?</span></div></div>  </code></pre>
<h1>Query calls for the lazy</h1>
<p>These are procs to catch DB errors and return a default value to move on.
This should only be used if:</p>
<ul>
<li>It is not critical data</li>
<li>You can live with a default value in case of an error</li>
<li>You have no other way to catch the error</li>
<li>You are to lazy to write the try-except procs yourself</li>
</ul>
<p>!! These are not available if you use external libraries, e.g. <code>waterpark</code>,
!! since they rely on default<code>DbConn</code>.</p>
<h2>Import</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">sqlbuilder</span><span class="op">/</span><span class="ide">query_calls</span></div></div>  </code></pre>
<h2>Procs</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">getValueTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>, <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">string</span> <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">getAllRowsTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>, <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">seq</span>[<span class="ide">Row</span>] <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">getRowTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>, <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">Row</span> <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">tryExecTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>; <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">bool</span> <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">execTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>; <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]) <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">execAffectedRowsTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>; <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">int64</span> <span class="op">=</span></div></div>  </code></pre>
<hr />
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">iterator</span> <span class="ide">fastRowsTry</span><span class="op">*</span>(<span class="ide">db</span>: <span class="ide">DbConn</span>, <span class="ide">query</span>: <span class="ide">SqlQuery</span>, <span class="ide">args</span>: <span class="ide">varargs</span>[<span class="ide">string</span>, `<span class="op">$</span>`]): <span class="ide">Row</span> <span class="op">=</span></div></div>  </code></pre>
<hr />
<h1>Convert result to types</h1>
<p>The <code>totypes</code> module contains procs to convert the result to types.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">type</span></div></div><div class="line"><div class="line-content">  <span class="ide">Person</span> <span class="op">=</span> <span class="kwd">ref</span> <span class="kwd">object</span></div></div><div class="line"><div class="line-content">    <span class="ide">id</span>: <span class="ide">int</span></div></div><div class="line"><div class="line-content">    <span class="ide">name</span>: <span class="ide">string</span></div></div><div class="line"><div class="line-content">    <span class="ide">age</span>: <span class="ide">int</span></div></div><div class="line"><div class="line-content">    <span class="ide">ident</span>: <span class="ide">string</span></div></div><div class="line"><div class="line-content">    <span class="ide">is_nimmer</span>: <span class="ide">bool</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">  <span class="ide">columns</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;name&quot;</span>,<span class="str">&quot;id&quot;</span>,<span class="str">&quot;ident&quot;</span>]</div></div><div class="line"><div class="line-content">  <span class="ide">val</span> <span class="op">=</span> <span class="ide">db</span><span class="op">.</span><span class="ide">getRow</span>(<span class="ide">sql</span>(<span class="str">&quot;SELECT &quot;</span> <span class="op">&amp;</span> <span class="ide">columns</span><span class="op">.</span><span class="ide">join</span>(<span class="str">&quot;,&quot;</span>) <span class="op">&amp;</span> <span class="str">&quot; FROM my_table WHERE id = 1&quot;</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">res</span> <span class="op">=</span> <span class="ide">sqlToType</span>(<span class="ide">Person</span>, <span class="ide">columns</span>, <span class="ide">val</span>)</div></div>  </code></pre>
<h1>Examples</h1>
<p>See the test files in <code>tests/</code> for more examples.</p>
<h1>Credit</h1>
<p>Inspiration for builder: <a href="https://github.com/nim-lang/nimforum">Nim Forum</a></p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/ThomasTJdev/nim_sqlbuilder">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2024-02-20T01:06:26Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
