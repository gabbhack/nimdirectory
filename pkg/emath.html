<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">emath</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">math</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">expression</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">evaluator</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">ast</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">evaluation</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("math parser/evaluator library")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install emath" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><blockquote>
<p>Prophet Muhammad asked his companions, “Do you know who is the strongest person?” His companions replied, “The one who is able to wrestle others down.” The Prophet responded, “No, it is the one who is able to control their anger&quot;.</p>
</blockquote>
<h1>Introduction</h1>
<p><code>emath</code> is library that provides functionality to parse/evaluate math experssions.</p>
<h2>Flow</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">parsing</span>          <span class="ide">evaluating</span>          </div></div><div class="line"><div class="line-content"><span class="ide">string</span>  <span class="ide">─────────►</span>  <span class="ide">AST</span> <span class="ide">────────────►</span>  <span class="ide">number</span></div></div>  </code></pre>
<h2>Usage</h2>
<p>the API functions should be used in this way:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="str">&quot;1 + sin(PI)&quot;</span><span class="op">.</span><span class="ide">parse</span><span class="op">.</span><span class="ide">eval</span></div></div>  </code></pre>
<p>there is another form of <code>eval</code> function which also takes variable-lookup and function-lookup tables.</p>
<h2>Documentation</h2>
<p>for more information see documentations <a href="https://hamidb80.github.io/emath/">here</a>.</p>
<h2>Advantages</h2>
<p>parsing the expression to the actual AST, gives you the power and flexibility to do whatever processings you want with that. for example you may want to remove unnecessary parentheses around the values.</p>
<h2>Inspiration</h2>
<p>I discovered <code>tree-sitter</code> some times ago, and I watched a video on youtube about it in which the author explained some form of <code>LR</code> parsers as the base of his library.</p>
<p>Honestly despite searching on the internet about it, I couldn&apos;t understand much, but I could guess what it&apos;s doing by the very simple example that he provided about <code>LR</code> parsers and the generated codes from <code>tree-sitter</code> library.</p>
<h2>Implementation</h2>
<p>First, the lexer groups the raw exression (which is given as an <code>string</code>) to tokens. Tokens are one of these 6 types, either a <code>number</code> or an ident (like <code>var</code>) or <code>operator</code> or <code>(</code> or <code>)</code> or <code>,</code>.</p>
<p>Then the lexer passes tokens one-by-one to the parser. The parser is the <em>heart</em> of the library, it first creates an AST with an empty parenthesis as its child, then it increamentally updates that. the generated AST could be consisted of some simple Nodes like <strong>literals</strong> (like <code>1.2</code>) and <strong>variable names</strong> (like <code>PI</code>) or some compound nodes like <strong>parentheses</strong> <code>()</code> (which must contain only 1 sub node) or a <strong>function call</strong> which is consists of the caller name and its arguments, and <strong>prefix</strong> which has an operator and a node, and <strong>infix</strong> which has a operator and 2 sub nodes.</p>
<h3>Time complexity</h3>
<p>as parser increamentally iterates over tokens and updates the AST, it should have <code>O(n)</code> time complexity.</p>
<h3>Example</h3>
<p>  <strong>NOTEs:</strong></p>
<ul>
<li>the nesting means it&apos;s inside of the upper node.</li>
<li>I keep track of focused nodes with <code>#n</code> in the codes. it&apos;s actually a stack that contains nodes with index of <code>n-1</code>.</li>
</ul>
<p>Imagine you have <code>1 + 2 * 3 ^ 4 &lt; 5</code> as the expression, your initial node is a parentheses.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com"># 1</span></div></div>  </code></pre>
<p>The first token is number <code>1</code>. we simply add the number to the upper parenthesis:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Lit</span> <span class="num">1</span> <span class="com">#2</span></div></div>  </code></pre>
<p>Obviosly if you hit a number or a open/closed parentheses instead of an operator after a number, it would be an invalid token.</p>
<p>The next token is operator <code>+</code>. we are going to transfrom the tree:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span></div></div>  </code></pre>
<p>Notice that a complete infix has 2 nodes, but here it has given one, we expect that it would be completed in next iteratations.</p>
<p>The next token is number <code>2</code>. we add <code>2</code> to the infix <code>+</code> to have a complete infix.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">2</span> <span class="com">#3</span></div></div>  </code></pre>
<p>The next token is operator <code>*</code>. which has higher priority over <code>+</code> operator and we should apply it to our tree:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">*</span> <span class="com">#3</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">2</span></div></div>  </code></pre>
<p>The next token is number <code>3</code>.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">*</span> <span class="com">#3</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">2</span> </div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">3</span> <span class="com">#4</span></div></div>  </code></pre>
<p>The next token is operator <code>^</code>. which has higher priority over <code>*</code>:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">*</span> <span class="com">#3</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">2</span> </div></div><div class="line"><div class="line-content">            <span class="ide">Infix</span> <span class="op">^</span> <span class="com">#4</span></div></div><div class="line"><div class="line-content">                <span class="ide">Lit</span> <span class="num">3</span></div></div>  </code></pre>
<p>The next token is number <code>4</code>.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">+</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">*</span> <span class="com">#3</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">2</span> </div></div><div class="line"><div class="line-content">            <span class="ide">Infix</span> <span class="op">^</span> <span class="com">#4</span></div></div><div class="line"><div class="line-content">                <span class="ide">Lit</span> <span class="num">3</span></div></div><div class="line"><div class="line-content">                <span class="ide">Lit</span> <span class="num">4</span> <span class="com">#5</span></div></div>  </code></pre>
<p>The next token is operator <code>&lt;</code>. which has lower priority than <code>^</code>. we actually go up from the last node (literal <code>4</code>) until we hit a lower priority operator or we hit a wrapper (parenthesis or a function call). so here we add the infix on top.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">&lt;</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">+</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">            <span class="ide">Infix</span> <span class="op">*</span></div></div><div class="line"><div class="line-content">                <span class="ide">Lit</span> <span class="num">2</span> </div></div><div class="line"><div class="line-content">                <span class="ide">Infix</span> <span class="op">^</span></div></div><div class="line"><div class="line-content">                    <span class="ide">Lit</span> <span class="num">3</span></div></div><div class="line"><div class="line-content">                    <span class="ide">Lit</span> <span class="num">4</span></div></div>  </code></pre>
<p>the next token is number <code>5</code>.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">Par</span> <span class="com">#1</span></div></div><div class="line"><div class="line-content">    <span class="ide">Infix</span> <span class="op">&lt;</span> <span class="com">#2</span></div></div><div class="line"><div class="line-content">        <span class="ide">Infix</span> <span class="op">+</span></div></div><div class="line"><div class="line-content">            <span class="ide">Lit</span> <span class="num">1</span> </div></div><div class="line"><div class="line-content">            <span class="ide">Infix</span> <span class="op">*</span></div></div><div class="line"><div class="line-content">                <span class="ide">Lit</span> <span class="num">2</span> </div></div><div class="line"><div class="line-content">                <span class="ide">Infix</span> <span class="op">^</span></div></div><div class="line"><div class="line-content">                    <span class="ide">Lit</span> <span class="num">3</span></div></div><div class="line"><div class="line-content">                    <span class="ide">Lit</span> <span class="num">4</span></div></div><div class="line"><div class="line-content">        <span class="ide">Lit</span> <span class="num">5</span> <span class="com">#3</span></div></div>  </code></pre>
<p>We made our correct AST! I didn&apos;t convered a lot of things like prefixes and function calls, but they are not that much hard to think of.</p>
<h2>Similar Projects</h2>
<ul>
<li>  <a href="https://github.com/nocturn9x/nimkalc">nimkalc</a></li>
<li>  <a href="https://github.com/Yardanico/nim-mathexpr/">mathexpr</a></li>
<li>  <a href="https://github.com/brentp/kexpr-nim">kexpr</a></li>
</ul>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/hamidb80/emath">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-06-03T01:40:15Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
