<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">delaunator</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">delaunay</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">voronoi</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">dual graph</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">library</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Fast 2D Delaunay triangulation. A Nim port of Mapbox/Delaunator.")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install delaunator" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>Delaunator</h1>
<p>Fast 2D Delaunay triangulation. A Nim port of <a href="https://github.com/mapbox/delaunator">Mapbox/Delaunator</a>.</p>
<blockquote>
<p>Note: This port of Delaunator is not optimized. That said, give the benchmark a run an see if it measures up. Even better, help optimize the code! (<a href="#notes-on-this-port">notes on this port</a>)</p>
</blockquote>
<p>  <code>nimble install delaunator</code></p>
<p><a href="https://patternspandemic.github.io/delaunator-nim/">API Reference</a> - A work in progress.</p>
<p>See also, <a href="https://github.com/patternspandemic/pixienator">Pixienator</a>, a helper library for visualizing Delaunator using <a href="https://github.com/treeform/pixie">Pixie</a>.</p>
<img src="delaunator.png" style="max-width: 100%;" alt="Delaunator generated image example." />
<h2>Features</h2>
<ul>
<li>Delaunay Triangulation</li>
<li>Voronoi Regions</li>
<li>Uses porteded robust-predicates for robustness</li>
<li>Helpers for navigating various parts of the datastructure (not optimized)
<ul>
<li>Includes clipping of infinite regions, ala d3-delaunay&apos;s implementation</li>
</ul>
</li>
</ul>
<h2>Examples</h2>
<ul>
<li>  <a href="#construction">Construction</a></li>
<li>  <a href="#the-delaunator-object">The Delaunator Object</a></li>
<li>  <a href="#helpers">Helpers</a></li>
</ul>
<h3>  <em>Construction</em></h3>
<p>The very basics, import delaunator and construct with a flat seq of coordinates:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">delaunator</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span></div></div><div class="line"><div class="line-content">  <span class="com"># A flat seq of `float64` coordinates</span></div></div><div class="line"><div class="line-content">  <span class="ide">coords</span> <span class="op">=</span> <span class="op">@</span>[<span class="num">63.59410858154297</span>, <span class="num">198.1050262451172</span>, <span class="num">215.7989349365234</span>, <span class="num">171.0301208496094</span>, <span class="op">...</span>]</div></div><div class="line"><div class="line-content">  <span class="com"># Construct from coordinates</span></div></div><div class="line"><div class="line-content">  <span class="ide">d</span> <span class="op">=</span> <span class="ide">delaunator</span><span class="op">.</span><span class="ide">fromCoords</span>[<span class="ide">float64</span>](<span class="ide">coords</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Triplets of site ids.</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">d</span><span class="op">.</span><span class="ide">triangles</span></div></div><div class="line"><div class="line-content"><span class="com"># @[4, 5, 1, 4, 0, 5, 5, 6, 1, ...]</span></div></div>  </code></pre>
<p>One can construct from a seq of pairwise points as well:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">var</span></div></div><div class="line"><div class="line-content">  <span class="ide">points</span> <span class="op">=</span> <span class="op">@</span>[[<span class="num">63</span>, <span class="num">198</span>], [<span class="num">215</span>, <span class="num">171</span>], [<span class="num">33</span>,  <span class="num">261</span>], [<span class="num">40</span>, <span class="num">61</span>], <span class="op">...</span>]</div></div><div class="line"><div class="line-content">  <span class="com"># Constructs into a seq of `float32` coordinates</span></div></div><div class="line"><div class="line-content">  <span class="ide">d</span> <span class="op">=</span> <span class="ide">delaunator</span><span class="op">.</span><span class="ide">fromPoints</span>[<span class="ide">array</span>[<span class="num">2</span>, <span class="ide">int</span>], <span class="ide">float32</span>](<span class="ide">points</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Halfedges of triangulation.</span></div></div><div class="line"><div class="line-content"><span class="ide">echo</span> <span class="ide">d</span><span class="op">.</span><span class="ide">halfedges</span></div></div><div class="line"><div class="line-content"><span class="com"># @[5, 8, 11, 14, 17, 0, -1, 9, ...]</span></div></div>  </code></pre>
<p>Construction from more complicated types can be accomplished with <code>fromCustom</code>:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">type</span></div></div><div class="line"><div class="line-content">  <span class="ide">Site</span> <span class="op">=</span> <span class="kwd">tuple</span></div></div><div class="line"><div class="line-content">    <span class="ide">label</span>: <span class="ide">string</span></div></div><div class="line"><div class="line-content">    <span class="ide">x</span>, <span class="ide">y</span>: <span class="ide">int</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">  <span class="ide">getSiteX</span> <span class="op">=</span> <span class="kwd">proc</span> (<span class="ide">t</span>: <span class="ide">Site</span>): <span class="ide">float32</span> <span class="op">=</span> <span class="ide">float32</span>(<span class="ide">t</span><span class="op">.</span><span class="ide">x</span>)</div></div><div class="line"><div class="line-content">  <span class="ide">getSiteY</span> <span class="op">=</span> <span class="kwd">proc</span> (<span class="ide">t</span>: <span class="ide">Site</span>): <span class="ide">float32</span> <span class="op">=</span> <span class="ide">float32</span>(<span class="ide">t</span><span class="op">.</span><span class="ide">y</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span></div></div><div class="line"><div class="line-content">  <span class="com"># A custom seq of Sites</span></div></div><div class="line"><div class="line-content">  <span class="ide">sites</span>: <span class="ide">seq</span>[<span class="ide">Site</span>] <span class="op">=</span> <span class="op">@</span>[(<span class="str">&quot;a&quot;</span>, <span class="num">63</span>, <span class="num">198</span>), (<span class="str">&quot;b&quot;</span>, <span class="num">215</span>, <span class="num">171</span>), (<span class="str">&quot;c&quot;</span>, <span class="num">33</span>,  <span class="num">261</span>), (<span class="str">&quot;d&quot;</span>, <span class="num">40</span>, <span class="num">61</span>), <span class="op">...</span> ]</div></div><div class="line"><div class="line-content">  <span class="com"># Construct</span></div></div><div class="line"><div class="line-content">  <span class="ide">d</span> <span class="op">=</span> <span class="ide">delaunator</span><span class="op">.</span><span class="ide">fromCustom</span>[<span class="ide">Site</span>, <span class="ide">float32</span>](<span class="ide">sites</span>, <span class="ide">getSiteX</span>, <span class="ide">getSiteY</span>)</div></div>  </code></pre>
<h3>  <em>The Delaunator Object</em></h3>
<p>Once constructed, a Delaunator object exposes these fields:</p>
<ul>
<li><code>coords</code><br />
The flat <code>seq[float32 or float64]</code> of coordinates representing site locations from which the triangulation was built.</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="com"># The nth &apos;point&apos; x and y locations:</span></div></div><div class="line"><div class="line-content"><span class="ide">d</span><span class="op">.</span><span class="ide">coords</span>[<span class="ide">n</span> <span class="op">*</span> <span class="num">2</span>]     <span class="com"># x</span></div></div><div class="line"><div class="line-content"><span class="ide">d</span><span class="op">.</span><span class="ide">coords</span>[<span class="ide">n</span> <span class="op">*</span> <span class="num">2</span> <span class="op">+</span> <span class="num">1</span>] <span class="com"># y</span></div></div>  </code></pre>
<ul>
<li><code>triangles</code><br />
Indexed by halfedge id, a <code>seq[uint32]</code> of triplet indices into <em>coords</em> defining the Delaunay triangulation.</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span></div></div><div class="line"><div class="line-content">  <span class="ide">pid</span> <span class="op">=</span> <span class="ide">d</span><span class="op">.</span><span class="ide">triangles</span>[<span class="ide">e</span>] <span class="com"># The &apos;point&apos; id where halfedge e starts</span></div></div><div class="line"><div class="line-content">  <span class="ide">x</span> <span class="op">=</span> <span class="ide">d</span><span class="op">.</span><span class="ide">coords</span>[<span class="ide">pid</span> <span class="op">*</span> <span class="num">2</span>]</div></div><div class="line"><div class="line-content">  <span class="ide">y</span> <span class="op">=</span> <span class="ide">d</span><span class="op">.</span><span class="ide">coords</span>[<span class="ide">pid</span> <span class="op">*</span> <span class="num">2</span> <span class="op">+</span> <span class="num">1</span>]</div></div>  </code></pre>
<ul>
<li><code>halfedges</code><br />
Indexed by halfedge id, a <code>seq[int32]</code> of complement indices (representing the opposite halfedge of the adjacent triangle) to that of the index. Halfedges on the hull will have no opposite, and their complement indice will be &apos;-1&apos;.</li>
</ul>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">d</span><span class="op">.</span><span class="ide">halfedges</span>[<span class="num">0</span>] <span class="com"># 5</span></div></div><div class="line"><div class="line-content"><span class="ide">d</span><span class="op">.</span><span class="ide">halfedges</span>[<span class="num">5</span>] <span class="com"># 0</span></div></div><div class="line"><div class="line-content"><span class="ide">d</span><span class="op">.</span><span class="ide">halfedges</span>[<span class="num">6</span>] <span class="com"># -1, Halfedge with id &apos;6&apos; is on the hull</span></div></div>  </code></pre>
<blockquote>
<p>The relation between triangle and halfedge ids:</p>
<ul>
<li>The halfedges of triangle <code>t</code> are <code>3 * t</code>, <code>3 * t + 1</code>, and <code>3 * t + 2</code></li>
<li>The triangle of halfedge <code>e</code> is <code>floor(e/3)</code></li>
</ul>
</blockquote>
<ul>
<li>
<p><code>hull</code><br />
A <code>seq[uint32]</code> of indices into <em>coords</em> (point ids), representing sites that make up the triangulation&apos;s hull.</p>
</li>
<li>
<p><code>vectors</code><br />
A flat <code>seq[float32 or float64]</code> of rays emanating from each triangle circumcenter adjacent to a hull site. Used for clipping infinite Voronoi regions.</p>
</li>
<li>
<p><code>minX</code>, <code>minY</code>, <code>maxX</code>, <code>maxY</code><br />
The float32 or float64 extents of the triangulation.</p>
</li>
<li>
<p><code>bounds</code><br />
A <code>tuple[minX, minY, maxX, maxY]</code> of float32 or float64 bounds used for clipping infinite Voronoi regions against. The default bounds are the same as the extents.</p>
</li>
</ul>
<p>Note that the <code>delaunator/helpers</code> module (described next) makes working with Delaunator objects much more convienient.</p>
<h3>  <em>Helpers</em></h3>
<p>...</p>
<h2>Performance</h2>
<p>I&apos;d post some numbers here, but my kit is so old, you best just run the benchmark yourself. See <a href="https://github.com/patternspandemic/delaunator-nim/blob/main/tests/bench.nim">tests/bench.nim</a> for a benchmark based off the one in the original implementation.</p>
<h2>Notes on This Port</h2>
<p>This port has been implemented with a novice understanding of Nim, with all that entails. Practically speaking, this means the code has room for optimization, may not adhere to nim conventions and styling, and may contain outright puzzling verbosity / actions.</p>
<p>Some of this is on purpose. For instance, keeping code structure and variable naming as close to the original implementation made it easier to perform the port and locate bugs.</p>
<p>I&apos;ve attempted to support both floating point types for coordinates via generics. This appears to have made the code a bit rough around the edges with casting here and there to appease the compiler.</p>
<p>Furthermore, the way halfedges are used as indices into triangles (and therefor coordinates) is problematic (I think) to access the full range of points beyond the high(int32) without changing halfedges to be int64. More testing will have to be done to determine tradeoffs.</p>
<p>In general, I suspect a number of edge cases have yet to be handled.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        Unlicense
                    </p>
                

                
                    <p> <a href="https://github.com/patternspandemic/delaunator-nim">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-06-27T01:48:35Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
