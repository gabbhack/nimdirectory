<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">alasgar</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">game</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">engine</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">3d</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">graphics</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">gles</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">opengl</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("Game Engine")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install alasgar" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><p>  <img src="docs/files/screen-size.gif" style="max-width: 100%;" alt="" /></p>
<h1>alasgar</h1>
<p>Alasgar is a pure nim game engine based on OpenGL ES. The reason behind it was to learn graphic programming using nim programming language.</p>
<h1>Platforms</h1>
<ul>
<li>Linux</li>
<li>Windows</li>
<li>Android</li>
<li>Web (work in progress)</li>
<li>Mac (work in progress)</li>
<li>iOS (not supoorted)</li>
</ul>
<h2>Experimental game engine</h2>
<p>This is a basic game engine, and it is also too much limited so it is not ready for production use.</p>
<h2>nimx and vmath</h2>
<p>I copied most of nimx build system here, just removed and reformed some parts. I will rewrite this part later to use nimble instead of nake. nimx is a UI library (and game framework) for nim, check it out here: https://github.com/yglukhov/nimx</p>
<p>Also most of math stuff copied from vmath: https://github.com/treeform/vmath</p>
<h2>Installation</h2>
<pre>  <code class="language-bash">nimble install https://github.com/abisxir/alasgar
</code></pre>
<h2>Quick start</h2>
<pre>  <code class="language-bash">git clone https://github.com/abisxir/alasgar.git
cd alasgar/examples
nim c -r hello.nim
</code></pre>
<h1>Table of Contents</h1>
<ul>
<li>  <a href="#window-and-scene-creation">Window and scene creation</a></li>
<li>  <a href="#first-mesh">First mesh</a></li>
<li>  <a href="#point-light">Point light</a></li>
<li>  <a href="#scripts">Scripts</a></li>
<li>  <a href="#rotation">Rotation</a></li>
<li>  <a href="#material">Material</a></li>
<li>  <a href="#texture">Texture</a></li>
<li>  <a href="#more-lights">More lights</a></li>
<li>  <a href="#access-components">Access components</a></li>
<li>  <a href="#screen-size">Screen size</a></li>
<li>  <a href="#environment-variables">Environment variables</a></li>
<li>  <a href="#normal-maps">Normal maps</a></li>
<li>  <a href="#interactive-objects">Interactive objects</a></li>
<li>  <a href="#shadows">Shadows</a></li>
</ul>
<h1>Window and scene creation</h1>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">alasgar</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates a window named Hello</span></div></div><div class="line"><div class="line-content"><span class="ide">window</span>(<span class="str">&quot;Hello&quot;</span>, <span class="num">640</span>, <span class="num">360</span>)</div></div><div class="line"><div class="line-content">   </div></div><div class="line"><div class="line-content"><span class="com"># Creates a new scene</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">scene</span> <span class="op">=</span> <span class="ide">newScene</span>()</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates camera entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cameraEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Camera&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets camera position</span></div></div><div class="line"><div class="line-content"><span class="ide">cameraEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">5</span>, <span class="num">5</span>, <span class="num">5</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a perspective camera component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">cameraEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newPerspectiveCamera</span>(</div></div><div class="line"><div class="line-content">        <span class="num">75</span>, </div></div><div class="line"><div class="line-content">        <span class="ide">engine</span><span class="op">.</span><span class="ide">ratio</span>, </div></div><div class="line"><div class="line-content">        <span class="num">0.1</span>, </div></div><div class="line"><div class="line-content">        <span class="num">100.0</span>, </div></div><div class="line"><div class="line-content">        <span class="ide">vec3</span>(<span class="num">0</span>) <span class="op">-</span> <span class="ide">cameraEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the camera entity child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cameraEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Renders an empty sceene</span></div></div><div class="line"><div class="line-content"><span class="ide">render</span>(<span class="ide">scene</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Runs game main loop</span></div></div><div class="line"><div class="line-content"><span class="ide">loop</span>()</div></div>  </code></pre>
<p>As you see, we instantiate a scene, add a camera to it and we render the created scene.
If everything was right, you will see an empty window with the given size. Run it using nim compiler:</p>
<pre>  <code class="language-bash">nim c -r main.nim
</code></pre>
<p>When you create a window by defult it runs in window mode, you can easily enable fullscreen mode:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="com"># Creates a window named Hello and enables fullscreen mode.</span></div></div><div class="line"><div class="line-content"><span class="ide">window</span>(<span class="str">&quot;Hello&quot;</span>, <span class="num">640</span>, <span class="num">360</span>, <span class="ide">fullscreen</span><span class="op">=</span><span class="ide">true</span>)</div></div>  </code></pre>
<p>Let us add a cube to our scene.</p>
<h1>First mesh</h1>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates cube entity, by default position is 0, 0, 0</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Cube&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>When you run the game barely you can see the cube, as you guess we need to have a light in our scene, let us add a point light to our scene:</p>
<h1>Point light</h1>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates light entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">lightEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Light&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets light position</span></div></div><div class="line"><div class="line-content"><span class="ide">lightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="op">-</span><span class="num">5</span>, <span class="num">5</span>, <span class="num">5</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a point light component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">lightEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newPointLightComponent</span>()</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the light entity child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">lightEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/cube.jpg" style="max-width: 100%;" alt="" /></p>
<p>When you run the code, you will see an ugly grey cube. Let us move the light:</p>
<h1>Scripts</h1>
<p>To program an entity, we need to add a ScriptComponent to our light entity. Each component has access to entity, entity&apos;s transform and component&apos;s data.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates light entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">lightEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Light&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets light position</span></div></div><div class="line"><div class="line-content"><span class="ide">lightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="op">-</span><span class="num">5</span>, <span class="num">5</span>, <span class="num">5</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a point light component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">lightEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newPointLightComponent</span>()</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a script component to light entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">lightEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="kwd">const</span> <span class="ide">r</span> <span class="op">=</span> <span class="num">5</span> </div></div><div class="line"><div class="line-content">    <span class="com"># Change position on transform</span></div></div><div class="line"><div class="line-content">    <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">positionX</span> <span class="op">=</span> <span class="ide">r</span> <span class="op">*</span> <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>) </div></div><div class="line"><div class="line-content">    <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">positionZ</span> <span class="op">=</span> <span class="ide">r</span> <span class="op">*</span> <span class="ide">cos</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)</div></div><div class="line"><div class="line-content">))</div></div><div class="line"><div class="line-content"><span class="com"># Makes the light entity child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">lightEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/light-moves.gif" style="max-width: 100%;" alt="" /></p>
<p>If you run the code, light is going to move around the cube. As you see in the code we used a anonymous function to change light&apos;s position.
You can define a function and use it, here. Feel free to play with nim features.</p>
<h1>Rotation</h1>
<p>Let us rotate the cube. To do it we need a script component attached to cube entity:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates cube entity, by default position is 0, 0, 0</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Cube&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content"><span class="com"># Adds a script component to cube entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="com"># We can rotate an object using euler also we can directly set rotation property that is a quaternion.</span></div></div><div class="line"><div class="line-content">    <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">euler</span> <span class="op">=</span> <span class="ide">vec3</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>) <span class="op">*</span> <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">cos</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">))<span class="com"># Makes the cube enity child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/cube-rotates.gif" style="max-width: 100%;" alt="" /></p>
<h1>Material</h1>
<p>We can change cube color using material components. We scale cube and make it bigger and then we add a component to define cube material.
I used chroma library to manipulate colors, it is a great library, check here to see how to use it:
https://github.com/treeform/chroma</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates cube entity, by default position is 0, 0, 0</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Cube&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Set scale to 2</span></div></div><div class="line"><div class="line-content"><span class="ide">cubeEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">scale</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">2</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content"><span class="com"># Adds a script component to cube entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="com"># We can rotate an object using euler also we can directly set rotation property that is a quaternion.</span></div></div><div class="line"><div class="line-content">    <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">euler</span> <span class="op">=</span> <span class="ide">vec3</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>) <span class="op">*</span> <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">cos</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">))</div></div><div class="line"><div class="line-content"><span class="com"># Adds a material to cube</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newMaterialComponent</span>(<span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;olive&quot;</span>)))</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/cube-diffuse.gif" style="max-width: 100%;" alt="" /></p>
<h1>Texture</h1>
<p>It is time to give a texture to our cube. To make it multi-platform you need to make &quot;res&quot; folder in you project root and copy your assets inside.
The assets are accessable using a relative path by res like &quot;res://stone-texture.png&quot;. It applies to all other assets like obj files or audio files.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates cube entity, by default position is 0, 0, 0</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Cube&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Set scale to 2</span></div></div><div class="line"><div class="line-content"><span class="ide">cubeEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">scale</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">2</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content"><span class="com"># Adds a script component to cube entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="com"># We can rotate an object using euler also we can directly set rotation property that is a quaternion.</span></div></div><div class="line"><div class="line-content">    <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">euler</span> <span class="op">=</span> <span class="ide">vec3</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>) <span class="op">*</span> <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">cos</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>), </div></div><div class="line"><div class="line-content">        <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">))</div></div><div class="line"><div class="line-content"><span class="com"># Adds a material to cube</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newMaterialComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;white&quot;</span>),</div></div><div class="line"><div class="line-content">    <span class="ide">texture</span><span class="op">=</span><span class="ide">newTexture</span>(<span class="str">&quot;res://stone-texture.png&quot;</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/cube-texture.gif" style="max-width: 100%;" alt="" /></p>
<p>The texture used here grabbed from: https://opengameart.org/content/handpainted-stone-floor-texture</p>
<h1>More lights</h1>
<p>As you scene our scene has just one light and the light is moving, let us add a new light to make the scene much clear:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creats spot point light entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">spotLightEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;SpotLight&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets position to (-6, 6, 6)</span></div></div><div class="line"><div class="line-content"><span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="op">-</span><span class="num">6</span>, <span class="num">6</span>, <span class="num">6</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a spot point light component</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">spotLightEntity</span>, <span class="ide">newSpotPointLightComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">vec3</span>(<span class="num">0</span>) <span class="op">-</span> <span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span>, <span class="com"># Light direction</span></div></div><div class="line"><div class="line-content">    <span class="ide">color</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;aqua&quot;</span>),                            <span class="com"># Light color</span></div></div><div class="line"><div class="line-content">    <span class="ide">shadow</span><span class="op">=</span><span class="ide">false</span>,                                 <span class="com"># Casts shadow or not</span></div></div><div class="line"><div class="line-content">    <span class="ide">innerLimit</span><span class="op">=</span><span class="num">30</span>,                                <span class="com"># Inner circle of light</span></div></div><div class="line"><div class="line-content">    <span class="ide">outerLimit</span><span class="op">=</span><span class="num">90</span>                                 <span class="com"># Outer circle of light</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the new light child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">spotLightEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/spotpoint-light.gif" style="max-width: 100%;" alt="" /></p>
<h1>Access components</h1>
<p>Let us dance with light&apos;s color, to access a component we can call getComponent[T] on an entity or a component.
We add a script component to our spot light to program it:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creats spot point light entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">spotLightEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;SpotLight&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets position to (-6, 6, 6)</span></div></div><div class="line"><div class="line-content"><span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="op">-</span><span class="num">6</span>, <span class="num">6</span>, <span class="num">6</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a spot point light component</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">spotLightEntity</span>, <span class="ide">newSpotPointLightComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">vec3</span>(<span class="num">0</span>) <span class="op">-</span> <span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span>, <span class="com"># Light direction</span></div></div><div class="line"><div class="line-content">    <span class="ide">color</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;aqua&quot;</span>),                            <span class="com"># Light color</span></div></div><div class="line"><div class="line-content">    <span class="ide">shadow</span><span class="op">=</span><span class="ide">false</span>,                                 <span class="com"># Casts shadow or not</span></div></div><div class="line"><div class="line-content">    <span class="ide">innerLimit</span><span class="op">=</span><span class="num">30</span>,                                <span class="com"># Inner circle of light</span></div></div><div class="line"><div class="line-content">    <span class="ide">outerLimit</span><span class="op">=</span><span class="num">90</span>                                 <span class="com"># Outer circle of light</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a script component to spot point light entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">spotLightEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="com"># Access to point light component, if it returns nil then there is no such a component on this entity.</span></div></div><div class="line"><div class="line-content">    <span class="kwd">let</span> <span class="ide">light</span> <span class="op">=</span> <span class="ide">getComponent</span>[<span class="ide">SpotPointLightComponent</span>](<span class="ide">script</span>)</div></div><div class="line"><div class="line-content">    <span class="com"># Changes light color</span></div></div><div class="line"><div class="line-content">    <span class="ide">light</span><span class="op">.</span><span class="ide">color</span> <span class="op">=</span> <span class="ide">color</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">abs</span>(<span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)), </div></div><div class="line"><div class="line-content">        <span class="ide">abs</span>(<span class="ide">cos</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>)), </div></div><div class="line"><div class="line-content">        <span class="ide">abs</span>(<span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>) <span class="op">*</span> <span class="ide">sin</span>(<span class="ide">engine</span><span class="op">.</span><span class="ide">age</span>))</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">))</div></div><div class="line"><div class="line-content"><span class="com"># Makes the new light child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">spotLightEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/light-color-changes.gif" style="max-width: 100%;" alt="" /></p>
<p>See sample source <a href="examples/hello.nim">here</a>.</p>
<h1>Screen size</h1>
<p>By default the screen size is equal with window size, but maybe you like to have a lower resolution:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">alasgar</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates a window named Hello, and sets screen size to (160, 90)</span></div></div><div class="line"><div class="line-content"><span class="ide">screen</span>(<span class="num">160</span>, <span class="num">90</span>)</div></div><div class="line"><div class="line-content"><span class="ide">window</span>(<span class="str">&quot;Hello&quot;</span>, <span class="num">640</span>, <span class="num">360</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>You need to specify it before creating window, after window creation there is no effect.</p>
<p>  <img src="docs/files/screen-size.gif" style="max-width: 100%;" alt="" /></p>
<h1>Environment variables</h1>
<p>Environment variables are for the scene, you can manipulate scene by following effects:
- Background color
- Fog
- Ambient light
- Postprocessing effects</p>
<p>To manipluate environment variables, we create a EnvironmentComponent, set the parameters and then we add it to our scene:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates a new scene</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">scene</span> <span class="op">=</span> <span class="ide">newScene</span>()</div></div><div class="line"><div class="line-content"><span class="com"># Creates an instance of environment component</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">env</span> <span class="op">=</span> <span class="ide">newEnvironmentComponent</span>()</div></div><div class="line"><div class="line-content"><span class="com"># Sets background color to black</span></div></div><div class="line"><div class="line-content"><span class="ide">setBackground</span>(<span class="ide">env</span>, <span class="ide">parseHtmlName</span>(<span class="str">&quot;Black&quot;</span>))</div></div><div class="line"><div class="line-content"><span class="com"># Enables simple fog effect</span></div></div><div class="line"><div class="line-content"><span class="ide">enableFog</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">env</span>,                        <span class="com"># Environment instance</span></div></div><div class="line"><div class="line-content">    <span class="ide">parseHtmlName</span>(<span class="str">&quot;DimGray&quot;</span>),   <span class="com"># Fog color</span></div></div><div class="line"><div class="line-content">    <span class="num">0.01</span>,                       <span class="com"># Fog density</span></div></div><div class="line"><div class="line-content">    <span class="num">1.0</span>                         <span class="com"># Fog gredient</span></div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Sets ambient color and intensity</span></div></div><div class="line"><div class="line-content"><span class="ide">setAmbient</span>(<span class="ide">env</span>, <span class="ide">parseHtmlName</span>(<span class="str">&quot;white&quot;</span>), <span class="num">0.7</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds environment to our scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">scene</span>, <span class="ide">env</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>We will discuss postprocessing effects later on a dedicated section. You can see and example of environment variables in shadows section.</p>
<h1>Normal maps</h1>
<p>It is easy to add a normal map, we need to specify it in material component:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Adds a material to cube</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newMaterialComponent</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;white&quot;</span>),</div></div><div class="line"><div class="line-content">        <span class="ide">texture</span><span class="op">=</span><span class="ide">newTexture</span>(<span class="str">&quot;res://stone-texture.png&quot;</span>),</div></div><div class="line"><div class="line-content">        <span class="ide">normal</span><span class="op">=</span><span class="ide">newTexture</span>(<span class="str">&quot;res://stone-texture-normal.png&quot;</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/cube-normal.gif" style="max-width: 100%;" alt="" /></p>
<p>See normal sample <a href="examples/normal.nim">here</a>.</p>
<h1>Interactive objects</h1>
<p>It is nice if we can select an object with mouse or by touch on mobile platforms, let us add a InteractiveComponent to our cube:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Handles mouse hover in</span></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">onCubeHover</span>(<span class="ide">interactive</span>: <span class="ide">InteractiveComponent</span>, <span class="ide">collision</span>: <span class="ide">Collision</span>)<span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="kwd">let</span> <span class="ide">material</span> <span class="op">=</span> <span class="ide">getComponent</span>[<span class="ide">MaterialComponent</span>](<span class="ide">interactive</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">material</span><span class="op">.</span><span class="ide">diffuseColor</span> <span class="op">=</span> <span class="ide">parseHtmlName</span>(<span class="str">&quot;yellow&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Handles mouse hover out</span></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">onCubeOut</span>(<span class="ide">interactive</span>: <span class="ide">InteractiveComponent</span>)<span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="kwd">let</span> <span class="ide">material</span> <span class="op">=</span> <span class="ide">getComponent</span>[<span class="ide">MaterialComponent</span>](<span class="ide">interactive</span>)</div></div><div class="line"><div class="line-content">    <span class="ide">material</span><span class="op">.</span><span class="ide">diffuseColor</span> <span class="op">=</span> <span class="ide">parseHtmlName</span>(<span class="str">&quot;green&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates cube entity, by default position is 0, 0, 0</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Cube&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Set scale to 2</span></div></div><div class="line"><div class="line-content"><span class="ide">cubeEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">scale</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">2</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content"><span class="com"># Adds a material to cube</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newMaterialComponent</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;green&quot;</span>)</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a collision compnent to cube entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCollisionComponent</span>(<span class="ide">vec3</span>(<span class="op">-</span><span class="num">1</span>, <span class="op">-</span><span class="num">1</span>, <span class="op">-</span><span class="num">1</span>), <span class="ide">vec3</span>(<span class="num">1</span>, <span class="num">1</span>, <span class="num">1</span>)))</div></div><div class="line"><div class="line-content"><span class="com"># Adds an interactive</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">cubeEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newInteractiveComponent</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">onHover</span><span class="op">=</span><span class="ide">onCubeHover</span>,</div></div><div class="line"><div class="line-content">        <span class="ide">onOut</span><span class="op">=</span><span class="ide">onCubeOut</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>As you see, we have two functions to handle mouse&apos;s in and out (hover) functionalities. To make interactive components working, you need to add a collision component.
Alsgar supports just two types, AABB and sphere. We also changed the spot light position, stopped point light moving and set our cube diffuse color to green. It is the final result:</p>
<p>  <img src="docs/files/interactive.gif" style="max-width: 100%;" alt="" /></p>
<p>When you add interactive component, you have: onPress, onRelease, onHover, onOut and onMotion. Except onOut, all of the functions pass collision information.</p>
<p>See interactive sample <a href="examples/interactive.nim">here</a>.</p>
<h1>Shadows</h1>
<p>For now, shadows are just implemented for SpotPointLight components, also it is limited to just one light.
Let us setup our scene in a way that we can observe shadows, after setup window, scene and setting up our camera, we create a big platform:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creates platform entity, by default position is (0, 0, 0)</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">platformEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;Platform&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Set scale to 20</span></div></div><div class="line"><div class="line-content"><span class="ide">platformEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">scale</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">20</span>)</div></div><div class="line"><div class="line-content"><span class="ide">platformEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">euler</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">0</span>, <span class="num">0</span>, <span class="op">-</span><span class="ide">PI</span> <span class="op">/</span> <span class="num">2</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">platformEntity</span>, <span class="ide">newPlaneMesh</span>(<span class="num">1</span>, <span class="num">1</span>))</div></div><div class="line"><div class="line-content"><span class="com"># Adds a material to cube</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">platformEntity</span>, </div></div><div class="line"><div class="line-content">    <span class="ide">newMaterialComponent</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;grey&quot;</span>),</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">platformEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>As you see we created a plane mesh and scaled it to 20, and we rotated it as we want to see it from top. Then we make a simple function to add cubes, we need two cubes so this is our function:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">proc</span> <span class="ide">createCube</span>(<span class="ide">name</span>: <span class="ide">string</span>, <span class="ide">position</span>: <span class="ide">Vec3</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">    <span class="com"># Creates cube entity</span></div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">cubeEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="ide">name</span>)</div></div><div class="line"><div class="line-content">    <span class="com"># Positions cube to (0, 2, 0)</span></div></div><div class="line"><div class="line-content">    <span class="ide">cubeEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">position</span></div></div><div class="line"><div class="line-content">    <span class="com"># Add a cube mesh component to entity</span></div></div><div class="line"><div class="line-content">    <span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newCubeMesh</span>())</div></div><div class="line"><div class="line-content">    <span class="com"># Adds a script component to cube entity</span></div></div><div class="line"><div class="line-content">    <span class="ide">addComponent</span>(<span class="ide">cubeEntity</span>, <span class="ide">newScriptComponent</span>(<span class="kwd">proc</span>(<span class="ide">script</span>: <span class="ide">ScriptComponent</span>, <span class="ide">input</span>: <span class="ide">Input</span>, <span class="ide">delta</span>: <span class="ide">float32</span>) <span class="op">=</span></div></div><div class="line"><div class="line-content">        <span class="com"># We can rotate an object using euler also we can directly set rotation property that is a quaternion.</span></div></div><div class="line"><div class="line-content">        <span class="ide">script</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">euler</span> <span class="op">=</span> <span class="ide">vec3</span>(</div></div><div class="line"><div class="line-content">            <span class="ide">engine</span><span class="op">.</span><span class="ide">age</span> <span class="op">*</span> <span class="num">0.1</span>, </div></div><div class="line"><div class="line-content">            <span class="ide">engine</span><span class="op">.</span><span class="ide">age</span> <span class="op">*</span> <span class="num">0.3</span>, </div></div><div class="line"><div class="line-content">            <span class="ide">engine</span><span class="op">.</span><span class="ide">age</span> <span class="op">*</span> <span class="num">0.2</span>,</div></div><div class="line"><div class="line-content">        )</div></div><div class="line"><div class="line-content">    ))</div></div><div class="line"><div class="line-content">    <span class="com"># Adds a material to cube and specifies that the cube casts shadow.</span></div></div><div class="line"><div class="line-content">    <span class="ide">addComponent</span>(</div></div><div class="line"><div class="line-content">        <span class="ide">cubeEntity</span>, </div></div><div class="line"><div class="line-content">        <span class="ide">newMaterialComponent</span>(</div></div><div class="line"><div class="line-content">            <span class="ide">diffuseColor</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;grey&quot;</span>),</div></div><div class="line"><div class="line-content">            <span class="ide">castShadow</span><span class="op">=</span><span class="ide">true</span>,                    <span class="com"># Here we specify that this object casts shadow, default is false</span></div></div><div class="line"><div class="line-content">        )</div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">    <span class="com"># Makes the cube enity child of scene</span></div></div><div class="line"><div class="line-content">    <span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">cubeEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="ide">createCube</span>(<span class="str">&quot;Cube1&quot;</span>, <span class="ide">vec3</span>(<span class="num">1</span>, <span class="num">4</span>, <span class="num">0</span>))</div></div><div class="line"><div class="line-content"><span class="ide">createCube</span>(<span class="str">&quot;Cube2&quot;</span>, <span class="ide">vec3</span>(<span class="op">-</span><span class="num">4</span>, <span class="num">2</span>, <span class="num">0</span>))</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>As you see, we created two cubes in different positions. The important part is that we need to define in object material that it casts shadow.
Now we create a spot light component and we need to enable shadow for this light source:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="op">...</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Creats spot point light entity</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">spotLightEntity</span> <span class="op">=</span> <span class="ide">newEntity</span>(<span class="ide">scene</span>, <span class="str">&quot;SpotLight&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Sets position to (-6, 6, 6)</span></div></div><div class="line"><div class="line-content"><span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span> <span class="op">=</span> <span class="ide">vec3</span>(<span class="num">12</span>, <span class="num">12</span>, <span class="num">0</span>)</div></div><div class="line"><div class="line-content"><span class="com"># Adds a spot point light component</span></div></div><div class="line"><div class="line-content"><span class="ide">addComponent</span>(<span class="ide">spotLightEntity</span>, <span class="ide">newSpotPointLightComponent</span>(</div></div><div class="line"><div class="line-content">    <span class="ide">vec3</span>(<span class="num">0</span>) <span class="op">-</span> <span class="ide">spotLightEntity</span><span class="op">.</span><span class="ide">transform</span><span class="op">.</span><span class="ide">position</span>, <span class="com"># Light direction</span></div></div><div class="line"><div class="line-content">    <span class="ide">color</span><span class="op">=</span><span class="ide">parseHtmlName</span>(<span class="str">&quot;LemonChiffon&quot;</span>),          <span class="com"># Light color</span></div></div><div class="line"><div class="line-content">    <span class="ide">shadow</span><span class="op">=</span><span class="ide">true</span>,                                  <span class="com"># Enables shadow</span></div></div><div class="line"><div class="line-content">    <span class="ide">innerLimit</span><span class="op">=</span><span class="num">30</span>,                                <span class="com"># Inner circle of light</span></div></div><div class="line"><div class="line-content">    <span class="ide">outerLimit</span><span class="op">=</span><span class="num">90</span>                                 <span class="com"># Outer circle of light</span></div></div><div class="line"><div class="line-content">    )</div></div><div class="line"><div class="line-content">)</div></div><div class="line"><div class="line-content"><span class="com"># Makes the new light child of the scene</span></div></div><div class="line"><div class="line-content"><span class="ide">addChild</span>(<span class="ide">scene</span>, <span class="ide">spotLightEntity</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="op">...</span></div></div>  </code></pre>
<p>  <img src="docs/files/shadow.gif" style="max-width: 100%;" alt="" /></p>
<p>That is all, if you run shadow sample you will see the effects. I hope you also notice the artifacts, light bleeding and so on, I like them :)
Here I used variance shadow map, but this part needs many improvements specially batching is not enabled for shadow casting objects so the performance is not going to be satisfying. There are going to be many improvements in near future.</p>
<p>See shadow sample <a href="examples/shadow.nim">here</a>.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/abisxir/alasgar">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-05-01T01:22:48Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
