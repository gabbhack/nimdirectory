<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">eloverblik</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">api</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">elforbrug</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">eloverblik</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("API for www.eloverblik.dk")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install eloverblik" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>nim_eloverblik</h1>
<p>API for www.eloverblik.dk - samling af energiforbrug.</p>
<p>This is an API for the website www.eloverblik.dk, which collects energy usage from Danish energy companies.</p>
<p>You use this as an library, which you import, or you can run it as a binary. It&apos;ll get your energy usage, format it to JSON, and sends the data with MQTT.</p>
<h1>Requirements</h1>
<p>To access the API, you need to generate a <code>refreshToken</code> and your meetering point.</p>
<h2>Refresh token</h2>
<ol>
<li>Go to www.eloverblik.dk</li>
<li>Login as &quot;Privat&quot;</li>
<li>Navigate to &quot;Min profil -&gt; Datadeling&quot;</li>
<li>Generate a token and save it locally</li>
</ol>
<h2>Meetering ID</h2>
<p>You&apos;r already at www.eloverblik.dk, so now just navigate to the frontpage (https://eloverblik.dk/Customer/overview/) and copy your meetering ID - the 18 characters.</p>
<h1>Data</h1>
<p>Please be aware, that the data output comes within a time periode from 23:00-23:00 (11:00 PM): <code>&quot;start&quot;:&quot;2020-03-16T23:00:00Z&quot;,&quot;end&quot;:&quot;2020-03-17T23:00:00Z&quot;</code>.</p>
<p>Therefore the URL you are requesting look a bit strange. When you want the data from the 17th, you request needs to be from 16th to the 17th march.</p>
<p>Your URL will be: <code>https://api.eloverblik.dk/CustomerApi/api/MeterData/GetTimeSeries/2020-03-17/2020-03-18/Year</code></p>
<p>Furthermore the datahub is updated 1 day to slow, which has the draw down, that you can&apos;t get yesterdays usage.</p>
<h1>Usage</h1>
<p>You have to copy the <code>config_default.cfg</code> to <code>config.cfg</code> and adjust the options.</p>
<h2>Home Assistant (Hass.io)</h2>
<p>The original purpose of this API was to enable an overview in HA. So running the API as a binary, it&apos;ll sends the stats everyday to HA, and you can visualize them - e.g. using mini-graph (HACS plugin).</p>
<p>3 entities will automatic be added to Home assistant: Daily usage (<code>sensor.elforbrug_day</code>), Weekly usage (<code>sensor.elforbrug_week</code>) and Monthly usage (<code>sensor.elforbrug_month</code>). If you <strong>dont</strong> want the automatic creating of sensors, set the <code>autoDiscover=false</code> and follow the guide below with Node red.</p>
<p>A birth message is also supported - if Hass restarts, the config needs to be resend, otherwise the sensor will be inactive. You can setup a birth topic and birth payload inside Hass, which will be send on each boot - we are using that payload to resend the sensors configuration.</p>
<p>You only need to update the <code>config.cfg</code> with details on below the fields <code>[MQTT]</code>, <code>[Eloverblik]</code> and <code>[Hassio]</code>. The topic in <code>[MQTT]</code> will not be used, if you are using the autoDiscovery function.</p>
<p>  <del>Buuuut, you might want to use Node red to do the automation. You either follow the steps below to create the flow, or you can copy and paste the predefined flow. After that generate a graph with mini-graph in Lovelace and enjoy.</del></p>
<p><del>You need to let the program run, cause it&apos;ll gather the data once a day - set the time in the `config.cfg`. A good choice would be 23:30 - the data is updated around 23:00.</del> This was quite annoying while testing, so now the api just runs every half hour. If there&apos;s no changes, nothing is send to HA with MQTT.</p>
<h3>Auto run</h3>
<p>First compile the file:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">nim</span> <span class="ide">c</span> <span class="op">-</span><span class="ide">d</span>:<span class="ide">ssl</span> <span class="op">-</span><span class="ide">d</span>:<span class="ide">release</span> <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">nim</span></div></div>  </code></pre>
<p>Then edit the config file:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">cp</span> <span class="ide">config</span><span class="op">/</span><span class="ide">config_default</span><span class="op">.</span><span class="ide">cfg</span> <span class="ide">config</span><span class="op">/</span><span class="ide">config</span><span class="op">.</span><span class="ide">cfg</span></div></div><div class="line"><div class="line-content"><span class="ide">nano</span> <span class="ide">config</span><span class="op">/</span><span class="ide">config</span><span class="op">.</span><span class="ide">cfg</span></div></div>  </code></pre>
<p>Now adjust the service file and deploy:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">nano</span> <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">service</span></div></div><div class="line"><div class="line-content"><span class="ide">sudo</span> <span class="ide">cp</span> <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">service</span> <span class="op">/</span><span class="ide">etc</span><span class="op">/</span><span class="ide">systemd</span><span class="op">/</span><span class="ide">system</span><span class="op">/</span><span class="ide">eloverblik</span><span class="op">.</span><span class="ide">service</span></div></div><div class="line"><div class="line-content"><span class="ide">sudo</span> <span class="ide">systemctl</span> <span class="ide">enable</span> <span class="ide">eloverblik</span></div></div><div class="line"><div class="line-content"><span class="ide">sudo</span> <span class="ide">systemctl</span> <span class="ide">start</span> <span class="ide">eloverblik</span></div></div><div class="line"><div class="line-content"><span class="ide">sudo</span> <span class="ide">systemctl</span> <span class="ide">status</span> <span class="ide">eloverblik</span></div></div>  </code></pre>
<h3>Node red</h3>
<p>  <strong>ONLY DO THIS IF YOU HAVE DISABLED AUTODISCOVERY</strong></p>
<p>We are making 3 nodes for: Daily usage, Weekly usage, Monthly usage.</p>
<ul>
<li>MQTT-in node - convert to JSON object</li>
<li>HA entity node (monthl) - set state to:</li>
<li>HA entity node (week) - set state to:</li>
<li>HA entity node (day) - set state to:</li>
</ul>
<details><summary>Node red JSON code</summary>
<pre>  <code class="language-json">[
    {
        &quot;id&quot;: &quot;5ea40d22.fd6134&quot;,
        &quot;type&quot;: &quot;mqtt in&quot;,
        &quot;z&quot;: &quot;f9f7e30c.acb0a&quot;,
        &quot;name&quot;: &quot;&quot;,
        &quot;topic&quot;: &quot;eloverblik&quot;,
        &quot;qos&quot;: &quot;2&quot;,
        &quot;datatype&quot;: &quot;json&quot;,
        &quot;broker&quot;: &quot;6e85e811.77a988&quot;,
        &quot;x&quot;: 160,
        &quot;y&quot;: 220,
        &quot;wires&quot;: [
            [
                &quot;875fd707.470408&quot;,
                &quot;3f11ef06.a67ae&quot;,
                &quot;37c6eb5c.e52be4&quot;
            ]
        ]
    },
    {
        &quot;id&quot;: &quot;875fd707.470408&quot;,
        &quot;type&quot;: &quot;ha-entity&quot;,
        &quot;z&quot;: &quot;f9f7e30c.acb0a&quot;,
        &quot;name&quot;: &quot;Eloverblik Month&quot;,
        &quot;server&quot;: &quot;b95e3a52.453dc8&quot;,
        &quot;version&quot;: 1,
        &quot;debugenabled&quot;: true,
        &quot;outputs&quot;: 1,
        &quot;entityType&quot;: &quot;sensor&quot;,
        &quot;config&quot;: [
            {
                &quot;property&quot;: &quot;name&quot;,
                &quot;value&quot;: &quot;eloverblik_month&quot;
            },
            {
                &quot;property&quot;: &quot;device_class&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;icon&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;unit_of_measurement&quot;,
                &quot;value&quot;: &quot;&quot;
            }
        ],
        &quot;state&quot;: &quot;payload.eloverblik.month.0.usage&quot;,
        &quot;stateType&quot;: &quot;msg&quot;,
        &quot;attributes&quot;: [
            {
                &quot;property&quot;: &quot;start&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.month.0.start&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            },
            {
                &quot;property&quot;: &quot;end&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.month.0.end&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            }
        ],
        &quot;resend&quot;: true,
        &quot;outputLocation&quot;: &quot;&quot;,
        &quot;outputLocationType&quot;: &quot;none&quot;,
        &quot;inputOverride&quot;: &quot;allow&quot;,
        &quot;x&quot;: 450,
        &quot;y&quot;: 160,
        &quot;wires&quot;: [
            []
        ]
    },
    {
        &quot;id&quot;: &quot;3f11ef06.a67ae&quot;,
        &quot;type&quot;: &quot;ha-entity&quot;,
        &quot;z&quot;: &quot;f9f7e30c.acb0a&quot;,
        &quot;name&quot;: &quot;Eloverblik Week&quot;,
        &quot;server&quot;: &quot;b95e3a52.453dc8&quot;,
        &quot;version&quot;: 1,
        &quot;debugenabled&quot;: true,
        &quot;outputs&quot;: 1,
        &quot;entityType&quot;: &quot;sensor&quot;,
        &quot;config&quot;: [
            {
                &quot;property&quot;: &quot;name&quot;,
                &quot;value&quot;: &quot;eloverblik_week&quot;
            },
            {
                &quot;property&quot;: &quot;device_class&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;icon&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;unit_of_measurement&quot;,
                &quot;value&quot;: &quot;&quot;
            }
        ],
        &quot;state&quot;: &quot;payload.eloverblik.week.0.usage&quot;,
        &quot;stateType&quot;: &quot;msg&quot;,
        &quot;attributes&quot;: [
            {
                &quot;property&quot;: &quot;start&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.week.0.start&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            },
            {
                &quot;property&quot;: &quot;end&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.week.0.end&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            }
        ],
        &quot;resend&quot;: true,
        &quot;outputLocation&quot;: &quot;&quot;,
        &quot;outputLocationType&quot;: &quot;none&quot;,
        &quot;inputOverride&quot;: &quot;allow&quot;,
        &quot;x&quot;: 440,
        &quot;y&quot;: 220,
        &quot;wires&quot;: [
            []
        ]
    },
    {
        &quot;id&quot;: &quot;37c6eb5c.e52be4&quot;,
        &quot;type&quot;: &quot;ha-entity&quot;,
        &quot;z&quot;: &quot;f9f7e30c.acb0a&quot;,
        &quot;name&quot;: &quot;Eloverblik Day&quot;,
        &quot;server&quot;: &quot;b95e3a52.453dc8&quot;,
        &quot;version&quot;: 1,
        &quot;debugenabled&quot;: true,
        &quot;outputs&quot;: 1,
        &quot;entityType&quot;: &quot;sensor&quot;,
        &quot;config&quot;: [
            {
                &quot;property&quot;: &quot;name&quot;,
                &quot;value&quot;: &quot;eloverblik_day&quot;
            },
            {
                &quot;property&quot;: &quot;device_class&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;icon&quot;,
                &quot;value&quot;: &quot;&quot;
            },
            {
                &quot;property&quot;: &quot;unit_of_measurement&quot;,
                &quot;value&quot;: &quot;&quot;
            }
        ],
        &quot;state&quot;: &quot;payload.eloverblik.day.0.usage&quot;,
        &quot;stateType&quot;: &quot;msg&quot;,
        &quot;attributes&quot;: [
            {
                &quot;property&quot;: &quot;start&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.day.0.start&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            },
            {
                &quot;property&quot;: &quot;end&quot;,
                &quot;value&quot;: &quot;payload.eloverblik.day.0.end&quot;,
                &quot;valueType&quot;: &quot;msg&quot;
            }
        ],
        &quot;resend&quot;: true,
        &quot;outputLocation&quot;: &quot;&quot;,
        &quot;outputLocationType&quot;: &quot;none&quot;,
        &quot;inputOverride&quot;: &quot;allow&quot;,
        &quot;x&quot;: 440,
        &quot;y&quot;: 280,
        &quot;wires&quot;: [
            []
        ]
    },
    {
        &quot;id&quot;: &quot;6e85e811.77a988&quot;,
        &quot;type&quot;: &quot;mqtt-broker&quot;,
        &quot;z&quot;: &quot;&quot;,
        &quot;name&quot;: &quot;Main MQTT&quot;,
        &quot;broker&quot;: &quot;192.168.1.100&quot;,
        &quot;port&quot;: &quot;1883&quot;,
        &quot;clientid&quot;: &quot;noderedmqtt&quot;,
        &quot;usetls&quot;: false,
        &quot;compatmode&quot;: false,
        &quot;keepalive&quot;: &quot;60&quot;,
        &quot;cleansession&quot;: true,
        &quot;birthTopic&quot;: &quot;&quot;,
        &quot;birthQos&quot;: &quot;0&quot;,
        &quot;birthPayload&quot;: &quot;&quot;,
        &quot;closeTopic&quot;: &quot;&quot;,
        &quot;closeQos&quot;: &quot;0&quot;,
        &quot;closePayload&quot;: &quot;&quot;,
        &quot;willTopic&quot;: &quot;&quot;,
        &quot;willQos&quot;: &quot;0&quot;,
        &quot;willPayload&quot;: &quot;&quot;
    },
    {
        &quot;id&quot;: &quot;b95a2a52.433dc8&quot;,
        &quot;type&quot;: &quot;server&quot;,
        &quot;z&quot;: &quot;&quot;,
        &quot;name&quot;: &quot;Home Assistant&quot;,
        &quot;legacy&quot;: false,
        &quot;addon&quot;: true,
        &quot;rejectUnauthorizedCerts&quot;: true,
        &quot;ha_boolean&quot;: &quot;y|yes|true|on|home|open&quot;,
        &quot;connectionDelay&quot;: true,
        &quot;cacheJson&quot;: true
    }
]
</code></pre>
</details>
<h3>MQTT messages</h3>
<p>The ouput will be like:</p>
<pre>  <code class="language-json">{
   &quot;eloverblik&quot;:{
     // Data from February 1st to February the 29
      &quot;month&quot;:[
         {
            &quot;start&quot;:&quot;2020-01-31T23:00:00Z&quot;,
            &quot;end&quot;:&quot;2020-02-29T23:00:00Z&quot;,
            &quot;usage&quot;:&quot;114.62&quot;,
            &quot;unit&quot;:&quot;KWH&quot;
         }
      ],
      // Data from Monday 9 to Sunday the 15
      &quot;week&quot;:[
         {
            &quot;start&quot;:&quot;2020-03-08T23:00:00Z&quot;,
            &quot;end&quot;:&quot;2020-03-15T23:00:00Z&quot;,
            &quot;usage&quot;:&quot;44.55&quot;,
            &quot;unit&quot;:&quot;KWH&quot;
         }
      ],
      // Data from Tuesday the 17th
      &quot;day&quot;:[
         {
            &quot;start&quot;:&quot;2020-03-16T23:00:00Z&quot;,
            &quot;end&quot;:&quot;2020-03-17T23:00:00Z&quot;,
            &quot;usage&quot;:&quot;5.99&quot;,
            &quot;unit&quot;:&quot;KWH&quot;
         }
      ]
   }
}
</code></pre>
<h2>Nim library</h2>
<p>Import eloverblik, set the types and call <code>eloverblikTimeSeries()</code>:</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="ide">eloverblikLoadData</span>() <span class="com"># Loads the data from the config.cfg</span></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">result</span> <span class="op">=</span> <span class="ide">eloverblikTimeSeries</span>(<span class="ide">eloverblik</span>, <span class="ide">elperiode</span>)</div></div>  </code></pre>
<p>You do not need to fill out the MQTT in the <code>config.cfg</code> file.</p>
<p><strong>IMPORTANT:</strong> You should set the <code>autoDiscovery=false</code>, since that will publish MQTT-messages specific for Home Assistant.</p>
<h3>Options</h3>
<p>The 2 data options in the config is <code>daysBack</code> and <code>daysSpecific</code>. For both these options you have to specify an aggregation.
For aggregation you can use <code>Actual | Quarter | Hour | Day | Month | Year</code>. If the aggregation is higher than the periode you are specifying, you&apos;ll get 1 result containing the whole usage.</p>
<p>You can use both of these options or have multiple dates in both of them - split the dates with a <code>;</code>.</p>
<p>I could look like:</p>
<pre>  <code class="language-config">daysBack = &quot;1;7;365&quot;
aggregationBack = &quot;Hour;Day;Month&quot;

daysSpecific = &quot;2020-01-01,2020-03-01&quot; # 2020-01-01,2020-02-01;2020-02-01,2020-03-01
aggregationSpecific = &quot;Month&quot; # Month;Day
</code></pre>
<h3>Predefined calls</h3>
<p>Do you prefer the data returned to Home Assistant? You can use the same predefined calls, which returns the last mont, week and day.</p>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">url</span>  <span class="op">=</span> <span class="ide">datesPredefined</span>(<span class="ide">mainPeriode</span>, <span class="ide">howLongBack</span>, <span class="str">&quot;Year&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="com"># mainPeriode = Month, Week or Day</span></div></div><div class="line"><div class="line-content"><span class="com"># howLongBack = How many months, weeks or days back, you want to see</span></div></div>  </code></pre>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="com"># The Year in aggregation is used to ensure, that data from the periode is used</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">monthUrl</span>  <span class="op">=</span> <span class="ide">datesPredefined</span>(<span class="str">&quot;Month&quot;</span>, <span class="num">1</span>, <span class="str">&quot;Year&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">month</span>     <span class="op">=</span> <span class="ide">requestData</span>(<span class="ide">actualToken</span>, <span class="str">&quot;month&quot;</span>, <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">meeteringPoint</span>, <span class="ide">monthUrl</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">weekUrl</span>   <span class="op">=</span> <span class="ide">datesPredefined</span>(<span class="str">&quot;Week&quot;</span>, <span class="num">1</span>, <span class="str">&quot;Year&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">week</span>      <span class="op">=</span> <span class="ide">requestData</span>(<span class="ide">actualToken</span>, <span class="str">&quot;week&quot;</span>, <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">meeteringPoint</span>, <span class="ide">weekUrl</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">dayUrl</span>    <span class="op">=</span> <span class="ide">datesPredefined</span>(<span class="str">&quot;Day&quot;</span>, <span class="num">1</span>, <span class="str">&quot;Year&quot;</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">let</span> <span class="ide">day</span>       <span class="op">=</span> <span class="ide">requestData</span>(<span class="ide">actualToken</span>, <span class="str">&quot;day&quot;</span>, <span class="ide">eloverblik</span><span class="op">.</span><span class="ide">meeteringPoint</span>, <span class="ide">dayUrl</span>)</div></div>  </code></pre>
<h1>More</h1>
<p>You can read more about the API the pdf <code>100120 Customer and Third party API for Datahub Eloverblik  Technical description.pdf</code>.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://github.com/ThomasTJdev/nim_eloverblik_api">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-06-02T01:43:10Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
