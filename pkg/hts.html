<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nim Package Directory</title>
  <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="New and updated Nim packages" href="https://nimble.directory/packages.xml">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlite.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  <script type="text/javascript" src="/js/app.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container">
    <a href="/" class="logo fw-500 display-1 text-black text-decoration-none navbar-brand"></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item mx-2">
          <a href="https://nim-lang.org/" class="nav-link">What's Nim?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="/about.html" class="nav-link">What's Nimble?</a>
        </li>
        <li class="nav-item mx-2">
          <a href="https://github.com/nim-lang/packages/" class="nav-link">Publish your package</a>
        </li>
        <!-- TODO: replace with something different -->
        <li class="nav-item ms-3">
          <a class="nav-link" href="https://www.youtube.com/channel/UCDAYn_VFt0VisL5-1a5Dk7Q/">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
          </a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link theme-switcher-btn" id="darkmode" onclick="toggle_dark_mode()" href="#">
            <span id="light-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </span>
            <span id="dark-mode-icon">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="content">
  <div class="container">
    <div class="container pt-10">
        <h3 class="mb-3 fw-bold display-6 pt-4">hts</h3>
        <p class="tags">
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">kmer</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">dna</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">sequence</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">bam</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">vcf</button></a>
                </span>
            
                <span class="tag">
                    <button class="btn-tag pkg-btn-tag">genomics</button></a>
                </span>
            
        </p>
        <p class="pkg-desc">some("htslib wrapper for nim")</p>
        <a title="Copy" onclick="document.querySelector('#cmd').select();document.execCommand('copy');"
            alt="Copy on clipboard">
            <i class="fa fa-copy"></i>
        </a>
        <input id="cmd" onclick="this.select();" value="nimble install hts" readonly="">
        <br>
        <small style="font-size: 0.8rem;">Need help? Read <a
                href="https://github.com/nim-lang/nimble#creating-packages">Nimble</a></small>
    </div>

    <div class="container row pt-4" id="pkg-content">
        <div class="col-8 box rounded p-3" id="readme-section">
            
                <document><h1>hts-nim</h1>
<h4>
v0.2.23 of hts-nim will be the last version that supports htslib below 1.10 (which was release in early december 2019).
The master branch requires htslib 1.10 and higher and will be backward incompatible with previous releases.
</h4>
<p><a href="https://brentp.github.io/hts-nim/">  <img src="https://img.shields.io/badge/docs-latest-blue.svg" style="max-width: 100%;" alt="badge" /></a> <a href="https://travis-ci.com/brentp/hts-nim">  <img src="https://travis-ci.com/brentp/hts-nim.svg?branch=master" style="max-width: 100%;" alt="Build Status" /></a></p>
<p>This is a wrapper for <a href="https://github.com/samtools/htslib">htslib</a> in <a href="https://nim-lang.org">nim</a>.</p>
<p>Nim is a fast, garbage-collected language that compiles to C and has a syntax that&apos;s not
too different to python.</p>
<p>If you use this library, please cite <a href="https://academic.oup.com/bioinformatics/advance-article-abstract/doi/10.1093/bioinformatics/bty358/4990493">the paper</a></p>
<p>Projects using <code>hts-nim</code> are accumulating <a href="https://github.com/brentp/hts-nim/wiki/Example-uses-of-hts-nim">in the wiki</a></p>
<h2>Installation</h2>
<p>See Section Below</p>
<h1>Usage</h1>
<p>Examples of <code>hts-nim</code> tools are available in the <a href="https://github.com/brentp/hts-nim-tools">hts-nim-tools repo</a></p>
<p>below are examples of the syntax in this library see the <a href="https://brentp.github.io/hts-nim/">docs</a> for more info:</p>
<p>Also see examples and other repos using hts-nim in the <a href="https://github.com/brentp/hts-nim/wiki/Example-uses-of-hts-nim">wiki</a></p>
<h2>BAM / CRAM / SAM</h2>
<h4>See API docs <a href="https://brentp.github.io/hts-nim/hts/bam.html">here</a></h4>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">hts</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># open a bam/cram and look for the index.</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">b</span>:<span class="ide">Bam</span></div></div><div class="line"><div class="line-content"><span class="ide">open</span>(<span class="ide">b</span>, <span class="str">&quot;tests/HG02002.bam&quot;</span>, <span class="ide">index</span><span class="op">=</span><span class="ide">true</span>, <span class="ide">fai</span><span class="op">=</span><span class="str">&quot;/data/human/g1k_v37_decoy.fa&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">record</span> <span class="kwd">in</span> <span class="ide">b</span>:</div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">record</span><span class="op">.</span><span class="ide">mapping_quality</span> <span class="op">&gt;</span> <span class="num">10</span><span class="ide">u</span>:</div></div><div class="line"><div class="line-content">    <span class="ide">echo</span> <span class="ide">record</span><span class="op">.</span><span class="ide">chrom</span>, <span class="ide">record</span><span class="op">.</span><span class="ide">start</span>, <span class="ide">record</span><span class="op">.</span><span class="ide">stop</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># regional queries:</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">record</span> <span class="kwd">in</span> <span class="ide">b</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;6&quot;</span>, <span class="num">30816675</span>, <span class="num">32816675</span>):</div></div><div class="line"><div class="line-content">  <span class="kwd">if</span> <span class="ide">record</span><span class="op">.</span><span class="ide">flag</span><span class="op">.</span><span class="ide">proper_pair</span> <span class="kwd">and</span> <span class="ide">record</span><span class="op">.</span><span class="ide">flag</span><span class="op">.</span><span class="ide">reverse</span>:</div></div><div class="line"><div class="line-content">    <span class="com"># cigar is an iterable of operations:</span></div></div><div class="line"><div class="line-content">    <span class="kwd">for</span> <span class="ide">op</span> <span class="kwd">in</span> <span class="ide">record</span><span class="op">.</span><span class="ide">cigar</span>:</div></div><div class="line"><div class="line-content">      <span class="com"># $op gives the string repr of the operation, e.g. &apos;151M&apos;</span></div></div><div class="line"><div class="line-content">      <span class="ide">echo</span> <span class="op">$</span><span class="ide">op</span>, <span class="str">&quot; &quot;</span>, <span class="ide">op</span><span class="op">.</span><span class="ide">consumes</span><span class="op">.</span><span class="ide">reference</span>, <span class="str">&quot; &quot;</span>, <span class="ide">op</span><span class="op">.</span><span class="ide">consumes</span><span class="op">.</span><span class="ide">query</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">    <span class="com"># tags are pulled by type `ta`</span></div></div><div class="line"><div class="line-content">    <span class="kwd">var</span> <span class="ide">mismatches</span> <span class="op">=</span> <span class="ide">tag</span>[<span class="ide">int</span>](<span class="ide">record</span>, <span class="str">&quot;NM&quot;</span>)</div></div><div class="line"><div class="line-content">    <span class="kwd">if</span> <span class="kwd">not</span> <span class="ide">mismatches</span><span class="op">.</span><span class="ide">isNone</span> <span class="kwd">and</span> <span class="ide">mismatches</span><span class="op">.</span><span class="ide">get</span> <span class="op">&lt;</span> <span class="num">3</span>:</div></div><div class="line"><div class="line-content">      <span class="kwd">var</span> <span class="ide">rg</span> <span class="op">=</span> <span class="ide">tag</span>[<span class="ide">string</span>](<span class="ide">record</span>, <span class="str">&quot;RG&quot;</span>)</div></div><div class="line"><div class="line-content">      <span class="kwd">if</span> <span class="kwd">not</span> <span class="ide">rg</span><span class="op">.</span><span class="ide">isNone</span>: <span class="ide">echo</span> <span class="ide">rg</span><span class="op">.</span><span class="ide">get</span></div></div>  </code></pre>
<h2>VCF / BCF</h2>
<h4>See API docs <a href="https://brentp.github.io/hts-nim/hts/vcf.html">here</a></h4>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">hts</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">tsamples</span> <span class="op">=</span> <span class="op">@</span>[<span class="str">&quot;101976-101976&quot;</span>, <span class="str">&quot;100920-100920&quot;</span>, <span class="str">&quot;100231-100231&quot;</span>, <span class="str">&quot;100232-100232&quot;</span>, <span class="str">&quot;100919-100919&quot;</span>]</div></div><div class="line"><div class="line-content"><span class="com"># VCF and BCF supported</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">v</span>:<span class="ide">VCF</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span>(<span class="ide">open</span>(<span class="ide">v</span>, <span class="str">&quot;tests/test.bcf&quot;</span>, <span class="ide">samples</span><span class="op">=</span><span class="ide">tsamples</span>))</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">afs</span> <span class="op">=</span> <span class="ide">new_seq</span>[<span class="ide">float32</span>](<span class="num">5</span>) <span class="com"># size doesn&apos;t matter. this will be re-sized as needed</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">acs</span> <span class="op">=</span> <span class="ide">new_seq</span>[<span class="ide">int32</span>](<span class="num">5</span>) <span class="com"># size doesn&apos;t matter. this will be re-sized as needed</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">csq</span> <span class="op">=</span> <span class="ide">new_string_of_cap</span>(<span class="num">20</span>)</div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">rec</span> <span class="kwd">in</span> <span class="ide">v</span>:</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">rec</span>, <span class="str">&quot; qual:&quot;</span>, <span class="ide">rec</span><span class="op">.</span><span class="ide">QUAL</span>, <span class="str">&quot; filter:&quot;</span>, <span class="ide">rec</span><span class="op">.</span><span class="ide">FILTER</span></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">info</span> <span class="op">=</span> <span class="ide">rec</span><span class="op">.</span><span class="ide">info</span></div></div><div class="line"><div class="line-content">  <span class="com"># accessing stuff from the INFO field is meant to be as fast as possible, allowing</span></div></div><div class="line"><div class="line-content">  <span class="com"># the user to re-use memory as needed.</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">info</span><span class="op">.</span><span class="ide">get</span>(<span class="str">&quot;CSQ&quot;</span>, <span class="ide">csq</span>) <span class="op">==</span> <span class="ide">Status</span><span class="op">.</span><span class="ide">OK</span> <span class="com"># string</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">info</span><span class="op">.</span><span class="ide">get</span>(<span class="str">&quot;AC&quot;</span>, <span class="ide">acs</span>) <span class="op">==</span> <span class="ide">Status</span><span class="op">.</span><span class="ide">OK</span> <span class="com"># ints</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">info</span><span class="op">.</span><span class="ide">get</span>(<span class="str">&quot;AF&quot;</span>, <span class="ide">afs</span>) <span class="op">==</span> <span class="ide">Status</span><span class="op">.</span><span class="ide">OK</span> <span class="com"># floats</span></div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">acs</span>, <span class="ide">afs</span>, <span class="ide">csq</span>, <span class="ide">info</span><span class="op">.</span><span class="ide">has_flag</span>(<span class="str">&quot;IN_EXAC&quot;</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content">  <span class="com"># accessing format fields is similar</span></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">dps</span> <span class="op">=</span> <span class="ide">new_seq</span>[<span class="ide">int32</span>](<span class="ide">len</span>(<span class="ide">v</span><span class="op">.</span><span class="ide">samples</span>))</div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">rec</span><span class="op">.</span><span class="ide">format</span><span class="op">.</span><span class="ide">get</span>(<span class="str">&quot;DP&quot;</span>, <span class="ide">dps</span>) <span class="op">==</span> <span class="ide">Status</span><span class="op">.</span><span class="ide">OK</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># open a VCF for writing</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">wtr</span>:<span class="ide">VCF</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span>(<span class="ide">open</span>(<span class="ide">wtr</span>, <span class="str">&quot;tests/outv.vcf&quot;</span>, <span class="ide">mode</span><span class="op">=</span><span class="str">&quot;w&quot;</span>))</div></div><div class="line"><div class="line-content"><span class="ide">wtr</span><span class="op">.</span><span class="ide">header</span> <span class="op">=</span> <span class="ide">v</span><span class="op">.</span><span class="ide">header</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span>(<span class="ide">wtr</span><span class="op">.</span><span class="ide">write_header</span>())</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># regional queries look for index. works for VCF and BCF</span></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">rec</span> <span class="kwd">in</span> <span class="ide">v</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;1:15600-18250&quot;</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">rec</span><span class="op">.</span><span class="ide">CHROM</span>, <span class="str">&quot;:&quot;</span>, <span class="op">$</span><span class="ide">rec</span><span class="op">.</span><span class="ide">POS</span></div></div><div class="line"><div class="line-content">  <span class="com"># adjust some values in the INFO</span></div></div><div class="line"><div class="line-content">  <span class="kwd">var</span> <span class="ide">val</span> <span class="op">=</span> <span class="num">22.3</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">rec</span><span class="op">.</span><span class="ide">info</span><span class="op">.</span><span class="ide">set</span>(<span class="str">&quot;VQSLOD&quot;</span>, <span class="ide">val</span>) <span class="op">==</span> <span class="ide">Status</span><span class="op">.</span><span class="ide">OK</span></div></div><div class="line"><div class="line-content">  <span class="ide">doAssert</span> <span class="ide">wtr</span><span class="op">.</span><span class="ide">write_variant</span>(<span class="ide">rec</span>)</div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="com"># Generate index files - .vcf.gz (tbi + csi ) &amp; .bcf (csi)</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">fnameInNew</span> <span class="op">=</span> <span class="str">&quot;tests/test.bcf&quot;</span></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">fnameIndexCsi</span> <span class="op">=</span> <span class="str">&quot;tests/test00.bcf.csi&quot;</span></div></div><div class="line"><div class="line-content"><span class="ide">bcfBuildIndex</span>(<span class="ide">fnameInNew</span>, <span class="ide">fnameIndexCsi</span>, <span class="ide">true</span>) <span class="com"># `true` for csi and `false` for tbi</span></div></div>  </code></pre>
<h2>TSV files</h2>
<pre>  <code class="language-nim"><div class="line"><div class="line-content"><span class="kwd">import</span> <span class="ide">hts</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">var</span> <span class="ide">b</span>: <span class="ide">BGZI</span></div></div><div class="line"><div class="line-content"><span class="ide">doAssert</span> <span class="ide">b</span><span class="op">.</span><span class="ide">open</span>(<span class="str">&quot;ti.txt.gz&quot;</span>)  <span class="com"># Requires a CSI index: ti.txt.gz.csi</span></div></div><div class="line"><div class="line-content"></div></div><div class="line"><div class="line-content"><span class="kwd">for</span> <span class="ide">reg</span> <span class="kwd">in</span> <span class="ide">b</span><span class="op">.</span><span class="ide">query</span>(<span class="str">&quot;aaa&quot;</span>, <span class="num">1</span>, <span class="num">5</span>):</div></div><div class="line"><div class="line-content">  <span class="ide">echo</span> <span class="ide">reg</span></div></div>  </code></pre>
<h2>Setup / Installation</h2>
<p><code>hts-nim</code> requires that <a href="https://github.com/samtools/htslib">htslib</a> is installed and the shared library is available
(use <code>LD_LIBRARY_PATH</code> if it is not in a standard location).</p>
<p>If you use docker, you can use one of <a href="https://hub.docker.com/r/nimlang/nim/">these images</a> to get Nim installed.</p>
<p>Or you can copy the <a href="https://github.com/brentp/hts-nim/blob/master/Dockerfile">Dockerfile from this repo</a></p>
<p>If you don&apos;t use docker, you can use <a href="https://github.com/dom96/choosenim">choosenim</a> to quickly install Nim and nimble.</p>
<p>Users can also either follow or run <a href="https://github.com/brentp/hts-nim/blob/master/scripts/simple-install.sh">scripts/simple-install.sh</a> which sets up Nim and nimble ready for use and shows the needed adjustments to <code>$PATH</code>.</p>
<p>Once Nim is set up, <code>hts-nim</code> can be installed with <code>nimble install -y</code> from the root of this repository.</p>
<p>In all cases, it&apos;s recommended to use nim version 0.18.0 or more recent.</p>
<p>Then, from this repo you can run <code>nimble test</code> and <code>nimble install</code> and then you can save the above snippets into <code>some.nim</code>
and run them with <code>nim c -d:release -r some.nim</code>. This will run them and save an executable named <code>some</code>.</p>
<h2>Static Builds</h2>
<p><code>hts-nim</code> is meant to simplify and speed development and distribution. To that end, there is some machinery to help create
truly static binaries for linux from nim-projects and for simple nim scripts. This means that there is no dependency on libhts.so. These builds only require docker and <a href="https://github.com/brentp/hts-nim/releases/download/v0.2.8/hts_nim_static_builder">this static binary</a>.</p>
<p>For a single file application that does not have a nimble file we can specify the dependencies using <code>--deps</code>:</p>
<pre>  <code>hts_nim_static_builder -s vcf_cleaner.nim --deps &quot;hts@&gt;=0.2.7&quot; --deps &quot;binaryheap&quot;
</code></pre>
<p>This will create a static binary at <code>./vcf_cleaner</code>.</p>
<p>Projects with <code>.nimble</code> files can use that directly to indicate dependencies.
For example, to build <a href="https://github.com/brentp/slivar">slivar</a>, we can do:</p>
<pre>  <code>hts_nim_static_builder -s ../slivar/src/slivar.nim -n ../slivar/slivar.nimble
</code></pre>
<p>After this finishes, a static <code>slivar</code> binary will appear in the current working directory.</p>
<p>We can verify that it is static using:</p>
<pre>  <code>$ file ./slivar 
./slivar: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.18, BuildID[sha1]=c2b5b52cb7be7f81bf90355a4e44a08a08df91d8, not stripped
</code></pre>
<p>The <a href="https://hub.docker.com/r/brentp/musl-hts-nim">docker image</a> is based on alpine linux and uses musl to create truly static binaries.
At this time, libcurl is not supported so only binaries built using this method will only be able to access local files (no http/https/s3/gcs).</p>
<p>The docker images does use <a href="https://github.com/ebiggers/libdeflate">libdeflate</a> by default. That provides,
for example, a 20% speed improvement when used to build <a href="https://github.com/brentp/mosdepth">mosdepth</a>.</p>
<h3>Static binary with singularity</h3>
<p>The default static build setup uses docker on linux. This is not possible on some clusters. To build a project using singularity, use something like this:</p>
<pre>  <code>singularity run \
        --bind $(pwd):/load \
        --bind /scratch \
        --bind /uufs \
            &apos;docker://brentp/musl-hts-nim:latest&apos; /usr/local/bin/nsb -n slivar.nimble -s src/slivar.nim -- -d:danger -d:release
</code></pre>
<p>where the first <code>bind</code> is required as-is. The other binds can be modified to adjust which paths on the machine need to be available to access all
local source files. This command will create a <code>slivar</code> executable in <code>pwd</code>.
Then, replace <code>slivar.nimble</code> with your nimble file and <code>src/slivar.nim</code> with your main source file.
It&apos;s also sometimes useful to replace <code>-d:danger -d:release</code> with <code>-d:debug</code> to get a debug build.</p>
</document>
            
        </div>
        <div class="col-3" id="meta-section">
            <div class="container box rounded p-3">
                
                    <p>
                        <strong>Licence:</strong>
                        MIT
                    </p>
                

                
                    <p> <a href="https://brentp.github.io/hts-nim/">Project website</a> </p>
                

                
            </div>
        </div>
    </div>
</div>
</div>

<footer class="pt-10 px-3">
  <div class="container pt-4">
    <div class="row mb-4">
      <div class="col-lg-3">
        <h4 class="h5">Getting started with Nim</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://learnxinyminutes.com/docs/nim/">Learn Nim in 5 minutes</a></li>
          <li><a class="text-decoration-none" href="https://nim-by-example.github.io/">Nim by Example</a></li>
          <li><a class="text-decoration-none" href="https://play.nim-lang.org/">Official Playground</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Official Tutorials</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut1.html">General Tutorial</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut2.html">Advanced Features</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tut3.html">Macros and Metaprogramming</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Nim for...</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-C-programmers">C programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-Python-Programmers">Python programmers</a></li>
          <li><a class="text-decoration-none" href="https://github.com/nim-lang/Nim/wiki/Nim-for-TypeScript-Programmers">TypeScript programmers</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h4 class="h5">Documentation</h4>
        <ul>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/lib.html">Standard Library</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/manual.html">Language Manual</a></li>
          <li><a class="text-decoration-none" href="https://nim-lang.org/docs/tools.html">Tools Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12 text-center mt-4 mx-auto">
        <a href="#" class="d-block mb-3 mx-auto bw"></a>
        <p class="text-muted">
        Created in <a href="https://nim-lang.org/">Nim</a> on <a href="https://pages.github.com/">GitHub Pages</a>.
        <a href="https://github.com/gabbhack/nimidirectory">Available</a>
        under <a href="https://en.wikipedia.org/wiki/GNU_General_Public_License#Version_3">GPLv3</a>
        </p>
        <p class="text-muted">
        Builded at 2023-10-09T01:08:32Z
        </p>
      </div>
    </div>
  </div>
</footer>
<script>
</script>
</body>
</html>
